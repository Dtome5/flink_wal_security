2025-10-08 14:45:44,320 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] - --------------------------------------------------------------------------------
2025-10-08 14:45:44,323 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -  Preconfiguration: 
2025-10-08 14:45:44,323 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] - 


RESOURCE_PARAMS extraction logs:
jvm_params: -Xmx536870902 -Xms536870902 -XX:MaxDirectMemorySize=268435458 -XX:MaxMetaspaceSize=268435456
dynamic_configs: -D taskmanager.memory.network.min=134217730b -D taskmanager.cpu.cores=1.0 -D taskmanager.memory.task.off-heap.size=0b -D taskmanager.memory.jvm-metaspace.size=268435456b -D external-resources=none -D taskmanager.memory.jvm-overhead.min=201326592b -D taskmanager.memory.framework.off-heap.size=134217728b -D taskmanager.memory.network.max=134217730b -D taskmanager.memory.framework.heap.size=134217728b -D taskmanager.memory.managed.size=536870920b -D taskmanager.memory.task.heap.size=402653174b -D taskmanager.numberOfTaskSlots=1 -D taskmanager.memory.jvm-overhead.max=201326592b
logs: INFO  [] - Using standard YAML parser to load flink configuration file from /opt/flink/conf/config.yaml.
INFO  [] - Loading configuration property: blob.server.port, 6124
INFO  [] - Loading configuration property: taskmanager.memory.process.size, 1728m
INFO  [] - Loading configuration property: taskmanager.bind-host, 0.0.0.0
INFO  [] - Loading configuration property: jobmanager.execution.failover-strategy, region
INFO  [] - Loading configuration property: jobmanager.rpc.address, 30a48f53a5ec
INFO  [] - Loading configuration property: execution.checkpointing.incremental, false
INFO  [] - Loading configuration property: state.backend.rocksdb.localdir, /tmp/rocksdb
INFO  [] - Loading configuration property: execution.target, remote
INFO  [] - Loading configuration property: jobmanager.memory.process.size, 1600m
INFO  [] - Loading configuration property: jobmanager.rpc.port, 6123
INFO  [] - Loading configuration property: query.server.port, 6125
INFO  [] - Loading configuration property: rest.bind-address, 0.0.0.0
INFO  [] - Loading configuration property: jobmanager.bind-host, 0.0.0.0
INFO  [] - Loading configuration property: execution.checkpointing.savepoint-dir, file:///tmp/flink-checkpoints
INFO  [] - Loading configuration property: taskmanager.host, 127.0.0.1
INFO  [] - Loading configuration property: execution.checkpointing.externalized-checkpoint-retention, RETAIN_ON_CANCELLATION
INFO  [] - Loading configuration property: parallelism.default, 1
INFO  [] - Loading configuration property: taskmanager.numberOfTaskSlots, 1
INFO  [] - Loading configuration property: execution.checkpointing.local-backup.enabled, true
INFO  [] - Loading configuration property: rest.address, 127.0.0.1
INFO  [] - Loading configuration property: execution.checkpointing.dir, file:///tmp/flink-checkpoints
INFO  [] - Loading configuration property: env.java.opts.all, --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.text=ALL-UNNAMED --add-opens=java.base/java.time=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED
INFO  [] - Loading configuration property: state.backend.type, rocksdb
INFO  [] - The derived from fraction jvm overhead memory (172.800mb (181193935 bytes)) is less than its min value 192.000mb (201326592 bytes), min value will be used instead
INFO  [] - Final TaskExecutor Memory configuration:
INFO  [] -   Total Process Memory:          1.688gb (1811939328 bytes)
INFO  [] -     Total Flink Memory:          1.250gb (1342177280 bytes)
INFO  [] -       Total JVM Heap Memory:     512.000mb (536870902 bytes)
INFO  [] -         Framework:               128.000mb (134217728 bytes)
INFO  [] -         Task:                    384.000mb (402653174 bytes)
INFO  [] -       Total Off-heap Memory:     768.000mb (805306378 bytes)
INFO  [] -         Managed:                 512.000mb (536870920 bytes)
INFO  [] -         Total JVM Direct Memory: 256.000mb (268435458 bytes)
INFO  [] -           Framework:             128.000mb (134217728 bytes)
INFO  [] -           Task:                  0 bytes
INFO  [] -           Network:               128.000mb (134217730 bytes)
INFO  [] -     JVM Metaspace:               256.000mb (268435456 bytes)
INFO  [] -     JVM Overhead:                192.000mb (201326592 bytes)

2025-10-08 14:45:44,323 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] - --------------------------------------------------------------------------------
2025-10-08 14:45:44,333 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -  Starting TaskManager (Version: 2.1.0, Scala: 2.12, Rev:4cb6bd3, Date:2025-07-21T13:23:51+02:00)
2025-10-08 14:45:44,334 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -  OS current user: flink
2025-10-08 14:45:44,334 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -  Current Hadoop/Kerberos user: <no hadoop dependency found>
2025-10-08 14:45:44,335 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -  JVM: OpenJDK 64-Bit Server VM - Eclipse Adoptium - 17/17.0.16+8
2025-10-08 14:45:44,335 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -  Arch: amd64
2025-10-08 14:45:44,339 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -  Maximum heap size: 512 MiBytes
2025-10-08 14:45:44,339 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -  JAVA_HOME: /opt/java/openjdk
2025-10-08 14:45:44,340 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -  No Hadoop Dependency available
2025-10-08 14:45:44,340 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -  JVM Options:
2025-10-08 14:45:44,340 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     -Xmx536870902
2025-10-08 14:45:44,340 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     -Xms536870902
2025-10-08 14:45:44,340 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     -XX:MaxDirectMemorySize=268435458
2025-10-08 14:45:44,340 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     -XX:MaxMetaspaceSize=268435456
2025-10-08 14:45:44,340 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     -XX:+IgnoreUnrecognizedVMOptions
2025-10-08 14:45:44,340 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED
2025-10-08 14:45:44,340 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED
2025-10-08 14:45:44,341 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     --add-opens=java.base/java.lang=ALL-UNNAMED
2025-10-08 14:45:44,341 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     --add-opens=java.base/java.net=ALL-UNNAMED
2025-10-08 14:45:44,341 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     --add-opens=java.base/java.io=ALL-UNNAMED
2025-10-08 14:45:44,341 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     --add-opens=java.base/java.nio=ALL-UNNAMED
2025-10-08 14:45:44,341 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     --add-opens=java.base/sun.nio.ch=ALL-UNNAMED
2025-10-08 14:45:44,341 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     --add-opens=java.base/java.lang.reflect=ALL-UNNAMED
2025-10-08 14:45:44,341 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     --add-opens=java.base/java.text=ALL-UNNAMED
2025-10-08 14:45:44,341 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     --add-opens=java.base/java.time=ALL-UNNAMED
2025-10-08 14:45:44,342 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     --add-opens=java.base/java.util=ALL-UNNAMED
2025-10-08 14:45:44,342 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     --add-opens=java.base/java.util.concurrent=ALL-UNNAMED
2025-10-08 14:45:44,342 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED
2025-10-08 14:45:44,342 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED
2025-10-08 14:45:44,342 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     -Dlog.file=/opt/flink/log/flink--taskexecutor-0-30a48f53a5ec.log
2025-10-08 14:45:44,342 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     -Dlog4j.configuration=file:/opt/flink/conf/log4j.properties
2025-10-08 14:45:44,342 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     -Dlog4j.configurationFile=file:/opt/flink/conf/log4j.properties
2025-10-08 14:45:44,342 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     -Dlogback.configurationFile=file:/opt/flink/conf/logback.xml
2025-10-08 14:45:44,342 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -  Program Arguments:
2025-10-08 14:45:44,345 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     --configDir
2025-10-08 14:45:44,345 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     /opt/flink/conf
2025-10-08 14:45:44,345 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     -D
2025-10-08 14:45:44,345 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     taskmanager.memory.network.min=134217730b
2025-10-08 14:45:44,346 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     -D
2025-10-08 14:45:44,346 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     taskmanager.cpu.cores=1.0
2025-10-08 14:45:44,346 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     -D
2025-10-08 14:45:44,346 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     taskmanager.memory.task.off-heap.size=0b
2025-10-08 14:45:44,346 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     -D
2025-10-08 14:45:44,346 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     taskmanager.memory.jvm-metaspace.size=268435456b
2025-10-08 14:45:44,346 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     -D
2025-10-08 14:45:44,346 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     external-resources=none
2025-10-08 14:45:44,346 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     -D
2025-10-08 14:45:44,346 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     taskmanager.memory.jvm-overhead.min=201326592b
2025-10-08 14:45:44,347 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     -D
2025-10-08 14:45:44,347 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     taskmanager.memory.framework.off-heap.size=134217728b
2025-10-08 14:45:44,347 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     -D
2025-10-08 14:45:44,347 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     taskmanager.memory.network.max=134217730b
2025-10-08 14:45:44,347 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     -D
2025-10-08 14:45:44,348 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     taskmanager.memory.framework.heap.size=134217728b
2025-10-08 14:45:44,348 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     -D
2025-10-08 14:45:44,348 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     taskmanager.memory.managed.size=536870920b
2025-10-08 14:45:44,348 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     -D
2025-10-08 14:45:44,348 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     taskmanager.memory.task.heap.size=402653174b
2025-10-08 14:45:44,348 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     -D
2025-10-08 14:45:44,348 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     taskmanager.numberOfTaskSlots=1
2025-10-08 14:45:44,348 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     -D
2025-10-08 14:45:44,348 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -     taskmanager.memory.jvm-overhead.max=201326592b
2025-10-08 14:45:44,348 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] -  Classpath: /opt/flink/lib/flink-cep-2.1.0.jar:/opt/flink/lib/flink-connector-files-2.1.0.jar:/opt/flink/lib/flink-csv-2.1.0.jar:/opt/flink/lib/flink-json-2.1.0.jar:/opt/flink/lib/flink-scala_2.12-2.1.0.jar:/opt/flink/lib/flink-table-api-java-uber-2.1.0.jar:/opt/flink/lib/flink-table-planner-loader-2.1.0.jar:/opt/flink/lib/flink-table-runtime-2.1.0.jar:/opt/flink/lib/log4j-1.2-api-2.24.3.jar:/opt/flink/lib/log4j-api-2.24.3.jar:/opt/flink/lib/log4j-core-2.24.3.jar:/opt/flink/lib/log4j-layout-template-json-2.24.3.jar:/opt/flink/lib/log4j-slf4j-impl-2.24.3.jar:/opt/flink/lib/flink-dist-2.1.0.jar::::
2025-10-08 14:45:44,349 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] - --------------------------------------------------------------------------------
2025-10-08 14:45:44,350 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] - Registered UNIX signal handlers for [TERM, HUP, INT]
2025-10-08 14:45:44,382 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] - Maximum number of open file descriptors is 1048576.
2025-10-08 14:45:44,399 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Using standard YAML parser to load flink configuration file from /opt/flink/conf/config.yaml.
2025-10-08 14:45:44,665 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: blob.server.port, 6124
2025-10-08 14:45:44,666 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.memory.process.size, 1728m
2025-10-08 14:45:44,667 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.bind-host, 0.0.0.0
2025-10-08 14:45:44,667 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.execution.failover-strategy, region
2025-10-08 14:45:44,668 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.address, 30a48f53a5ec
2025-10-08 14:45:44,668 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.incremental, false
2025-10-08 14:45:44,668 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.rocksdb.localdir, /tmp/rocksdb
2025-10-08 14:45:44,672 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.target, remote
2025-10-08 14:45:44,672 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.memory.process.size, 1600m
2025-10-08 14:45:44,672 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.port, 6123
2025-10-08 14:45:44,675 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: query.server.port, 6125
2025-10-08 14:45:44,676 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.bind-address, 0.0.0.0
2025-10-08 14:45:44,676 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.bind-host, 0.0.0.0
2025-10-08 14:45:44,676 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.savepoint-dir, file:///tmp/flink-checkpoints
2025-10-08 14:45:44,680 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.host, 127.0.0.1
2025-10-08 14:45:44,680 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.externalized-checkpoint-retention, RETAIN_ON_CANCELLATION
2025-10-08 14:45:44,680 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: parallelism.default, 1
2025-10-08 14:45:44,681 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.numberOfTaskSlots, 1
2025-10-08 14:45:44,681 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.local-backup.enabled, true
2025-10-08 14:45:44,681 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.address, 127.0.0.1
2025-10-08 14:45:44,681 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.dir, file:///tmp/flink-checkpoints
2025-10-08 14:45:44,681 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: env.java.opts.all, --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.text=ALL-UNNAMED --add-opens=java.base/java.time=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED
2025-10-08 14:45:44,683 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.type, rocksdb
2025-10-08 14:45:44,683 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading dynamic configuration property: taskmanager.memory.network.min, 134217730b
2025-10-08 14:45:44,683 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading dynamic configuration property: taskmanager.memory.jvm-metaspace.size, 268435456b
2025-10-08 14:45:44,683 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading dynamic configuration property: taskmanager.memory.task.off-heap.size, 0b
2025-10-08 14:45:44,684 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading dynamic configuration property: taskmanager.cpu.cores, 1.0
2025-10-08 14:45:44,685 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading dynamic configuration property: external-resources, none
2025-10-08 14:45:44,685 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading dynamic configuration property: taskmanager.memory.jvm-overhead.min, 201326592b
2025-10-08 14:45:44,686 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading dynamic configuration property: taskmanager.memory.framework.off-heap.size, 134217728b
2025-10-08 14:45:44,686 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading dynamic configuration property: taskmanager.memory.network.max, 134217730b
2025-10-08 14:45:44,686 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading dynamic configuration property: taskmanager.memory.framework.heap.size, 134217728b
2025-10-08 14:45:44,687 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading dynamic configuration property: taskmanager.memory.managed.size, 536870920b
2025-10-08 14:45:44,687 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading dynamic configuration property: taskmanager.memory.task.heap.size, 402653174b
2025-10-08 14:45:44,688 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading dynamic configuration property: taskmanager.numberOfTaskSlots, 1
2025-10-08 14:45:44,688 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading dynamic configuration property: taskmanager.memory.jvm-overhead.max, 201326592b
2025-10-08 14:45:44,789 INFO  org.apache.flink.core.fs.FileSystem                          [] - Hadoop is not in the classpath/dependencies. The extended set of supported File Systems via Hadoop is not available.
2025-10-08 14:45:44,811 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-statsd
2025-10-08 14:45:44,825 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-jmx
2025-10-08 14:45:44,825 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-prometheus
2025-10-08 14:45:44,826 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-influx
2025-10-08 14:45:44,826 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-slf4j
2025-10-08 14:45:44,828 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-otel
2025-10-08 14:45:44,828 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-datadog
2025-10-08 14:45:44,828 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-graphite
2025-10-08 14:45:44,830 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: external-resource-gpu
2025-10-08 14:45:44,879 INFO  org.apache.flink.runtime.state.changelog.StateChangelogStorageLoader [] - StateChangelogStorageLoader initialized with shortcut names {memory,filesystem}.
2025-10-08 14:45:44,879 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-statsd
2025-10-08 14:45:44,880 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-jmx
2025-10-08 14:45:44,880 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-prometheus
2025-10-08 14:45:44,880 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-influx
2025-10-08 14:45:44,880 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-slf4j
2025-10-08 14:45:44,881 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-otel
2025-10-08 14:45:44,882 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-datadog
2025-10-08 14:45:44,882 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-graphite
2025-10-08 14:45:44,882 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: external-resource-gpu
2025-10-08 14:45:44,885 INFO  org.apache.flink.runtime.state.changelog.StateChangelogStorageLoader [] - StateChangelogStorageLoader initialized with shortcut names {memory,filesystem}.
2025-10-08 14:45:44,900 INFO  org.apache.flink.runtime.security.modules.HadoopModuleFactory [] - Cannot create Hadoop Security Module because Hadoop cannot be found in the Classpath.
2025-10-08 14:45:44,924 INFO  org.apache.flink.runtime.security.modules.JaasModule         [] - Jaas file will be created as /tmp/jaas-7568703560770853381.conf.
2025-10-08 14:45:44,935 INFO  org.apache.flink.runtime.security.contexts.HadoopSecurityContextFactory [] - Cannot install HadoopSecurityContext because Hadoop cannot be found in the Classpath.
2025-10-08 14:45:45,166 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] - Using configured hostname/address for TaskManager: 127.0.0.1.
2025-10-08 14:45:45,231 INFO  org.apache.flink.runtime.rpc.pekko.PekkoRpcServiceUtils      [] - Trying to start actor system, external address 127.0.0.1:0, bind address 0.0.0.0:0.
2025-10-08 14:45:45,860 INFO  org.apache.pekko.event.slf4j.Slf4jLogger                     [] - Slf4jLogger started
2025-10-08 14:45:45,887 INFO  org.apache.pekko.remote.RemoteActorRefProvider               [] - Pekko Cluster not in use - enabling unsafe features anyway because `pekko.remote.use-unsafe-remote-features-outside-cluster` has been enabled.
2025-10-08 14:45:45,891 INFO  org.apache.pekko.remote.Remoting                             [] - Starting remoting
2025-10-08 14:45:46,115 INFO  org.apache.pekko.remote.Remoting                             [] - Remoting started; listening on addresses :[pekko.tcp://flink@127.0.0.1:40677]
2025-10-08 14:45:46,230 INFO  org.apache.flink.runtime.rpc.pekko.PekkoRpcServiceUtils      [] - Actor system started at pekko.tcp://flink@127.0.0.1:40677
2025-10-08 14:45:46,256 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] - Using working directory: WorkingDirectory(/tmp/tm_127.0.0.1:40677-478ca6)
2025-10-08 14:45:46,276 INFO  org.apache.flink.runtime.metrics.MetricRegistryImpl          [] - No metrics reporter configured, no metrics will be exposed/reported.
2025-10-08 14:45:46,277 INFO  org.apache.flink.runtime.metrics.MetricRegistryImpl          [] - No trace reporter configured, no traces will be exposed/reported.
2025-10-08 14:45:46,277 INFO  org.apache.flink.runtime.metrics.MetricRegistryImpl          [] - No event reporter configured, no events will be exposed/reported.
2025-10-08 14:45:46,282 INFO  org.apache.flink.runtime.rpc.pekko.PekkoRpcServiceUtils      [] - Trying to start actor system, external address 127.0.0.1:0, bind address 0.0.0.0:0.
2025-10-08 14:45:46,315 INFO  org.apache.pekko.event.slf4j.Slf4jLogger                     [] - Slf4jLogger started
2025-10-08 14:45:46,319 INFO  org.apache.pekko.remote.RemoteActorRefProvider               [] - Pekko Cluster not in use - enabling unsafe features anyway because `pekko.remote.use-unsafe-remote-features-outside-cluster` has been enabled.
2025-10-08 14:45:46,320 INFO  org.apache.pekko.remote.Remoting                             [] - Starting remoting
2025-10-08 14:45:46,340 INFO  org.apache.pekko.remote.Remoting                             [] - Remoting started; listening on addresses :[pekko.tcp://flink-metrics@127.0.0.1:46363]
2025-10-08 14:45:46,351 INFO  org.apache.flink.runtime.rpc.pekko.PekkoRpcServiceUtils      [] - Actor system started at pekko.tcp://flink-metrics@127.0.0.1:46363
2025-10-08 14:45:46,382 INFO  org.apache.flink.runtime.rpc.pekko.PekkoRpcService           [] - Starting RPC endpoint for org.apache.flink.runtime.metrics.dump.MetricQueryService at pekko://flink-metrics/user/rpc/MetricQueryService_127.0.0.1:40677-478ca6 .
2025-10-08 14:45:46,404 INFO  org.apache.flink.runtime.blob.PermanentBlobCache             [] - Created BLOB cache storage directory /tmp/tm_127.0.0.1:40677-478ca6/blobStorage
2025-10-08 14:45:46,413 INFO  org.apache.flink.runtime.blob.TransientBlobCache             [] - Created BLOB cache storage directory /tmp/tm_127.0.0.1:40677-478ca6/blobStorage
2025-10-08 14:45:46,418 INFO  org.apache.flink.runtime.externalresource.ExternalResourceUtils [] - Enabled external resources: []
2025-10-08 14:45:46,418 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository [] - Loading delegation token receivers
2025-10-08 14:45:46,423 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository [] - Delegation token receiver hadoopfs loaded and initialized
2025-10-08 14:45:46,424 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository [] - Delegation token receiver hbase loaded and initialized
2025-10-08 14:45:46,424 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-statsd
2025-10-08 14:45:46,424 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-jmx
2025-10-08 14:45:46,424 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-prometheus
2025-10-08 14:45:46,425 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-influx
2025-10-08 14:45:46,425 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-slf4j
2025-10-08 14:45:46,425 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-otel
2025-10-08 14:45:46,425 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-datadog
2025-10-08 14:45:46,425 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-graphite
2025-10-08 14:45:46,425 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: external-resource-gpu
2025-10-08 14:45:46,426 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository [] - Delegation token receivers loaded successfully
2025-10-08 14:45:46,426 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerRunner      [] - Starting TaskManager with ResourceID: 127.0.0.1:40677-478ca6
2025-10-08 14:45:46,540 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerServices    [] - Temporary file directory '/tmp': total 31 GB, usable 11 GB (35.48% usable)
2025-10-08 14:45:46,545 INFO  org.apache.flink.runtime.io.disk.iomanager.IOManager         [] - Created a new FileChannelManager for spilling of task related data to disk (joins, sorting, ...). Used directories:
	/tmp/flink-io-d9853794-2fd7-48ce-8274-d582784d5a64
2025-10-08 14:45:46,558 INFO  org.apache.flink.runtime.io.network.netty.NettyConfig        [] - NettyConfig [server address: /0.0.0.0, server port range: 0, ssl enabled: false, memory segment size (bytes): 32768, number of server threads: 1 (manual), number of client threads: 1 (manual), server connect backlog: 0 (use Netty's default), client connect timeout (sec): 120, send/receive buffer size (bytes): 0 (use Netty's default)]
2025-10-08 14:45:46,571 INFO  org.apache.flink.runtime.io.network.NettyShuffleServiceFactory [] - Created a new FileChannelManager for storing result partitions of BLOCKING shuffles. Used directories:
	/tmp/flink-netty-shuffle-5f0c7021-cd2a-4e66-a9e2-46a182fd4511
2025-10-08 14:45:46,692 INFO  org.apache.flink.runtime.io.network.buffer.NetworkBufferPool [] - Allocated 128 MB for network buffer pool (number of memory segments: 4096, bytes per segment: 32768).
2025-10-08 14:45:46,710 INFO  org.apache.flink.runtime.io.network.NettyShuffleEnvironment  [] - Starting the network environment and its components.
2025-10-08 14:45:46,756 INFO  org.apache.flink.runtime.io.network.netty.NettyClient        [] - Transport type 'auto': using EPOLL.
2025-10-08 14:45:46,756 INFO  org.apache.flink.runtime.io.network.netty.NettyClient        [] - Successful initialization (took 45 ms).
2025-10-08 14:45:46,761 INFO  org.apache.flink.runtime.io.network.netty.NettyServer        [] - Transport type 'auto': using EPOLL.
2025-10-08 14:45:46,766 INFO  org.apache.flink.runtime.io.network.netty.NettyServer        [] - Successful initialization (took 8 ms). Listening on SocketAddress /[0:0:0:0:0:0:0:0%0]:38193.
2025-10-08 14:45:46,766 INFO  org.apache.flink.runtime.taskexecutor.TaskManagerServices    [] - TaskManager data connection initialized successfully; listening internally on port: 38193
2025-10-08 14:45:46,767 INFO  org.apache.flink.runtime.taskexecutor.KvStateService         [] - Starting the kvState service and its components.
2025-10-08 14:45:46,812 INFO  org.apache.flink.runtime.rpc.pekko.PekkoRpcService           [] - Starting RPC endpoint for org.apache.flink.runtime.taskexecutor.TaskExecutor at pekko://flink/user/rpc/taskmanager_0 .
2025-10-08 14:45:46,837 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Start job leader service.
2025-10-08 14:45:46,839 INFO  org.apache.flink.runtime.filecache.FileCache                 [] - User file cache uses directory /tmp/flink-dist-cache-dd7648b6-dbff-4581-a564-450171bd015c
2025-10-08 14:45:46,843 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Connecting to ResourceManager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/resourcemanager_*(00000000000000000000000000000000).
2025-10-08 14:45:47,176 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Resolved ResourceManager address, beginning registration
2025-10-08 14:45:47,284 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Successful registration at resource manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/resourcemanager_* under registration id 666a079c3472ae0ea499041ede13f731.
2025-10-08 14:45:57,951 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Receive slot request f38a3947ef434081c608ed9fc61997cc for job 2b5fabbad444862e5918f0332145adc7 from resource manager with leader id 00000000000000000000000000000000.
2025-10-08 14:45:57,968 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Allocated slot for f38a3947ef434081c608ed9fc61997cc with resources ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 14:45:57,974 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Add job 2b5fabbad444862e5918f0332145adc7 for job leader monitoring.
2025-10-08 14:45:57,976 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Try to register at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_2 with leader id 00000000-0000-0000-0000-000000000000.
2025-10-08 14:45:58,021 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Resolved JobManager address, beginning registration
2025-10-08 14:45:58,089 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Successful registration at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_2 for job 2b5fabbad444862e5918f0332145adc7.
2025-10-08 14:45:58,090 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Establish JobManager connection for job 2b5fabbad444862e5918f0332145adc7.
2025-10-08 14:45:58,092 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Offer reserved slots to the leader of job 2b5fabbad444862e5918f0332145adc7.
2025-10-08 14:45:58,207 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot f38a3947ef434081c608ed9fc61997cc.
2025-10-08 14:45:58,279 INFO  org.apache.flink.runtime.state.changelog.StateChangelogStorageLoader [] - Creating a changelog storage with name 'memory'.
2025-10-08 14:45:58,317 INFO  org.apache.flink.runtime.state.TaskExecutorChannelStateExecutorFactoryManager [] - Creating the channel state executor factory for job id 2b5fabbad444862e5918f0332145adc7
2025-10-08 14:45:58,347 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#0 (32912868e26d743ffbf07beb6b9227e8_cbc357ccb763df2852fee8c4fc7d55f2_0_0), deploy into slot with allocation id f38a3947ef434081c608ed9fc61997cc.
2025-10-08 14:45:58,348 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#0 (32912868e26d743ffbf07beb6b9227e8_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from CREATED to DEPLOYING.
2025-10-08 14:45:58,352 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot f38a3947ef434081c608ed9fc61997cc.
2025-10-08 14:45:58,354 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot f38a3947ef434081c608ed9fc61997cc.
2025-10-08 14:45:58,355 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#0 (32912868e26d743ffbf07beb6b9227e8_cbc357ccb763df2852fee8c4fc7d55f2_0_0) [DEPLOYING].
2025-10-08 14:45:58,361 INFO  org.apache.flink.runtime.blob.BlobClient                     [] - Downloading 2b5fabbad444862e5918f0332145adc7/p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-3091e7c4f21845c69d9bdf8c491efe6f from 30a48f53a5ec/172.17.0.4:6124
2025-10-08 14:45:58,386 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#0 (32912868e26d743ffbf07beb6b9227e8_90bea66de1c231edf33913ecd54406c1_0_0), deploy into slot with allocation id f38a3947ef434081c608ed9fc61997cc.
2025-10-08 14:45:58,389 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#0 (32912868e26d743ffbf07beb6b9227e8_90bea66de1c231edf33913ecd54406c1_0_0) switched from CREATED to DEPLOYING.
2025-10-08 14:45:58,389 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#0 (32912868e26d743ffbf07beb6b9227e8_90bea66de1c231edf33913ecd54406c1_0_0) [DEPLOYING].
2025-10-08 14:45:58,776 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:45:58,802 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:45:58,802 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:45:58,804 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:45:58,812 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:45:58,813 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:45:58,816 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:45:58,816 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:45:58,828 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#0 (32912868e26d743ffbf07beb6b9227e8_90bea66de1c231edf33913ecd54406c1_0_0) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:45:58,831 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#0 (32912868e26d743ffbf07beb6b9227e8_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:45:59,015 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:45:59,015 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:45:59,023 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:45:59,023 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:45:59,076 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:45:59,077 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:45:59,089 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Attempting to load RocksDB native library and store it under '/tmp/tm_127.0.0.1:40677-478ca6/tmp'
2025-10-08 14:45:59,104 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 14:45:59,105 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 14:45:59,568 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Successfully loaded RocksDB native library
2025-10-08 14:45:59,586 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 14:45:59,603 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 14:45:59,974 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Using standard YAML parser to load flink configuration file from /opt/flink/conf/config.yaml.
2025-10-08 14:46:00,013 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: blob.server.port, 6124
2025-10-08 14:46:00,013 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.memory.process.size, 1728m
2025-10-08 14:46:00,013 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.bind-host, 0.0.0.0
2025-10-08 14:46:00,013 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.execution.failover-strategy, region
2025-10-08 14:46:00,013 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.address, 30a48f53a5ec
2025-10-08 14:46:00,013 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.incremental, false
2025-10-08 14:46:00,013 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.rocksdb.localdir, /tmp/rocksdb
2025-10-08 14:46:00,013 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.target, remote
2025-10-08 14:46:00,021 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.memory.process.size, 1600m
2025-10-08 14:46:00,021 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.port, 6123
2025-10-08 14:46:00,022 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: query.server.port, 6125
2025-10-08 14:46:00,024 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.bind-address, 0.0.0.0
2025-10-08 14:46:00,026 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.bind-host, 0.0.0.0
2025-10-08 14:46:00,027 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.savepoint-dir, file:///tmp/flink-checkpoints
2025-10-08 14:46:00,028 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.host, 127.0.0.1
2025-10-08 14:46:00,029 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.externalized-checkpoint-retention, RETAIN_ON_CANCELLATION
2025-10-08 14:46:00,030 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: parallelism.default, 1
2025-10-08 14:46:00,030 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.numberOfTaskSlots, 1
2025-10-08 14:46:00,030 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.local-backup.enabled, true
2025-10-08 14:46:00,033 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.address, 127.0.0.1
2025-10-08 14:46:00,033 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.dir, file:///tmp/flink-checkpoints
2025-10-08 14:46:00,033 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: env.java.opts.all, --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.text=ALL-UNNAMED --add-opens=java.base/java.time=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED
2025-10-08 14:46:00,033 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.type, rocksdb
2025-10-08 14:46:00,118 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:00,118 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:00,348 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 14:46:00,349 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 14:46:00,626 INFO  org.apache.flink.state.rocksdb.sstmerge.RocksDBManualCompactionManager [] - Creating RocksDBManualCompactionManager with settings: RocksDBManualCompactionConfig{minInterval=0, maxManualCompactions=5, maxFileSizeToCompact=50 kb, minFilesToCompact=5, maxFilesToCompact=30, maxOutputFileSize=64 mb, maxAutoCompactions=30}
2025-10-08 14:46:00,631 INFO  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Finished building RocksDB keyed state-backend at /tmp/rocksdb/job_2b5fabbad444862e5918f0332145adc7_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_23148c00-becf-43f5-b632-fe57944b591c.
2025-10-08 14:46:00,811 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 14:46:00,811 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 14:46:00,819 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:00,820 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:03,327 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 14:46:03,330 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 14:46:08,655 INFO  org.apache.beam.runners.fnexecution.logging.GrpcLoggingService [] - Beam Fn Logging client connected.
2025-10-08 14:46:08,666 INFO  /app/.venv/lib/python3.9/site-packages/apache_beam/runners/worker/sdk_worker_main.py:84 [] - Logging handler created.
2025-10-08 14:46:08,668 INFO  /app/.venv/lib/python3.9/site-packages/apache_beam/runners/worker/sdk_worker_main.py:110 [] - semi_persistent_directory: /tmp
2025-10-08 14:46:08,672 WARN  /app/.venv/lib/python3.9/site-packages/apache_beam/runners/worker/sdk_worker_main.py:356 [] - No session file found: /tmp/staged/pickled_main_session. Functions defined in __main__ (interactive session) may fail. 
2025-10-08 14:46:08,673 WARN  /app/.venv/lib/python3.9/site-packages/apache_beam/options/pipeline_options.py:394 [] - Discarding unparseable args: ['--app_name=BeamPythonFunctionRunner', '--options_id=0.0'] 
2025-10-08 14:46:08,674 INFO  /app/.venv/lib/python3.9/site-packages/apache_beam/runners/worker/sdk_worker_main.py:134 [] - Pipeline_options: {'experiments': ['state_cache_size=1000']}
2025-10-08 14:46:08,675 INFO  /app/.venv/lib/python3.9/site-packages/apache_beam/runners/worker/statecache.py:214 [] - Creating state cache with size 1000
2025-10-08 14:46:08,675 INFO  /app/.venv/lib/python3.9/site-packages/apache_beam/runners/worker/sdk_worker.py:189 [] - Creating insecure control channel for localhost:43635.
2025-10-08 14:46:08,676 INFO  /app/.venv/lib/python3.9/site-packages/apache_beam/runners/worker/sdk_worker.py:197 [] - Control channel established.
2025-10-08 14:46:08,682 INFO  /app/.venv/lib/python3.9/site-packages/apache_beam/runners/worker/sdk_worker.py:247 [] - Initializing SDKHarness with unbounded number of workers.
2025-10-08 14:46:08,684 INFO  /app/.venv/lib/python3.9/site-packages/apache_beam/runners/worker/sdk_worker_main.py:211 [] - Python sdk harness starting.
2025-10-08 14:46:08,685 INFO  org.apache.beam.runners.fnexecution.control.FnApiControlClientPoolService [] - Beam Fn Control client connected with id 1-1
2025-10-08 14:46:08,758 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:08,759 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:08,775 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#0 (32912868e26d743ffbf07beb6b9227e8_90bea66de1c231edf33913ecd54406c1_0_0) switched from INITIALIZING to RUNNING.
2025-10-08 14:46:08,790 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#0 (32912868e26d743ffbf07beb6b9227e8_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from INITIALIZING to RUNNING.
2025-10-08 14:46:08,859 INFO  org.apache.beam.runners.fnexecution.control.FnApiControlClientPoolService [] - getProcessBundleDescriptor request with id 1-3
2025-10-08 14:46:08,870 INFO  /app/.venv/lib/python3.9/site-packages/apache_beam/runners/worker/sdk_worker.py:919 [] - Creating insecure state channel for localhost:40129.
2025-10-08 14:46:08,871 INFO  /app/.venv/lib/python3.9/site-packages/apache_beam/runners/worker/sdk_worker.py:926 [] - State channel established.
2025-10-08 14:46:08,880 INFO  /app/.venv/lib/python3.9/site-packages/apache_beam/runners/worker/data_plane.py:822 [] - Creating client data channel for localhost:43071
2025-10-08 14:46:08,884 INFO  org.apache.beam.runners.fnexecution.data.GrpcDataService     [] - Beam Fn Data client connected.
2025-10-08 14:46:09,108 INFO  org.apache.beam.runners.fnexecution.control.FnApiControlClientPoolService [] - getProcessBundleDescriptor request with id 1-2
2025-10-08 14:46:48,298 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#0 (32912868e26d743ffbf07beb6b9227e8_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from RUNNING to FINISHED.
2025-10-08 14:46:48,372 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#0 (32912868e26d743ffbf07beb6b9227e8_cbc357ccb763df2852fee8c4fc7d55f2_0_0).
2025-10-08 14:46:48,376 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FINISHED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#0 32912868e26d743ffbf07beb6b9227e8_cbc357ccb763df2852fee8c4fc7d55f2_0_0.
2025-10-08 14:46:48,563 INFO  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Closing environment urn: "beam:env:process:v1"
payload: "\032H/app/.venv/lib/python3.9/site-packages/pyflink/bin/pyflink-udf-runner.sh\"Z\n\rFLINK_TGZ_URL\022Ihttps://dlcdn.apache.org/flink/flink-2.1.0/flink-2.1.0-bin-scala_2.12.tgz\"i\n\004PATH\022a/opt/flink/bin:/opt/java/openjdk/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"&\n\bJAVA_RUN\022\032/opt/java/openjdk/bin/java\" \n\025TABLE_LOCAL_TIME_ZONE\022\aEtc/UTC\"\026\n\016ROOT_LOG_LEVEL\022\004INFO\"\036\n\tJAVA_HOME\022\021/opt/java/openjdk\"$\n\031PYFLINK_CLIENT_EXECUTABLE\022\apython3\"\021\n\tCHECK_GPG\022\004true\"\'\n\021FLINK_PLUGINS_DIR\022\022/opt/flink/plugins\"3\n\aGPG_KEY\022(7A14EF9AD986EF0D56B2E73F6AF817E6C59EC690\"\023\n\004LANG\022\ven_US.UTF-8\"E\n\fBOOT_LOG_DIR\0225/tmp/python-dist-ad025c20-2a2d-44f8-97db-131a51feb574\"!\n\016FLINK_CONF_DIR\022\017/opt/flink/conf\"\356\005\n\023FLINK_ENV_JAVA_OPTS\022\326\005-XX:+IgnoreUnrecognizedVMOptions --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.text=ALL-UNNAMED --add-opens=java.base/java.time=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED\"(\n\033_PYTHON_WORKER_MEMORY_LIMIT\022\t161061276\"b\n\rFLINK_ASC_URL\022Qhttps://downloads.apache.org/flink/flink-2.1.0/flink-2.1.0-bin-scala_2.12.tgz.asc\"\035\n\fJAVA_VERSION\022\rjdk-17.0.16+8\"\v\n\003PWD\022\004/app\"\037\n\001_\022\032/opt/java/openjdk/bin/java\"\024\n\bLANGUAGE\022\ben_US:en\"\037\n\rFLINK_OPT_DIR\022\016/opt/flink/opt\"\037\n\006python\022\025/app/.venv/bin/python\"\035\n\rXDG_DATA_HOME\022\f/opt/uv/data\"\030\n\nFLINK_HOME\022\n/opt/flink\" \n\030PYFLINK_GATEWAY_DISABLED\022\004true\"\031\n\023MAX_LOG_FILE_NUMBER\022\00210\"\037\n\rFLINK_LIB_DIR\022\016/opt/flink/lib\"\025\n\020PIP_NO_CACHE_DIR\022\0011\"\333\004\n\022DYNAMIC_PARAMETERS\022\304\004-D taskmanager.memory.network.min=134217730b -D taskmanager.cpu.cores=1.0 -D taskmanager.memory.task.off-heap.size=0b -D taskmanager.memory.jvm-metaspace.size=268435456b -D external-resources=none -D taskmanager.memory.jvm-overhead.min=201326592b -D taskmanager.memory.framework.off-heap.size=134217728b -D taskmanager.memory.network.max=134217730b -D taskmanager.memory.framework.heap.size=134217728b -D taskmanager.memory.managed.size=536870920b -D taskmanager.memory.task.heap.size=402653174b -D taskmanager.numberOfTaskSlots=1 -D taskmanager.memory.jvm-overhead.max=201326592b\"\034\n\027PYTHONDONTWRITEBYTECODE\022\0011\"\305#\n\024FLINK_INHERITED_LOGS\022\254#\n\n\nRESOURCE_PARAMS extraction logs:\njvm_params: -Xmx536870902 -Xms536870902 -XX:MaxDirectMemorySize=268435458 -XX:MaxMetaspaceSize=268435456\ndynamic_configs: -D taskmanager.memory.network.min=134217730b -D taskmanager.cpu.cores=1.0 -D taskmanager.memory.task.off-heap.size=0b -D taskmanager.memory.jvm-metaspace.size=268435456b -D external-resources=none -D taskmanager.memory.jvm-overhead.min=201326592b -D taskmanager.memory.framework.off-heap.size=134217728b -D taskmanager.memory.network.max=134217730b -D taskmanager.memory.framework.heap.size=134217728b -D taskmanager.memory.managed.size=536870920b -D taskmanager.memory.task.heap.size=402653174b -D taskmanager.numberOfTaskSlots=1 -D taskmanager.memory.jvm-overhead.max=201326592b\nlogs: INFO  [] - Using standard YAML parser to load flink configuration file from /opt/flink/conf/config.yaml.\nINFO  [] - Loading configuration property: blob.server.port, 6124\nINFO  [] - Loading configuration property: taskmanager.memory.process.size, 1728m\nINFO  [] - Loading configuration property: taskmanager.bind-host, 0.0.0.0\nINFO  [] - Loading configuration property: jobmanager.execution.failover-strategy, region\nINFO  [] - Loading configuration property: jobmanager.rpc.address, 30a48f53a5ec\nINFO  [] - Loading configuration property: execution.checkpointing.incremental, false\nINFO  [] - Loading configuration property: state.backend.rocksdb.localdir, /tmp/rocksdb\nINFO  [] - Loading configuration property: execution.target, remote\nINFO  [] - Loading configuration property: jobmanager.memory.process.size, 1600m\nINFO  [] - Loading configuration property: jobmanager.rpc.port, 6123\nINFO  [] - Loading configuration property: query.server.port, 6125\nINFO  [] - Loading configuration property: rest.bind-address, 0.0.0.0\nINFO  [] - Loading configuration property: jobmanager.bind-host, 0.0.0.0\nINFO  [] - Loading configuration property: execution.checkpointing.savepoint-dir, file:///tmp/flink-checkpoints\nINFO  [] - Loading configuration property: taskmanager.host, 127.0.0.1\nINFO  [] - Loading configuration property: execution.checkpointing.externalized-checkpoint-retention, RETAIN_ON_CANCELLATION\nINFO  [] - Loading configuration property: parallelism.default, 1\nINFO  [] - Loading configuration property: taskmanager.numberOfTaskSlots, 1\nINFO  [] - Loading configuration property: execution.checkpointing.local-backup.enabled, true\nINFO  [] - Loading configuration property: rest.address, 127.0.0.1\nINFO  [] - Loading configuration property: execution.checkpointing.dir, file:///tmp/flink-checkpoints\nINFO  [] - Loading configuration property: env.java.opts.all, --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.text=ALL-UNNAMED --add-opens=java.base/java.time=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED\nINFO  [] - Loading configuration property: state.backend.type, rocksdb\nINFO  [] - The derived from fraction jvm overhead memory (172.800mb (181193935 bytes)) is less than its min value 192.000mb (201326592 bytes), min value will be used instead\nINFO  [] - Final TaskExecutor Memory configuration:\nINFO  [] -   Total Process Memory:          1.688gb (1811939328 bytes)\nINFO  [] -     Total Flink Memory:          1.250gb (1342177280 bytes)\nINFO  [] -       Total JVM Heap Memory:     512.000mb (536870902 bytes)\nINFO  [] -         Framework:               128.000mb (134217728 bytes)\nINFO  [] -         Task:                    384.000mb (402653174 bytes)\nINFO  [] -       Total Off-heap Memory:     768.000mb (805306378 bytes)\nINFO  [] -         Managed:                 512.000mb (536870920 bytes)\nINFO  [] -         Total JVM Direct Memory: 256.000mb (268435458 bytes)\nINFO  [] -           Framework:             128.000mb (134217728 bytes)\nINFO  [] -           Task:                  0 bytes\nINFO  [] -           Network:               128.000mb (134217730 bytes)\nINFO  [] -     JVM Metaspace:               256.000mb (268435456 bytes)\nINFO  [] -     JVM Overhead:                192.000mb (201326592 bytes)\n\"\024\n\fGOSU_VERSION\022\0041.11\"\025\n\020PYTHONUNBUFFERED\022\0011\"\030\n\bHOSTNAME\022\f30a48f53a5ec\"\025\n\006LC_ALL\022\ven_US.UTF-8\"i\n\bJVM_ARGS\022] -Xmx536870902 -Xms536870902 -XX:MaxDirectMemorySize=268435458 -XX:MaxMetaspaceSize=268435456\"7\n\nLD_PRELOAD\022):/usr/lib/x86_64-linux-gnu/libjemalloc.so\"\n\n\005SHLVL\022\0013\"\022\n\004HOME\022\n/opt/flink\"\037\n\rFLINK_BIN_DIR\022\016/opt/flink/bin"

2025-10-08 14:46:48,601 INFO  org.apache.beam.runners.fnexecution.logging.GrpcLoggingService [] - 1 Beam Fn Logging clients still connected during shutdown.
2025-10-08 14:46:48,641 INFO  org.apache.beam.sdk.fn.data.BeamFnDataGrpcMultiplexer        [] - Hanged up for unknown endpoint.
2025-10-08 14:46:48,643 INFO  org.apache.beam.sdk.fn.data.BeamFnDataGrpcMultiplexer        [] - Hanged up for unknown endpoint.
2025-10-08 14:46:48,734 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers urn: "beam:env:process:v1"
payload: "\032H/app/.venv/lib/python3.9/site-packages/pyflink/bin/pyflink-udf-runner.sh\"Z\n\rFLINK_TGZ_URL\022Ihttps://dlcdn.apache.org/flink/flink-2.1.0/flink-2.1.0-bin-scala_2.12.tgz\"i\n\004PATH\022a/opt/flink/bin:/opt/java/openjdk/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"&\n\bJAVA_RUN\022\032/opt/java/openjdk/bin/java\" \n\025TABLE_LOCAL_TIME_ZONE\022\aEtc/UTC\"\026\n\016ROOT_LOG_LEVEL\022\004INFO\"\036\n\tJAVA_HOME\022\021/opt/java/openjdk\"$\n\031PYFLINK_CLIENT_EXECUTABLE\022\apython3\"\021\n\tCHECK_GPG\022\004true\"\'\n\021FLINK_PLUGINS_DIR\022\022/opt/flink/plugins\"3\n\aGPG_KEY\022(7A14EF9AD986EF0D56B2E73F6AF817E6C59EC690\"\023\n\004LANG\022\ven_US.UTF-8\"E\n\fBOOT_LOG_DIR\0225/tmp/python-dist-ad025c20-2a2d-44f8-97db-131a51feb574\"!\n\016FLINK_CONF_DIR\022\017/opt/flink/conf\"\356\005\n\023FLINK_ENV_JAVA_OPTS\022\326\005-XX:+IgnoreUnrecognizedVMOptions --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.text=ALL-UNNAMED --add-opens=java.base/java.time=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED\"(\n\033_PYTHON_WORKER_MEMORY_LIMIT\022\t161061276\"b\n\rFLINK_ASC_URL\022Qhttps://downloads.apache.org/flink/flink-2.1.0/flink-2.1.0-bin-scala_2.12.tgz.asc\"\035\n\fJAVA_VERSION\022\rjdk-17.0.16+8\"\v\n\003PWD\022\004/app\"\037\n\001_\022\032/opt/java/openjdk/bin/java\"\024\n\bLANGUAGE\022\ben_US:en\"\037\n\rFLINK_OPT_DIR\022\016/opt/flink/opt\"\037\n\006python\022\025/app/.venv/bin/python\"\035\n\rXDG_DATA_HOME\022\f/opt/uv/data\"\030\n\nFLINK_HOME\022\n/opt/flink\" \n\030PYFLINK_GATEWAY_DISABLED\022\004true\"\031\n\023MAX_LOG_FILE_NUMBER\022\00210\"\037\n\rFLINK_LIB_DIR\022\016/opt/flink/lib\"\025\n\020PIP_NO_CACHE_DIR\022\0011\"\333\004\n\022DYNAMIC_PARAMETERS\022\304\004-D taskmanager.memory.network.min=134217730b -D taskmanager.cpu.cores=1.0 -D taskmanager.memory.task.off-heap.size=0b -D taskmanager.memory.jvm-metaspace.size=268435456b -D external-resources=none -D taskmanager.memory.jvm-overhead.min=201326592b -D taskmanager.memory.framework.off-heap.size=134217728b -D taskmanager.memory.network.max=134217730b -D taskmanager.memory.framework.heap.size=134217728b -D taskmanager.memory.managed.size=536870920b -D taskmanager.memory.task.heap.size=402653174b -D taskmanager.numberOfTaskSlots=1 -D taskmanager.memory.jvm-overhead.max=201326592b\"\034\n\027PYTHONDONTWRITEBYTECODE\022\0011\"\305#\n\024FLINK_INHERITED_LOGS\022\254#\n\n\nRESOURCE_PARAMS extraction logs:\njvm_params: -Xmx536870902 -Xms536870902 -XX:MaxDirectMemorySize=268435458 -XX:MaxMetaspaceSize=268435456\ndynamic_configs: -D taskmanager.memory.network.min=134217730b -D taskmanager.cpu.cores=1.0 -D taskmanager.memory.task.off-heap.size=0b -D taskmanager.memory.jvm-metaspace.size=268435456b -D external-resources=none -D taskmanager.memory.jvm-overhead.min=201326592b -D taskmanager.memory.framework.off-heap.size=134217728b -D taskmanager.memory.network.max=134217730b -D taskmanager.memory.framework.heap.size=134217728b -D taskmanager.memory.managed.size=536870920b -D taskmanager.memory.task.heap.size=402653174b -D taskmanager.numberOfTaskSlots=1 -D taskmanager.memory.jvm-overhead.max=201326592b\nlogs: INFO  [] - Using standard YAML parser to load flink configuration file from /opt/flink/conf/config.yaml.\nINFO  [] - Loading configuration property: blob.server.port, 6124\nINFO  [] - Loading configuration property: taskmanager.memory.process.size, 1728m\nINFO  [] - Loading configuration property: taskmanager.bind-host, 0.0.0.0\nINFO  [] - Loading configuration property: jobmanager.execution.failover-strategy, region\nINFO  [] - Loading configuration property: jobmanager.rpc.address, 30a48f53a5ec\nINFO  [] - Loading configuration property: execution.checkpointing.incremental, false\nINFO  [] - Loading configuration property: state.backend.rocksdb.localdir, /tmp/rocksdb\nINFO  [] - Loading configuration property: execution.target, remote\nINFO  [] - Loading configuration property: jobmanager.memory.process.size, 1600m\nINFO  [] - Loading configuration property: jobmanager.rpc.port, 6123\nINFO  [] - Loading configuration property: query.server.port, 6125\nINFO  [] - Loading configuration property: rest.bind-address, 0.0.0.0\nINFO  [] - Loading configuration property: jobmanager.bind-host, 0.0.0.0\nINFO  [] - Loading configuration property: execution.checkpointing.savepoint-dir, file:///tmp/flink-checkpoints\nINFO  [] - Loading configuration property: taskmanager.host, 127.0.0.1\nINFO  [] - Loading configuration property: execution.checkpointing.externalized-checkpoint-retention, RETAIN_ON_CANCELLATION\nINFO  [] - Loading configuration property: parallelism.default, 1\nINFO  [] - Loading configuration property: taskmanager.numberOfTaskSlots, 1\nINFO  [] - Loading configuration property: execution.checkpointing.local-backup.enabled, true\nINFO  [] - Loading configuration property: rest.address, 127.0.0.1\nINFO  [] - Loading configuration property: execution.checkpointing.dir, file:///tmp/flink-checkpoints\nINFO  [] - Loading configuration property: env.java.opts.all, --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.text=ALL-UNNAMED --add-opens=java.base/java.time=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED\nINFO  [] - Loading configuration property: state.backend.type, rocksdb\nINFO  [] - The derived from fraction jvm overhead memory (172.800mb (181193935 bytes)) is less than its min value 192.000mb (201326592 bytes), min value will be used instead\nINFO  [] - Final TaskExecutor Memory configuration:\nINFO  [] -   Total Process Memory:          1.688gb (1811939328 bytes)\nINFO  [] -     Total Flink Memory:          1.250gb (1342177280 bytes)\nINFO  [] -       Total JVM Heap Memory:     512.000mb (536870902 bytes)\nINFO  [] -         Framework:               128.000mb (134217728 bytes)\nINFO  [] -         Task:                    384.000mb (402653174 bytes)\nINFO  [] -       Total Off-heap Memory:     768.000mb (805306378 bytes)\nINFO  [] -         Managed:                 512.000mb (536870920 bytes)\nINFO  [] -         Total JVM Direct Memory: 256.000mb (268435458 bytes)\nINFO  [] -           Framework:             128.000mb (134217728 bytes)\nINFO  [] -           Task:                  0 bytes\nINFO  [] -           Network:               128.000mb (134217730 bytes)\nINFO  [] -     JVM Metaspace:               256.000mb (268435456 bytes)\nINFO  [] -     JVM Overhead:                192.000mb (201326592 bytes)\n\"\024\n\fGOSU_VERSION\022\0041.11\"\025\n\020PYTHONUNBUFFERED\022\0011\"\030\n\bHOSTNAME\022\f30a48f53a5ec\"\025\n\006LC_ALL\022\ven_US.UTF-8\"i\n\bJVM_ARGS\022] -Xmx536870902 -Xms536870902 -XX:MaxDirectMemorySize=268435458 -XX:MaxMetaspaceSize=268435456\"7\n\nLD_PRELOAD\022):/usr/lib/x86_64-linux-gnu/libjemalloc.so\"\n\n\005SHLVL\022\0013\"\022\n\004HOME\022\n/opt/flink\"\037\n\rFLINK_BIN_DIR\022\016/opt/flink/bin"

java.lang.IllegalStateException: call already closed
	at org.apache.beam.vendor.grpc.v1p60p1.com.google.common.base.Preconditions.checkState(Preconditions.java:512) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-3091e7c4f21845c69d9bdf8c491efe6f:2.1.0]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerCallImpl.closeInternal(ServerCallImpl.java:213) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-3091e7c4f21845c69d9bdf8c491efe6f:2.1.0]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerCallImpl.close(ServerCallImpl.java:208) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-3091e7c4f21845c69d9bdf8c491efe6f:2.1.0]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.stub.ServerCalls$ServerCallStreamObserverImpl.onCompleted(ServerCalls.java:395) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-3091e7c4f21845c69d9bdf8c491efe6f:2.1.0]
	at org.apache.beam.runners.fnexecution.state.GrpcStateService.close(GrpcStateService.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-3091e7c4f21845c69d9bdf8c491efe6f:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:156) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-3091e7c4f21845c69d9bdf8c491efe6f:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$WrappedSdkHarnessClient.close(DefaultJobBundleFactory.java:699) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-3091e7c4f21845c69d9bdf8c491efe6f:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$WrappedSdkHarnessClient.unref(DefaultJobBundleFactory.java:715) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-3091e7c4f21845c69d9bdf8c491efe6f:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.lambda$createEnvironmentCaches$3(DefaultJobBundleFactory.java:222) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-3091e7c4f21845c69d9bdf8c491efe6f:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.processPendingNotifications(LocalCache.java:1850) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-3091e7c4f21845c69d9bdf8c491efe6f:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.runUnlockedCleanup(LocalCache.java:3503) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-3091e7c4f21845c69d9bdf8c491efe6f:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.postWriteCleanup(LocalCache.java:3479) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-3091e7c4f21845c69d9bdf8c491efe6f:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.clear(LocalCache.java:3252) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-3091e7c4f21845c69d9bdf8c491efe6f:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.clear(LocalCache.java:4343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-3091e7c4f21845c69d9bdf8c491efe6f:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalManualCache.invalidateAll(LocalCache.java:4960) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-3091e7c4f21845c69d9bdf8c491efe6f:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.close(DefaultJobBundleFactory.java:359) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-3091e7c4f21845c69d9bdf8c491efe6f:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.PythonSharedResources.close(PythonSharedResources.java:67) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-3091e7c4f21845c69d9bdf8c491efe6f:2.1.0]
	at org.apache.flink.runtime.memory.SharedResources$LeasedResource.dispose(SharedResources.java:180) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.memory.SharedResources.release(SharedResources.java:108) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.memory.MemoryManager.lambda$getSharedMemoryResourceForManagedMemory$7(MemoryManager.java:566) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.memory.OpaqueMemoryResource.close(OpaqueMemoryResource.java:65) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.close(BeamPythonFunctionRunner.java:329) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-3091e7c4f21845c69d9bdf8c491efe6f:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.close(AbstractExternalPythonFunctionOperator.java:65) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-3091e7c4f21845c69d9bdf8c491efe6f:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamOperatorWrapper.close(StreamOperatorWrapper.java:163) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.closeAllOperators(RegularOperatorChain.java:125) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.closeAllOperators(StreamTask.java:1188) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.afterInvoke(StreamTask.java:1052) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:923) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:942) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 14:46:48,760 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 14:46:48,763 INFO  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackend      [] - Closed RocksDB State Backend. Cleaning up RocksDB working directory /tmp/rocksdb/job_2b5fabbad444862e5918f0332145adc7_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_23148c00-becf-43f5-b632-fe57944b591c.
2025-10-08 14:46:48,767 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#0 (32912868e26d743ffbf07beb6b9227e8_90bea66de1c231edf33913ecd54406c1_0_0) switched from RUNNING to FINISHED.
2025-10-08 14:46:48,768 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#0 (32912868e26d743ffbf07beb6b9227e8_90bea66de1c231edf33913ecd54406c1_0_0).
2025-10-08 14:46:48,768 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FINISHED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#0 32912868e26d743ffbf07beb6b9227e8_90bea66de1c231edf33913ecd54406c1_0_0.
2025-10-08 14:46:49,020 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Free slot TaskSlot(index:1, state:ACTIVE, resource profile: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}, allocationId: f38a3947ef434081c608ed9fc61997cc, jobId: 2b5fabbad444862e5918f0332145adc7).
2025-10-08 14:46:49,032 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Remove job 2b5fabbad444862e5918f0332145adc7 from job leader monitoring.
2025-10-08 14:46:49,042 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Close JobManager connection for job 2b5fabbad444862e5918f0332145adc7.
2025-10-08 14:46:49,147 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Receive slot request ad238b8ee2b6ed1a3f7e20706b5fe970 for job d1f164921ad7c2fe36d4e92a16bdba98 from resource manager with leader id 00000000000000000000000000000000.
2025-10-08 14:46:49,148 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Allocated slot for ad238b8ee2b6ed1a3f7e20706b5fe970 with resources ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 14:46:49,148 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Add job d1f164921ad7c2fe36d4e92a16bdba98 for job leader monitoring.
2025-10-08 14:46:49,148 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Try to register at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 with leader id 00000000-0000-0000-0000-000000000000.
2025-10-08 14:46:49,174 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Resolved JobManager address, beginning registration
2025-10-08 14:46:49,209 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Successful registration at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 14:46:49,210 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Establish JobManager connection for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 14:46:49,210 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Offer reserved slots to the leader of job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 14:46:49,264 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:46:49,282 INFO  org.apache.flink.runtime.state.changelog.StateChangelogStorageLoader [] - Creating a changelog storage with name 'memory'.
2025-10-08 14:46:49,284 INFO  org.apache.flink.runtime.state.TaskExecutorChannelStateExecutorFactoryManager [] - Creating the channel state executor factory for job id d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 14:46:49,289 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#0 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_0), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:46:49,303 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#0 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from CREATED to DEPLOYING.
2025-10-08 14:46:49,304 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:46:49,311 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#0 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_0) [DEPLOYING].
2025-10-08 14:46:49,313 INFO  org.apache.flink.runtime.blob.BlobClient                     [] - Downloading d1f164921ad7c2fe36d4e92a16bdba98/p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6 from 30a48f53a5ec/172.17.0.4:6124
2025-10-08 14:46:49,325 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#0 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_0), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:46:49,346 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:46:49,350 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#0 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_0) switched from CREATED to DEPLOYING.
2025-10-08 14:46:49,353 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#0 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_0) [DEPLOYING].
2025-10-08 14:46:49,512 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:49,513 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:49,516 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:46:49,517 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:46:49,518 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#0 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_0) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:46:49,531 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:49,532 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:49,533 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:46:49,533 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:46:49,534 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#0 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:46:49,574 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:49,574 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:49,591 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:49,597 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:49,593 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 14:46:49,597 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 14:46:49,609 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:49,611 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:49,620 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 14:46:49,621 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 14:46:49,667 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 14:46:49,670 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:46:49,728 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Using standard YAML parser to load flink configuration file from /opt/flink/conf/config.yaml.
2025-10-08 14:46:49,739 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: blob.server.port, 6124
2025-10-08 14:46:49,739 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.memory.process.size, 1728m
2025-10-08 14:46:49,739 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.bind-host, 0.0.0.0
2025-10-08 14:46:49,739 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.execution.failover-strategy, region
2025-10-08 14:46:49,739 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.address, 30a48f53a5ec
2025-10-08 14:46:49,739 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.incremental, false
2025-10-08 14:46:49,739 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.rocksdb.localdir, /tmp/rocksdb
2025-10-08 14:46:49,740 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.target, remote
2025-10-08 14:46:49,740 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.memory.process.size, 1600m
2025-10-08 14:46:49,740 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.port, 6123
2025-10-08 14:46:49,740 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: query.server.port, 6125
2025-10-08 14:46:49,740 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.bind-address, 0.0.0.0
2025-10-08 14:46:49,740 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.bind-host, 0.0.0.0
2025-10-08 14:46:49,740 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.savepoint-dir, file:///tmp/flink-checkpoints
2025-10-08 14:46:49,740 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.host, 127.0.0.1
2025-10-08 14:46:49,740 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.externalized-checkpoint-retention, RETAIN_ON_CANCELLATION
2025-10-08 14:46:49,740 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: parallelism.default, 1
2025-10-08 14:46:49,740 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.numberOfTaskSlots, 1
2025-10-08 14:46:49,744 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.local-backup.enabled, true
2025-10-08 14:46:49,744 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.address, 127.0.0.1
2025-10-08 14:46:49,744 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.dir, file:///tmp/flink-checkpoints
2025-10-08 14:46:49,744 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: env.java.opts.all, --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.text=ALL-UNNAMED --add-opens=java.base/java.time=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED
2025-10-08 14:46:49,744 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.type, rocksdb
2025-10-08 14:46:49,783 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:49,787 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:49,847 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:46:49,851 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e862950-a689-40b1-b452-4a49283650df/5ad8ce2b-a5cb-4298-9c69-4c1f74121825', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=08598b54-425b-4dd0-a922-980aec48565a}.
2025-10-08 14:46:49,857 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 14:46:49,857 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 14:46:49,899 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e862950-a689-40b1-b452-4a49283650df/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e862950-a689-40b1-b452-4a49283650df/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:46:49,905 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 14:46:49,908 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e862950-a689-40b1-b452-4a49283650df/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e862950-a689-40b1-b452-4a49283650df/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:46:49,910 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e862950-a689-40b1-b452-4a49283650df/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e862950-a689-40b1-b452-4a49283650df/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 14:46:50,091 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#0 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_0) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e862950-a689-40b1-b452-4a49283650df/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e862950-a689-40b1-b452-4a49283650df/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:46:50,092 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#0 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_0).
2025-10-08 14:46:50,116 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#0 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_0.
2025-10-08 14:46:50,245 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#0 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_0).
2025-10-08 14:46:50,246 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#0 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from INITIALIZING to CANCELING.
2025-10-08 14:46:50,246 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#0 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_0).
2025-10-08 14:46:51,264 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#0 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from CANCELING to CANCELED.
2025-10-08 14:46:51,265 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#0 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_0).
2025-10-08 14:46:51,265 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#0 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_0.
2025-10-08 14:46:51,305 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:46:51,308 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#1 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_1), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:46:51,314 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#1 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_1) switched from CREATED to DEPLOYING.
2025-10-08 14:46:51,314 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:46:51,315 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#1 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_1) [DEPLOYING].
2025-10-08 14:46:51,321 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#1 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_1), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:46:51,321 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:51,322 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:51,327 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#1 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_1) switched from CREATED to DEPLOYING.
2025-10-08 14:46:51,328 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#1 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_1) [DEPLOYING].
2025-10-08 14:46:51,328 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:46:51,331 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:46:51,331 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#1 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_1) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:46:51,338 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:51,338 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:51,355 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:46:51,357 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:46:51,358 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#1 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_1) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:46:51,372 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:51,375 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:51,377 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:51,378 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:51,380 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:51,382 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:51,379 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 14:46:51,383 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 14:46:51,385 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:51,386 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:51,389 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 14:46:51,386 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 14:46:51,389 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 14:46:51,390 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 14:46:51,393 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 14:46:51,394 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:46:51,437 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:46:51,441 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_be9a9b01-eb7c-4eb0-a494-97ecdebb5d21/160606ec-8b82-45f9-bae1-3ba0543aedcf', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=c9d45808-0797-4a6d-80aa-ad3ce702f8a0}.
2025-10-08 14:46:51,461 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_be9a9b01-eb7c-4eb0-a494-97ecdebb5d21/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_be9a9b01-eb7c-4eb0-a494-97ecdebb5d21/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:46:51,777 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 14:46:51,778 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 14:46:51,779 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_be9a9b01-eb7c-4eb0-a494-97ecdebb5d21/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_be9a9b01-eb7c-4eb0-a494-97ecdebb5d21/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:46:51,780 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_be9a9b01-eb7c-4eb0-a494-97ecdebb5d21/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_be9a9b01-eb7c-4eb0-a494-97ecdebb5d21/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 14:46:51,782 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#1 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_1) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_be9a9b01-eb7c-4eb0-a494-97ecdebb5d21/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_be9a9b01-eb7c-4eb0-a494-97ecdebb5d21/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:46:51,783 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#1 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_1).
2025-10-08 14:46:51,790 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#1 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_1.
2025-10-08 14:46:51,846 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#1 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_1).
2025-10-08 14:46:51,846 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#1 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_1) switched from INITIALIZING to CANCELING.
2025-10-08 14:46:51,846 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#1 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_1).
2025-10-08 14:46:52,125 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 1-1 still running. Killing.
2025-10-08 14:46:52,133 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@773b9d76, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@6e0f6e35, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@4ebbde47, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@4899a469, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@63e25021, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@7609f4ae}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 14:46:52,140 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#1 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_1) switched from CANCELING to CANCELED.
2025-10-08 14:46:52,140 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#1 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_1).
2025-10-08 14:46:52,144 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#1 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_1.
2025-10-08 14:46:53,382 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:46:53,385 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#2 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_2), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:46:53,386 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#2 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_2) switched from CREATED to DEPLOYING.
2025-10-08 14:46:53,386 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#2 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_2) [DEPLOYING].
2025-10-08 14:46:53,388 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:53,389 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:53,390 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:46:53,390 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:46:53,390 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#2 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_2) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:46:53,398 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:53,398 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:53,400 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 14:46:53,400 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 14:46:53,402 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:53,403 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:53,408 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 14:46:53,408 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 14:46:53,411 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:46:53,418 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#2 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_2), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:46:53,421 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#2 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_2) switched from CREATED to DEPLOYING.
2025-10-08 14:46:53,422 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#2 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_2) [DEPLOYING].
2025-10-08 14:46:53,424 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:53,428 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:53,429 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:46:53,430 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:46:53,432 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#2 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_2) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:46:53,455 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:53,456 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:53,461 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:53,463 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:53,467 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 14:46:53,689 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 14:46:53,689 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 14:46:53,692 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 14:46:53,694 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:46:53,974 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:46:53,975 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_70eb9749-842f-42c8-89a8-93f09c4de59a/6bb97c80-483f-4fe6-abbd-2ae99e200a2c', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=d9735544-cf00-4861-82ef-b500b043b2de}.
2025-10-08 14:46:53,994 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_70eb9749-842f-42c8-89a8-93f09c4de59a/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_70eb9749-842f-42c8-89a8-93f09c4de59a/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:46:53,998 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 14:46:54,004 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_70eb9749-842f-42c8-89a8-93f09c4de59a/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_70eb9749-842f-42c8-89a8-93f09c4de59a/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:46:54,004 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_70eb9749-842f-42c8-89a8-93f09c4de59a/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_70eb9749-842f-42c8-89a8-93f09c4de59a/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 14:46:54,005 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#2 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_2) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_70eb9749-842f-42c8-89a8-93f09c4de59a/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_70eb9749-842f-42c8-89a8-93f09c4de59a/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:46:54,012 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#2 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_2).
2025-10-08 14:46:54,014 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#2 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_2.
2025-10-08 14:46:54,068 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#2 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_2).
2025-10-08 14:46:54,069 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#2 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_2) switched from INITIALIZING to CANCELING.
2025-10-08 14:46:54,071 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#2 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_2).
2025-10-08 14:46:54,079 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 2-1 still running. Killing.
2025-10-08 14:46:54,108 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@52d34bc4, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@2ee8478b, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@4cdf2d67, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@5ea67ee0, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@1663939b, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@7a5b5ac3}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 14:46:54,131 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#2 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_2) switched from CANCELING to CANCELED.
2025-10-08 14:46:54,133 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#2 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_2).
2025-10-08 14:46:54,137 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#2 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_2.
2025-10-08 14:46:56,492 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:46:56,497 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#3 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_3), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:46:56,503 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#3 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_3) switched from CREATED to DEPLOYING.
2025-10-08 14:46:56,504 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:46:56,505 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#3 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_3) [DEPLOYING].
2025-10-08 14:46:56,509 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:56,510 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:56,510 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:46:56,512 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:46:56,513 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#3 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_3) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:46:56,513 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#3 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_3), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:46:56,516 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#3 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_3) switched from CREATED to DEPLOYING.
2025-10-08 14:46:56,519 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#3 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_3) [DEPLOYING].
2025-10-08 14:46:56,521 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:56,521 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:56,523 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:56,525 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 14:46:56,529 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 14:46:56,530 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:56,531 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:56,533 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 14:46:56,535 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 14:46:56,535 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:56,538 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:46:56,538 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:46:56,539 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#3 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_3) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:46:56,553 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:56,554 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:56,555 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:56,557 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:56,560 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 14:46:56,742 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 14:46:56,743 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 14:46:56,744 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 14:46:56,748 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:46:56,780 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:46:56,781 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5e2b327e-ee29-4d8c-a646-091ccb780763/914830d4-4c9c-420f-b0b0-b6af5865174f', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=f3d618ed-645c-460a-95a5-d552501a90ff}.
2025-10-08 14:46:56,807 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5e2b327e-ee29-4d8c-a646-091ccb780763/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5e2b327e-ee29-4d8c-a646-091ccb780763/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:46:56,811 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 14:46:56,812 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5e2b327e-ee29-4d8c-a646-091ccb780763/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5e2b327e-ee29-4d8c-a646-091ccb780763/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:46:56,814 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5e2b327e-ee29-4d8c-a646-091ccb780763/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5e2b327e-ee29-4d8c-a646-091ccb780763/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 14:46:56,816 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#3 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_3) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5e2b327e-ee29-4d8c-a646-091ccb780763/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5e2b327e-ee29-4d8c-a646-091ccb780763/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:46:56,817 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#3 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_3).
2025-10-08 14:46:56,819 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#3 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_3.
2025-10-08 14:46:56,855 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#3 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_3).
2025-10-08 14:46:56,855 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#3 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_3) switched from INITIALIZING to CANCELING.
2025-10-08 14:46:56,856 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#3 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_3).
2025-10-08 14:46:56,859 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 3-1 still running. Killing.
2025-10-08 14:46:56,869 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@258ed946, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@1613328b, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@5afdf89d, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@5712ad43, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@4851a0e, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@b0df77f}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 14:46:56,883 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#3 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_3) switched from CANCELING to CANCELED.
2025-10-08 14:46:56,884 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#3 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_3).
2025-10-08 14:46:56,893 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#3 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_3.
2025-10-08 14:47:00,388 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:47:00,391 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#4 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_4), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:47:00,402 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:47:00,402 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#4 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_4) switched from CREATED to DEPLOYING.
2025-10-08 14:47:00,404 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#4 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_4) [DEPLOYING].
2025-10-08 14:47:00,408 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#4 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_4), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:47:00,415 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:00,418 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:00,419 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:47:00,420 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#4 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_4) switched from CREATED to DEPLOYING.
2025-10-08 14:47:00,422 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#4 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_4) [DEPLOYING].
2025-10-08 14:47:00,423 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:47:00,427 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#4 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_4) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:47:00,429 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:00,438 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:00,441 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:47:00,443 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:47:00,453 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:00,453 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#4 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_4) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:47:00,476 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:00,478 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 14:47:00,481 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 14:47:00,483 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:00,488 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:00,493 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:00,494 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:00,500 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:00,508 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:00,510 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 14:47:00,515 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 14:47:00,518 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 14:47:00,526 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 14:47:00,534 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 14:47:00,537 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:47:00,574 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:47:00,575 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_30cd8a4d-0296-4161-a40d-502a68b43ea2/ef69aa86-b05b-4436-af06-571064902148', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=1bf95e44-8164-4e0d-972c-3e34cff8bc00}.
2025-10-08 14:47:00,625 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_30cd8a4d-0296-4161-a40d-502a68b43ea2/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_30cd8a4d-0296-4161-a40d-502a68b43ea2/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:47:01,011 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 14:47:01,012 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 14:47:01,017 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_30cd8a4d-0296-4161-a40d-502a68b43ea2/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_30cd8a4d-0296-4161-a40d-502a68b43ea2/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:47:01,020 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_30cd8a4d-0296-4161-a40d-502a68b43ea2/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_30cd8a4d-0296-4161-a40d-502a68b43ea2/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 14:47:01,025 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#4 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_4) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_30cd8a4d-0296-4161-a40d-502a68b43ea2/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_30cd8a4d-0296-4161-a40d-502a68b43ea2/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:47:01,030 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#4 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_4).
2025-10-08 14:47:01,032 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#4 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_4.
2025-10-08 14:47:01,084 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#4 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_4).
2025-10-08 14:47:01,089 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#4 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_4) switched from INITIALIZING to CANCELING.
2025-10-08 14:47:01,089 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#4 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_4).
2025-10-08 14:47:01,094 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 4-1 still running. Killing.
2025-10-08 14:47:01,107 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@70a501fb, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@801a55a, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@5ffee028, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@14dc6b2a, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@4c2e0a93, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@49004d39}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 14:47:01,116 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#4 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_4) switched from CANCELING to CANCELED.
2025-10-08 14:47:01,116 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#4 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_4).
2025-10-08 14:47:01,117 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#4 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_4.
2025-10-08 14:47:05,913 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:47:05,915 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#5 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_5), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:47:05,916 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#5 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_5) switched from CREATED to DEPLOYING.
2025-10-08 14:47:05,916 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:47:05,919 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#5 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_5), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:47:05,920 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#5 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_5) [DEPLOYING].
2025-10-08 14:47:05,923 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#5 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_5) switched from CREATED to DEPLOYING.
2025-10-08 14:47:05,924 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#5 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_5) [DEPLOYING].
2025-10-08 14:47:05,927 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:05,927 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:05,924 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:05,929 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:05,934 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:47:05,935 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:47:05,936 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#5 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_5) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:47:05,937 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:47:05,937 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:47:05,939 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#5 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_5) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:47:05,952 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:05,952 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:05,954 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 14:47:05,955 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 14:47:05,954 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:05,956 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:05,958 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:05,956 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:05,960 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:05,962 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 14:47:05,962 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:05,963 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 14:47:05,965 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 14:47:05,966 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 14:47:05,969 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 14:47:05,972 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:47:06,009 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:47:06,009 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e6ce2f1e-4387-4db5-87cc-c98e20a703fc/4025ac60-4e4b-4b4d-983a-78588f6398df', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=3ea02d82-68d1-408b-b727-6a83643198b4}.
2025-10-08 14:47:06,036 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e6ce2f1e-4387-4db5-87cc-c98e20a703fc/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e6ce2f1e-4387-4db5-87cc-c98e20a703fc/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:47:06,234 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 14:47:06,235 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 14:47:06,239 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e6ce2f1e-4387-4db5-87cc-c98e20a703fc/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e6ce2f1e-4387-4db5-87cc-c98e20a703fc/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:47:06,241 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e6ce2f1e-4387-4db5-87cc-c98e20a703fc/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e6ce2f1e-4387-4db5-87cc-c98e20a703fc/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 14:47:06,242 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#5 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_5) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e6ce2f1e-4387-4db5-87cc-c98e20a703fc/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e6ce2f1e-4387-4db5-87cc-c98e20a703fc/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:47:06,245 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#5 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_5).
2025-10-08 14:47:06,247 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#5 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_5.
2025-10-08 14:47:06,289 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#5 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_5).
2025-10-08 14:47:06,289 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#5 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_5) switched from INITIALIZING to CANCELING.
2025-10-08 14:47:06,289 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#5 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_5).
2025-10-08 14:47:06,292 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 5-1 still running. Killing.
2025-10-08 14:47:06,296 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@459710b0, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@4231c02e, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@303ed5fe, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@4834e8de, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@355b63f8, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@79a7e5cd}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 14:47:06,302 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#5 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_5) switched from CANCELING to CANCELED.
2025-10-08 14:47:06,302 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#5 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_5).
2025-10-08 14:47:06,304 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#5 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_5.
2025-10-08 14:47:14,235 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:47:14,237 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#6 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_6), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:47:14,238 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:47:14,239 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#6 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_6) switched from CREATED to DEPLOYING.
2025-10-08 14:47:14,241 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#6 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_6) [DEPLOYING].
2025-10-08 14:47:14,243 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:14,244 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:14,245 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#6 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_6), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:47:14,246 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:47:14,246 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#6 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_6) switched from CREATED to DEPLOYING.
2025-10-08 14:47:14,247 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#6 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_6) [DEPLOYING].
2025-10-08 14:47:14,246 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:47:14,248 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#6 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_6) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:47:14,248 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:14,257 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:14,257 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:14,257 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:14,259 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 14:47:14,261 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 14:47:14,260 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:47:14,261 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:47:14,262 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#6 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_6) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:47:14,264 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:14,265 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:14,269 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:14,269 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:14,271 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 14:47:14,271 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 14:47:14,273 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:14,276 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:14,278 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 14:47:14,278 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 14:47:14,280 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 14:47:14,280 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:47:14,284 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:47:14,284 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_754068fc-f980-4e7a-a655-0902d36b6604/5055b443-fc60-4b9d-8451-f035d8752727', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=db31cf22-4604-4c21-8a83-5ae59e4b1127}.
2025-10-08 14:47:14,306 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_754068fc-f980-4e7a-a655-0902d36b6604/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_754068fc-f980-4e7a-a655-0902d36b6604/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:47:14,453 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 14:47:14,454 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 14:47:14,456 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_754068fc-f980-4e7a-a655-0902d36b6604/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_754068fc-f980-4e7a-a655-0902d36b6604/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:47:14,458 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_754068fc-f980-4e7a-a655-0902d36b6604/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_754068fc-f980-4e7a-a655-0902d36b6604/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 14:47:14,460 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#6 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_6) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_754068fc-f980-4e7a-a655-0902d36b6604/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_754068fc-f980-4e7a-a655-0902d36b6604/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:47:14,462 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#6 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_6).
2025-10-08 14:47:14,465 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#6 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_6.
2025-10-08 14:47:14,492 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#6 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_6).
2025-10-08 14:47:14,492 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#6 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_6) switched from INITIALIZING to CANCELING.
2025-10-08 14:47:14,493 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#6 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_6).
2025-10-08 14:47:14,496 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 6-1 still running. Killing.
2025-10-08 14:47:14,502 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@746b52ac, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@1fb47dd6, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@15231e30, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@785ac23b, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@560a01ae, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@6aec8c74}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 14:47:14,509 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#6 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_6) switched from CANCELING to CANCELED.
2025-10-08 14:47:14,510 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#6 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_6).
2025-10-08 14:47:14,510 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#6 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_6.
2025-10-08 14:47:25,153 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:47:25,158 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#7 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_7), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:47:25,159 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:47:25,159 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#7 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_7) switched from CREATED to DEPLOYING.
2025-10-08 14:47:25,161 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#7 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_7) [DEPLOYING].
2025-10-08 14:47:25,163 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:25,164 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:25,165 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:47:25,166 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:47:25,166 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#7 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_7), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:47:25,167 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#7 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_7) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:47:25,167 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#7 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_7) switched from CREATED to DEPLOYING.
2025-10-08 14:47:25,169 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#7 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_7) [DEPLOYING].
2025-10-08 14:47:25,171 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:25,174 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:25,178 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:47:25,178 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:47:25,179 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#7 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_7) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:47:25,183 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:25,183 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:25,186 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 14:47:25,186 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 14:47:25,187 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:25,187 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:25,188 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:25,190 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:25,188 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 14:47:25,190 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 14:47:25,191 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:25,193 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:25,195 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 14:47:25,196 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 14:47:25,198 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 14:47:25,199 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:47:25,203 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:47:25,203 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e63067d-08ff-47ef-8376-b9ea0ac14d25/addc4369-2b37-4cf9-9392-8d8ddfc37296', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=bbd574fb-b64f-4e2f-b268-f0bdd795fc12}.
2025-10-08 14:47:25,226 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e63067d-08ff-47ef-8376-b9ea0ac14d25/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e63067d-08ff-47ef-8376-b9ea0ac14d25/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:47:25,398 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 14:47:25,398 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 14:47:25,402 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e63067d-08ff-47ef-8376-b9ea0ac14d25/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e63067d-08ff-47ef-8376-b9ea0ac14d25/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:47:25,404 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e63067d-08ff-47ef-8376-b9ea0ac14d25/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e63067d-08ff-47ef-8376-b9ea0ac14d25/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 14:47:25,406 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#7 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_7) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e63067d-08ff-47ef-8376-b9ea0ac14d25/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e63067d-08ff-47ef-8376-b9ea0ac14d25/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:47:25,408 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#7 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_7).
2025-10-08 14:47:25,414 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#7 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_7.
2025-10-08 14:47:25,445 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#7 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_7).
2025-10-08 14:47:25,445 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#7 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_7) switched from INITIALIZING to CANCELING.
2025-10-08 14:47:25,446 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#7 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_7).
2025-10-08 14:47:25,450 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 7-1 still running. Killing.
2025-10-08 14:47:25,455 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@5b1917ed, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@55336836, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@4bb2c7a4, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@4843bcdf, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@5bf66c45, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@154acdd5}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 14:47:25,462 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#7 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_7) switched from CANCELING to CANCELED.
2025-10-08 14:47:25,463 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#7 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_7).
2025-10-08 14:47:25,463 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#7 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_7.
2025-10-08 14:47:43,431 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:47:43,434 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#8 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_8), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:47:43,435 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:47:43,437 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#8 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_8), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:47:43,435 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#8 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_8) switched from CREATED to DEPLOYING.
2025-10-08 14:47:43,439 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#8 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_8) [DEPLOYING].
2025-10-08 14:47:43,441 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#8 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_8) switched from CREATED to DEPLOYING.
2025-10-08 14:47:43,441 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#8 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_8) [DEPLOYING].
2025-10-08 14:47:43,441 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:43,441 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:43,444 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:47:43,446 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:47:43,441 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:43,448 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:43,448 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#8 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_8) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:47:43,448 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:47:43,449 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:47:43,449 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#8 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_8) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:47:43,456 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:43,457 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:43,458 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:43,458 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:43,462 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 14:47:43,464 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 14:47:43,465 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:43,465 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:43,466 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 14:47:43,467 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 14:47:43,468 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:47:43,468 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:47:43,468 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 14:47:43,470 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:47:43,471 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 14:47:43,472 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 14:47:43,475 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:47:43,475 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e10882c-f11e-46e8-bb19-443937648371/b144eeb5-a3a1-46a8-8cac-d0a310bb17d8', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=7eba4e7b-264c-4599-b82e-94da1dffbc97}.
2025-10-08 14:47:43,495 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e10882c-f11e-46e8-bb19-443937648371/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e10882c-f11e-46e8-bb19-443937648371/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:47:43,649 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 14:47:43,650 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 14:47:43,651 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e10882c-f11e-46e8-bb19-443937648371/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e10882c-f11e-46e8-bb19-443937648371/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:47:43,651 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e10882c-f11e-46e8-bb19-443937648371/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e10882c-f11e-46e8-bb19-443937648371/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 14:47:43,654 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#8 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_8) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e10882c-f11e-46e8-bb19-443937648371/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e10882c-f11e-46e8-bb19-443937648371/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:47:43,654 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#8 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_8).
2025-10-08 14:47:43,656 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#8 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_8.
2025-10-08 14:47:43,707 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#8 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_8).
2025-10-08 14:47:43,707 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#8 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_8) switched from INITIALIZING to CANCELING.
2025-10-08 14:47:43,707 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#8 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_8).
2025-10-08 14:47:43,709 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 8-1 still running. Killing.
2025-10-08 14:47:43,717 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@7463e5ce, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@2c3ffd98, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@2433c214, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@364c7ab0, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@5deab422, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@eea513a}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 14:47:43,726 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#8 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_8) switched from CANCELING to CANCELED.
2025-10-08 14:47:43,727 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#8 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_8).
2025-10-08 14:47:43,727 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#8 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_8.
2025-10-08 14:48:08,824 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:48:08,826 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#9 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_9), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:48:08,827 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#9 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_9) switched from CREATED to DEPLOYING.
2025-10-08 14:48:08,827 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:48:08,829 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#9 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_9), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:48:08,829 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#9 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_9) [DEPLOYING].
2025-10-08 14:48:08,830 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:48:08,831 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:48:08,832 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:48:08,832 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:48:08,832 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#9 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_9) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:48:08,834 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#9 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_9) switched from CREATED to DEPLOYING.
2025-10-08 14:48:08,836 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#9 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_9) [DEPLOYING].
2025-10-08 14:48:08,837 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:48:08,838 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:48:08,841 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:48:08,841 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:48:08,842 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 14:48:08,842 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 14:48:08,843 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:48:08,843 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:48:08,843 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:48:08,843 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:48:08,843 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#9 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_9) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:48:08,844 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 14:48:08,844 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 14:48:08,855 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:48:08,856 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:48:08,857 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:48:08,859 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:48:08,861 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 14:48:08,986 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 14:48:08,985 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 14:48:08,988 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 14:48:08,991 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:48:08,997 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:48:08,997 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_93b8ac71-f122-461f-9893-8b7db16aa84a/231f5a55-4cb8-4466-957b-8f4286cd7601', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=3f15d5e0-e320-4fef-a2f8-deaf5c5a6fe8}.
2025-10-08 14:48:09,008 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_93b8ac71-f122-461f-9893-8b7db16aa84a/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_93b8ac71-f122-461f-9893-8b7db16aa84a/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:48:09,010 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 14:48:09,011 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_93b8ac71-f122-461f-9893-8b7db16aa84a/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_93b8ac71-f122-461f-9893-8b7db16aa84a/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:48:09,011 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_93b8ac71-f122-461f-9893-8b7db16aa84a/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_93b8ac71-f122-461f-9893-8b7db16aa84a/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 14:48:09,016 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#9 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_9) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_93b8ac71-f122-461f-9893-8b7db16aa84a/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_93b8ac71-f122-461f-9893-8b7db16aa84a/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:48:09,016 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#9 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_9).
2025-10-08 14:48:09,020 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#9 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_9.
2025-10-08 14:48:09,068 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#9 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_9).
2025-10-08 14:48:09,068 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#9 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_9) switched from INITIALIZING to CANCELING.
2025-10-08 14:48:09,068 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#9 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_9).
2025-10-08 14:48:09,069 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 9-1 still running. Killing.
2025-10-08 14:48:09,074 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@2a4d9a3, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@2e22babc, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@233fcc0b, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@5b53369d, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@7f1e8595, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@44523790}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 14:48:09,080 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#9 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_9) switched from CANCELING to CANCELED.
2025-10-08 14:48:09,081 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#9 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_9).
2025-10-08 14:48:09,081 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#9 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_9.
2025-10-08 14:48:46,115 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:48:46,116 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#10 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_10), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:48:46,117 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#10 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_10) switched from CREATED to DEPLOYING.
2025-10-08 14:48:46,118 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#10 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_10) [DEPLOYING].
2025-10-08 14:48:46,119 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:48:46,120 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:48:46,121 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:48:46,121 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:48:46,121 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:48:46,122 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#10 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_10) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:48:46,123 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#10 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_10), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:48:46,126 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:48:46,126 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:48:46,127 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#10 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_10) switched from CREATED to DEPLOYING.
2025-10-08 14:48:46,130 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#10 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_10) [DEPLOYING].
2025-10-08 14:48:46,130 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:48:46,132 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:48:46,129 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 14:48:46,132 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 14:48:46,134 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:48:46,134 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:48:46,134 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#10 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_10) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:48:46,135 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:48:46,135 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:48:46,139 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 14:48:46,140 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 14:48:46,140 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:48:46,144 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:48:46,146 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:48:46,146 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:48:46,150 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 14:48:46,381 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 14:48:46,382 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 14:48:46,385 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 14:48:46,386 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:48:46,398 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:48:46,398 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5c163257-e2d5-482c-8ae8-f4a7740560b4/9d2de45f-733d-45e1-97a7-67ba8ddc747e', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=feb01158-9454-4477-9e7b-7ffa72f0e6fa}.
2025-10-08 14:48:46,414 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5c163257-e2d5-482c-8ae8-f4a7740560b4/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5c163257-e2d5-482c-8ae8-f4a7740560b4/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:48:46,416 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 14:48:46,422 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5c163257-e2d5-482c-8ae8-f4a7740560b4/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5c163257-e2d5-482c-8ae8-f4a7740560b4/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:48:46,428 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5c163257-e2d5-482c-8ae8-f4a7740560b4/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5c163257-e2d5-482c-8ae8-f4a7740560b4/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 14:48:46,434 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#10 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_10) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5c163257-e2d5-482c-8ae8-f4a7740560b4/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5c163257-e2d5-482c-8ae8-f4a7740560b4/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:48:46,438 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#10 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_10).
2025-10-08 14:48:46,441 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#10 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_10.
2025-10-08 14:48:46,501 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#10 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_10).
2025-10-08 14:48:46,502 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#10 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_10) switched from INITIALIZING to CANCELING.
2025-10-08 14:48:46,506 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#10 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_10).
2025-10-08 14:48:46,517 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 10-1 still running. Killing.
2025-10-08 14:48:46,531 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@14f49056, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@790b1a50, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@49d7cb26, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@75d26bdd, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@45943311, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@64ec7869}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 14:48:46,542 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#10 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_10) switched from CANCELING to CANCELED.
2025-10-08 14:48:46,542 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#10 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_10).
2025-10-08 14:48:46,543 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#10 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_10.
2025-10-08 14:49:46,490 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:49:46,492 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#11 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_11), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:49:46,494 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#11 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_11) switched from CREATED to DEPLOYING.
2025-10-08 14:49:46,494 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#11 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_11) [DEPLOYING].
2025-10-08 14:49:46,496 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:49:46,498 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:49:46,500 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:49:46,498 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#11 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_11), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:49:46,501 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:49:46,502 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:49:46,502 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#11 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_11) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:49:46,503 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#11 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_11) switched from CREATED to DEPLOYING.
2025-10-08 14:49:46,503 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#11 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_11) [DEPLOYING].
2025-10-08 14:49:46,503 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:49:46,504 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:49:46,504 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:49:46,504 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:49:46,509 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#11 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_11) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:49:46,514 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:49:46,516 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:49:46,517 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:49:46,517 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:49:46,518 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 14:49:46,518 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 14:49:46,519 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:49:46,519 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:49:46,519 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:49:46,519 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:49:46,521 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 14:49:46,520 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 14:49:46,521 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 14:49:46,523 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 14:49:46,524 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 14:49:46,525 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:49:46,533 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:49:46,534 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_73af54fd-e7bc-432d-b57a-939e3d4bef2b/6c670254-36c4-436b-aa94-1d2381c04437', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=47943eaa-df33-4d4e-9ee3-c812bc641072}.
2025-10-08 14:49:46,554 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_73af54fd-e7bc-432d-b57a-939e3d4bef2b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_73af54fd-e7bc-432d-b57a-939e3d4bef2b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:49:46,691 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 14:49:46,691 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 14:49:46,694 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_73af54fd-e7bc-432d-b57a-939e3d4bef2b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_73af54fd-e7bc-432d-b57a-939e3d4bef2b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:49:46,695 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_73af54fd-e7bc-432d-b57a-939e3d4bef2b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_73af54fd-e7bc-432d-b57a-939e3d4bef2b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 14:49:46,699 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#11 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_11) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_73af54fd-e7bc-432d-b57a-939e3d4bef2b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_73af54fd-e7bc-432d-b57a-939e3d4bef2b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:49:46,699 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#11 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_11).
2025-10-08 14:49:46,705 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#11 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_11.
2025-10-08 14:49:46,744 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#11 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_11).
2025-10-08 14:49:46,745 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#11 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_11) switched from INITIALIZING to CANCELING.
2025-10-08 14:49:46,745 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#11 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_11).
2025-10-08 14:49:46,748 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 11-1 still running. Killing.
2025-10-08 14:49:46,753 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@32246e67, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@46fb66b3, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@5c951321, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@25c2a05d, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@3404a5d4, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@29d78319}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 14:49:46,760 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#11 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_11) switched from CANCELING to CANCELED.
2025-10-08 14:49:46,760 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#11 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_11).
2025-10-08 14:49:46,761 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#11 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_11.
2025-10-08 14:50:46,801 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:50:46,803 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#12 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_12), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:50:46,804 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#12 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_12) switched from CREATED to DEPLOYING.
2025-10-08 14:50:46,804 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:50:46,805 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#12 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_12) [DEPLOYING].
2025-10-08 14:50:46,806 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#12 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_12), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:50:46,808 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:50:46,809 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:50:46,809 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#12 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_12) switched from CREATED to DEPLOYING.
2025-10-08 14:50:46,811 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#12 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_12) [DEPLOYING].
2025-10-08 14:50:46,812 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:50:46,812 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:50:46,813 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:50:46,814 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:50:46,814 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#12 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_12) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:50:46,815 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:50:46,815 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:50:46,816 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#12 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_12) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:50:46,819 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:50:46,819 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:50:46,820 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:50:46,821 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:50:46,824 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 14:50:46,825 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 14:50:46,827 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:50:46,827 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:50:46,828 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 14:50:46,829 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:50:46,830 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 14:50:46,833 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 14:50:46,837 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:50:46,837 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_516d10cd-1f4b-4935-a9fe-2deeadd89dbe/f58ddfc2-a512-4d0c-9fe6-4aeb582c416c', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=bff97349-83e5-4b3b-8aa8-c31d38aa4a36}.
2025-10-08 14:50:46,841 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:50:46,841 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:50:46,849 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 14:50:46,849 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 14:50:46,852 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_516d10cd-1f4b-4935-a9fe-2deeadd89dbe/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_516d10cd-1f4b-4935-a9fe-2deeadd89dbe/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:50:46,991 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 14:50:46,991 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 14:50:46,993 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_516d10cd-1f4b-4935-a9fe-2deeadd89dbe/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_516d10cd-1f4b-4935-a9fe-2deeadd89dbe/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:50:46,994 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_516d10cd-1f4b-4935-a9fe-2deeadd89dbe/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_516d10cd-1f4b-4935-a9fe-2deeadd89dbe/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 14:50:46,997 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#12 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_12) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_516d10cd-1f4b-4935-a9fe-2deeadd89dbe/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_516d10cd-1f4b-4935-a9fe-2deeadd89dbe/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:50:46,999 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#12 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_12).
2025-10-08 14:50:47,001 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#12 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_12.
2025-10-08 14:50:47,026 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#12 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_12).
2025-10-08 14:50:47,027 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#12 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_12) switched from INITIALIZING to CANCELING.
2025-10-08 14:50:47,029 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#12 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_12).
2025-10-08 14:50:47,042 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 12-1 still running. Killing.
2025-10-08 14:50:47,046 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@608de55d, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@7da3f103, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@2cc5e94, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@1738983b, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@1810308c, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@7a59e164}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 14:50:47,052 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#12 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_12) switched from CANCELING to CANCELED.
2025-10-08 14:50:47,054 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#12 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_12).
2025-10-08 14:50:47,055 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#12 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_12.
2025-10-08 14:51:47,031 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:51:47,035 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#13 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_13), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:51:47,036 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:51:47,036 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#13 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_13) switched from CREATED to DEPLOYING.
2025-10-08 14:51:47,038 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#13 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_13) [DEPLOYING].
2025-10-08 14:51:47,040 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#13 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_13), deploy into slot with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:51:47,041 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:51:47,041 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:51:47,041 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#13 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_13) switched from CREATED to DEPLOYING.
2025-10-08 14:51:47,043 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#13 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_13) [DEPLOYING].
2025-10-08 14:51:47,042 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:51:47,044 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:51:47,044 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#13 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_13) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:51:47,045 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:51:47,045 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:51:47,048 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:51:47,048 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:51:47,049 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#13 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_13) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:51:47,067 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:51:47,068 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:51:47,068 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:51:47,070 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:51:47,072 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 14:51:47,073 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 14:51:47,073 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:51:47,075 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:51:47,079 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:51:47,080 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:51:47,085 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 14:51:47,085 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 14:51:47,086 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 14:51:47,082 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 14:51:47,090 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 14:51:47,093 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:51:47,098 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:51:47,100 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_31f64109-2da2-4c03-a265-e716088dd75d/38278653-8eb9-4fb5-b79a-3b3298b53f22', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=2bdd9cff-2b27-4c3d-86c5-fd9ca7533412}.
2025-10-08 14:51:47,122 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_31f64109-2da2-4c03-a265-e716088dd75d/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_31f64109-2da2-4c03-a265-e716088dd75d/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:51:47,222 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 14:51:47,223 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 14:51:47,226 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_31f64109-2da2-4c03-a265-e716088dd75d/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_31f64109-2da2-4c03-a265-e716088dd75d/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:51:47,227 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_31f64109-2da2-4c03-a265-e716088dd75d/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_31f64109-2da2-4c03-a265-e716088dd75d/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 14:51:47,230 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#13 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_13) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_31f64109-2da2-4c03-a265-e716088dd75d/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_31f64109-2da2-4c03-a265-e716088dd75d/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:51:47,233 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#13 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_13).
2025-10-08 14:51:47,236 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#13 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_13.
2025-10-08 14:51:47,261 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#13 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_13).
2025-10-08 14:51:47,262 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#13 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_13) switched from INITIALIZING to CANCELING.
2025-10-08 14:51:47,264 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#13 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_13).
2025-10-08 14:51:47,265 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 13-1 still running. Killing.
2025-10-08 14:51:47,273 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@32f6150a, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@673e2817, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@7b59c669, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@572fe1b4, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@5573e01e, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@431b1437}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 14:51:47,283 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#13 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_13) switched from CANCELING to CANCELED.
2025-10-08 14:51:47,283 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#13 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_13).
2025-10-08 14:51:47,285 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#13 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_13.
2025-10-08 14:52:38,619 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Free slot TaskSlot(index:2, state:ACTIVE, resource profile: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}, allocationId: ad238b8ee2b6ed1a3f7e20706b5fe970, jobId: d1f164921ad7c2fe36d4e92a16bdba98).
2025-10-08 14:52:38,620 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Remove job d1f164921ad7c2fe36d4e92a16bdba98 from job leader monitoring.
2025-10-08 14:52:38,620 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Close JobManager connection for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 14:52:47,349 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Receive slot request 8220171550d74ab189fb532bbda2484c for job d1f164921ad7c2fe36d4e92a16bdba98 from resource manager with leader id 00000000000000000000000000000000.
2025-10-08 14:52:47,350 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Allocated slot for 8220171550d74ab189fb532bbda2484c with resources ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 14:52:47,351 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Add job d1f164921ad7c2fe36d4e92a16bdba98 for job leader monitoring.
2025-10-08 14:52:47,351 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Try to register at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 with leader id 00000000-0000-0000-0000-000000000000.
2025-10-08 14:52:47,356 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Resolved JobManager address, beginning registration
2025-10-08 14:52:47,363 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Successful registration at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 14:52:47,363 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Establish JobManager connection for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 14:52:47,363 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Offer reserved slots to the leader of job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 14:52:47,370 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:52:47,371 INFO  org.apache.flink.runtime.state.changelog.StateChangelogStorageLoader [] - Creating a changelog storage with name 'memory'.
2025-10-08 14:52:47,371 INFO  org.apache.flink.runtime.state.TaskExecutorChannelStateExecutorFactoryManager [] - Creating the channel state executor factory for job id d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 14:52:47,372 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#14 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_14), deploy into slot with allocation id 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:52:47,373 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:52:47,373 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#14 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_14) switched from CREATED to DEPLOYING.
2025-10-08 14:52:47,374 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#14 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_14) [DEPLOYING].
2025-10-08 14:52:47,374 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:52:47,376 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#14 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_14), deploy into slot with allocation id 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:52:47,377 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#14 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_14) switched from CREATED to DEPLOYING.
2025-10-08 14:52:47,377 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#14 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_14) [DEPLOYING].
2025-10-08 14:52:47,380 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:52:47,380 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:52:47,381 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:52:47,381 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:52:47,381 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#14 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_14) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:52:47,513 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:52:47,514 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:52:47,515 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:52:47,515 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:52:47,515 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#14 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_14) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:52:47,541 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:52:47,541 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:52:47,548 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 14:52:47,549 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 14:52:47,554 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:52:47,554 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:52:47,556 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:52:47,558 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:52:47,560 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 14:52:47,561 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 14:52:47,563 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 14:52:47,564 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:52:47,570 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:52:47,570 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0f0af6e6-4880-4b95-b664-da74d391e07d/656c47aa-12a1-4a6e-b7d7-46c6fac7969a', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=e6eb1388-4324-4e7b-a280-e361d98f2ec8}.
2025-10-08 14:52:47,589 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0f0af6e6-4880-4b95-b664-da74d391e07d/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0f0af6e6-4880-4b95-b664-da74d391e07d/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:52:47,591 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 14:52:47,595 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0f0af6e6-4880-4b95-b664-da74d391e07d/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0f0af6e6-4880-4b95-b664-da74d391e07d/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:52:47,595 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0f0af6e6-4880-4b95-b664-da74d391e07d/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0f0af6e6-4880-4b95-b664-da74d391e07d/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 14:52:47,717 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#14 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_14) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0f0af6e6-4880-4b95-b664-da74d391e07d/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0f0af6e6-4880-4b95-b664-da74d391e07d/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:52:47,717 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#14 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_14).
2025-10-08 14:52:47,719 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#14 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_14.
2025-10-08 14:52:47,746 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#14 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_14).
2025-10-08 14:52:47,749 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#14 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_14) switched from INITIALIZING to CANCELING.
2025-10-08 14:52:47,749 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#14 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_14).
2025-10-08 14:52:47,802 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Using standard YAML parser to load flink configuration file from /opt/flink/conf/config.yaml.
2025-10-08 14:52:47,805 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: blob.server.port, 6124
2025-10-08 14:52:47,805 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.memory.process.size, 1728m
2025-10-08 14:52:47,805 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.bind-host, 0.0.0.0
2025-10-08 14:52:47,805 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.execution.failover-strategy, region
2025-10-08 14:52:47,805 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.address, 30a48f53a5ec
2025-10-08 14:52:47,805 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.incremental, false
2025-10-08 14:52:47,805 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.rocksdb.localdir, /tmp/rocksdb
2025-10-08 14:52:47,805 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.target, remote
2025-10-08 14:52:47,805 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.memory.process.size, 1600m
2025-10-08 14:52:47,805 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.port, 6123
2025-10-08 14:52:47,805 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: query.server.port, 6125
2025-10-08 14:52:47,805 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.bind-address, 0.0.0.0
2025-10-08 14:52:47,805 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.bind-host, 0.0.0.0
2025-10-08 14:52:47,805 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.savepoint-dir, file:///tmp/flink-checkpoints
2025-10-08 14:52:47,805 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.host, 127.0.0.1
2025-10-08 14:52:47,805 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.externalized-checkpoint-retention, RETAIN_ON_CANCELLATION
2025-10-08 14:52:47,805 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: parallelism.default, 1
2025-10-08 14:52:47,805 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.numberOfTaskSlots, 1
2025-10-08 14:52:47,806 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.local-backup.enabled, true
2025-10-08 14:52:47,806 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.address, 127.0.0.1
2025-10-08 14:52:47,806 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.dir, file:///tmp/flink-checkpoints
2025-10-08 14:52:47,806 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: env.java.opts.all, --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.text=ALL-UNNAMED --add-opens=java.base/java.time=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED
2025-10-08 14:52:47,806 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.type, rocksdb
2025-10-08 14:52:47,825 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:52:47,825 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:52:47,916 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#14 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_14) switched from CANCELING to CANCELED.
2025-10-08 14:52:47,917 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#14 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_14).
2025-10-08 14:52:47,917 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#14 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_14.
2025-10-08 14:53:47,753 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:53:47,755 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#15 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_15), deploy into slot with allocation id 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:53:47,756 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:53:47,756 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#15 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_15) switched from CREATED to DEPLOYING.
2025-10-08 14:53:47,757 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#15 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_15) [DEPLOYING].
2025-10-08 14:53:47,759 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#15 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_15), deploy into slot with allocation id 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:53:47,759 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:53:47,760 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:53:47,760 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#15 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_15) switched from CREATED to DEPLOYING.
2025-10-08 14:53:47,761 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#15 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_15) [DEPLOYING].
2025-10-08 14:53:47,761 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:53:47,762 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:53:47,762 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#15 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_15) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:53:47,762 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:53:47,764 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:53:47,765 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:53:47,765 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:53:47,766 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#15 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_15) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:53:47,767 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:53:47,767 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:53:47,769 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 14:53:47,769 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 14:53:47,772 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:53:47,773 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:53:47,775 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:53:47,775 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:53:47,776 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:53:47,776 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:53:47,777 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 14:53:47,778 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 14:53:47,778 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 14:53:47,778 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:53:47,779 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 14:53:47,779 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 14:53:47,787 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:53:47,787 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6f103c6d-8525-485b-94b3-119163a60ae3/4c73b0b3-ac27-41e2-ba78-4a048b113037', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=d12b5b60-c411-4248-9fdc-e917658c6806}.
2025-10-08 14:53:47,805 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6f103c6d-8525-485b-94b3-119163a60ae3/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6f103c6d-8525-485b-94b3-119163a60ae3/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:53:47,806 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 14:53:47,808 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6f103c6d-8525-485b-94b3-119163a60ae3/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6f103c6d-8525-485b-94b3-119163a60ae3/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:53:47,808 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6f103c6d-8525-485b-94b3-119163a60ae3/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6f103c6d-8525-485b-94b3-119163a60ae3/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 14:53:47,810 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#15 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_15) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6f103c6d-8525-485b-94b3-119163a60ae3/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6f103c6d-8525-485b-94b3-119163a60ae3/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:53:47,810 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#15 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_15).
2025-10-08 14:53:47,813 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#15 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_15.
2025-10-08 14:53:47,828 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#15 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_15).
2025-10-08 14:53:47,828 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#15 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_15) switched from INITIALIZING to CANCELING.
2025-10-08 14:53:47,828 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#15 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_15).
2025-10-08 14:53:48,592 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#15 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_15) switched from CANCELING to CANCELED.
2025-10-08 14:53:48,592 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#15 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_15).
2025-10-08 14:53:48,593 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#15 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_15.
2025-10-08 14:54:47,835 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:54:47,837 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#16 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_16), deploy into slot with allocation id 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:54:47,838 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:54:47,838 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#16 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_16) switched from CREATED to DEPLOYING.
2025-10-08 14:54:47,840 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#16 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_16), deploy into slot with allocation id 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:54:47,842 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#16 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_16) [DEPLOYING].
2025-10-08 14:54:47,843 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#16 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_16) switched from CREATED to DEPLOYING.
2025-10-08 14:54:47,844 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:54:47,844 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:54:47,844 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#16 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_16) [DEPLOYING].
2025-10-08 14:54:47,845 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:54:47,845 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:54:47,846 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:54:47,845 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:54:47,846 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:54:47,846 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#16 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_16) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:54:47,846 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:54:47,846 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#16 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_16) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:54:47,854 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:54:47,856 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:54:47,859 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:54:47,859 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:54:47,856 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:54:47,860 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:54:47,861 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 14:54:47,861 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 14:54:47,860 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 14:54:47,861 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 14:54:47,862 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:54:47,862 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:54:47,863 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 14:54:47,863 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 14:54:47,864 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:54:47,863 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 14:54:47,870 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:54:47,871 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_933e4fc2-2acd-4f5d-92f3-0b66553758bb/8beec092-1787-4aec-a960-01a27c1c94d8', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=2a48c55d-6ac2-49d6-a269-28d377059dfc}.
2025-10-08 14:54:47,883 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_933e4fc2-2acd-4f5d-92f3-0b66553758bb/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_933e4fc2-2acd-4f5d-92f3-0b66553758bb/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:54:48,231 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 14:54:48,231 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 14:54:48,232 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_933e4fc2-2acd-4f5d-92f3-0b66553758bb/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_933e4fc2-2acd-4f5d-92f3-0b66553758bb/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:54:48,233 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_933e4fc2-2acd-4f5d-92f3-0b66553758bb/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_933e4fc2-2acd-4f5d-92f3-0b66553758bb/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 14:54:48,235 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#16 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_16) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_933e4fc2-2acd-4f5d-92f3-0b66553758bb/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_933e4fc2-2acd-4f5d-92f3-0b66553758bb/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:54:48,236 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#16 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_16).
2025-10-08 14:54:48,239 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#16 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_16.
2025-10-08 14:54:48,257 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#16 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_16).
2025-10-08 14:54:48,259 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#16 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_16) switched from INITIALIZING to CANCELING.
2025-10-08 14:54:48,259 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#16 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_16).
2025-10-08 14:54:48,634 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 1-1 still running. Killing.
2025-10-08 14:54:48,639 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@77d1ec2a, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@50f0643b, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@2748b687, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@1a89f9c8, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@6241e60f, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@31c397c0}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 14:54:48,643 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#16 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_16) switched from CANCELING to CANCELED.
2025-10-08 14:54:48,643 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#16 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_16).
2025-10-08 14:54:48,643 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#16 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_16.
2025-10-08 14:55:48,266 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:55:48,268 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#17 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_17), deploy into slot with allocation id 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:55:48,269 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:55:48,269 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#17 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_17) switched from CREATED to DEPLOYING.
2025-10-08 14:55:48,271 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#17 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_17) [DEPLOYING].
2025-10-08 14:55:48,270 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#17 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_17), deploy into slot with allocation id 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:55:48,273 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:55:48,273 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:55:48,274 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:55:48,274 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:55:48,275 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#17 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_17) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:55:48,274 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#17 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_17) switched from CREATED to DEPLOYING.
2025-10-08 14:55:48,275 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#17 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_17) [DEPLOYING].
2025-10-08 14:55:48,276 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:55:48,276 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:55:48,276 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:55:48,276 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:55:48,276 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#17 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_17) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:55:48,281 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:55:48,281 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:55:48,282 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:55:48,285 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:55:48,285 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 14:55:48,285 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 14:55:48,286 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:55:48,286 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:55:48,286 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:55:48,287 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 14:55:48,287 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 14:55:48,288 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 14:55:48,288 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:55:48,289 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:55:48,289 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 14:55:48,289 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 14:55:48,296 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:55:48,297 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5015e7d0-856d-43c6-ab0b-9277b7745378/e06999eb-7600-4c57-86e1-7ac5bfc6ae83', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=49b2282e-c31d-4377-80b8-ccf03bd675ed}.
2025-10-08 14:55:48,322 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5015e7d0-856d-43c6-ab0b-9277b7745378/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5015e7d0-856d-43c6-ab0b-9277b7745378/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:55:48,451 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 14:55:48,453 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 14:55:48,456 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5015e7d0-856d-43c6-ab0b-9277b7745378/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5015e7d0-856d-43c6-ab0b-9277b7745378/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:55:48,458 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5015e7d0-856d-43c6-ab0b-9277b7745378/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5015e7d0-856d-43c6-ab0b-9277b7745378/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 14:55:48,459 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#17 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_17) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5015e7d0-856d-43c6-ab0b-9277b7745378/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5015e7d0-856d-43c6-ab0b-9277b7745378/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:55:48,461 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#17 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_17).
2025-10-08 14:55:48,462 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#17 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_17.
2025-10-08 14:55:48,484 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#17 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_17).
2025-10-08 14:55:48,486 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#17 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_17) switched from INITIALIZING to CANCELING.
2025-10-08 14:55:48,486 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#17 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_17).
2025-10-08 14:55:48,492 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 2-1 still running. Killing.
2025-10-08 14:55:48,494 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@515aa784, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@760472cb, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@677d7a8, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@77d70c5e, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@7335f3a7, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@26f24520}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 14:55:48,498 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#17 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_17) switched from CANCELING to CANCELED.
2025-10-08 14:55:48,498 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#17 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_17).
2025-10-08 14:55:48,499 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#17 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_17.
2025-10-08 14:56:48,490 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:56:48,491 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#18 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_18), deploy into slot with allocation id 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:56:48,492 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#18 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_18) switched from CREATED to DEPLOYING.
2025-10-08 14:56:48,493 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:56:48,494 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#18 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_18) [DEPLOYING].
2025-10-08 14:56:48,496 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#18 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_18), deploy into slot with allocation id 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:56:48,497 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:56:48,497 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:56:48,498 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:56:48,499 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:56:48,500 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#18 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_18) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:56:48,498 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#18 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_18) switched from CREATED to DEPLOYING.
2025-10-08 14:56:48,501 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#18 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_18) [DEPLOYING].
2025-10-08 14:56:48,502 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:56:48,504 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:56:48,505 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:56:48,505 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:56:48,507 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#18 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_18) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:56:48,515 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:56:48,516 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:56:48,516 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 14:56:48,517 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 14:56:48,517 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:56:48,517 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:56:48,518 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:56:48,520 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:56:48,521 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:56:48,522 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:56:48,523 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 14:56:48,523 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 14:56:48,522 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 14:56:48,524 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 14:56:48,526 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 14:56:48,527 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:56:48,534 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:56:48,535 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_696781ba-38a4-474f-bc6d-eee6bc03e7e0/77825bfd-f0da-4eeb-ad1c-dcf4840ac1d0', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=e8e430e3-8ef0-428b-9ae6-f464430b80c9}.
2025-10-08 14:56:48,556 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_696781ba-38a4-474f-bc6d-eee6bc03e7e0/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_696781ba-38a4-474f-bc6d-eee6bc03e7e0/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:56:48,676 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 14:56:48,677 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 14:56:48,678 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_696781ba-38a4-474f-bc6d-eee6bc03e7e0/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_696781ba-38a4-474f-bc6d-eee6bc03e7e0/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:56:48,678 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_696781ba-38a4-474f-bc6d-eee6bc03e7e0/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_696781ba-38a4-474f-bc6d-eee6bc03e7e0/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 14:56:48,681 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#18 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_18) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_696781ba-38a4-474f-bc6d-eee6bc03e7e0/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_696781ba-38a4-474f-bc6d-eee6bc03e7e0/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:56:48,682 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#18 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_18).
2025-10-08 14:56:48,684 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#18 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_18.
2025-10-08 14:56:48,700 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#18 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_18).
2025-10-08 14:56:48,700 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#18 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_18) switched from INITIALIZING to CANCELING.
2025-10-08 14:56:48,700 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#18 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_18).
2025-10-08 14:56:48,712 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 3-1 still running. Killing.
2025-10-08 14:56:48,713 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@29fc9f9, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@134f4204, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@440f1a5a, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@50daafff, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@2c76741c, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@45c04cf4}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 14:56:48,718 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#18 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_18) switched from CANCELING to CANCELED.
2025-10-08 14:56:48,718 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#18 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_18).
2025-10-08 14:56:48,718 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#18 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_18.
2025-10-08 14:57:48,725 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:57:48,728 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#19 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_19), deploy into slot with allocation id 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:57:48,729 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:57:48,732 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#19 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_19), deploy into slot with allocation id 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:57:48,730 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#19 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_19) switched from CREATED to DEPLOYING.
2025-10-08 14:57:48,734 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#19 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_19) [DEPLOYING].
2025-10-08 14:57:48,735 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#19 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_19) switched from CREATED to DEPLOYING.
2025-10-08 14:57:48,736 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#19 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_19) [DEPLOYING].
2025-10-08 14:57:48,736 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:57:48,737 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:57:48,737 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:57:48,737 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:57:48,738 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:57:48,739 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:57:48,740 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:57:48,741 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#19 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_19) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:57:48,742 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:57:48,742 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#19 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_19) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:57:48,746 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:57:48,746 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:57:48,747 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:57:48,748 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:57:48,749 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 14:57:48,749 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 14:57:48,750 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:57:48,751 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 14:57:48,752 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:57:48,752 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:57:48,753 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 14:57:48,753 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 14:57:48,755 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:57:48,755 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:57:48,756 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 14:57:48,756 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 14:57:48,758 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:57:48,758 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7e3d89e1-c196-4322-b16c-706cc324ccc9/b76941f9-47b1-49df-9add-4c5b59ad3658', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=a2c2e162-c5f7-489e-bb72-dca36a1a9a45}.
2025-10-08 14:57:48,778 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7e3d89e1-c196-4322-b16c-706cc324ccc9/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7e3d89e1-c196-4322-b16c-706cc324ccc9/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:57:48,875 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 14:57:48,876 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 14:57:48,878 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7e3d89e1-c196-4322-b16c-706cc324ccc9/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7e3d89e1-c196-4322-b16c-706cc324ccc9/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:57:48,878 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7e3d89e1-c196-4322-b16c-706cc324ccc9/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7e3d89e1-c196-4322-b16c-706cc324ccc9/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 14:57:48,879 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#19 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_19) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7e3d89e1-c196-4322-b16c-706cc324ccc9/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7e3d89e1-c196-4322-b16c-706cc324ccc9/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:57:48,880 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#19 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_19).
2025-10-08 14:57:48,882 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#19 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_19.
2025-10-08 14:57:48,893 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#19 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_19).
2025-10-08 14:57:48,894 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#19 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_19) switched from INITIALIZING to CANCELING.
2025-10-08 14:57:48,894 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#19 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_19).
2025-10-08 14:57:48,904 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 4-1 still running. Killing.
2025-10-08 14:57:48,906 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@7652116e, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@1d910b8b, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@6015bdf5, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@2db7c3ac, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@4b086e15, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@5e50e9ac}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 14:57:48,921 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#19 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_19) switched from CANCELING to CANCELED.
2025-10-08 14:57:48,921 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#19 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_19).
2025-10-08 14:57:48,921 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#19 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_19.
2025-10-08 14:58:48,904 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:58:48,905 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#20 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_20), deploy into slot with allocation id 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:58:48,908 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:58:48,908 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#20 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_20) switched from CREATED to DEPLOYING.
2025-10-08 14:58:48,909 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#20 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_20) [DEPLOYING].
2025-10-08 14:58:48,912 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:58:48,912 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:58:48,912 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#20 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_20), deploy into slot with allocation id 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:58:48,913 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:58:48,913 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:58:48,913 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#20 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_20) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:58:48,916 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#20 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_20) switched from CREATED to DEPLOYING.
2025-10-08 14:58:48,916 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#20 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_20) [DEPLOYING].
2025-10-08 14:58:48,916 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:58:48,916 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:58:48,917 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:58:48,917 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:58:48,918 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#20 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_20) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:58:48,919 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:58:48,921 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:58:48,922 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 14:58:48,923 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 14:58:48,924 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:58:48,925 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:58:48,926 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:58:48,926 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 14:58:48,927 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 14:58:48,926 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:58:48,930 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:58:48,930 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:58:48,933 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 14:58:49,056 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 14:58:49,056 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 14:58:49,057 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 14:58:49,059 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:58:49,067 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:58:49,067 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e2a4cba7-d652-48bf-8a81-dd05b50b02d6/aba53bf6-8e63-433e-ad00-a4373fd29883', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=8fe489bf-9ba1-482c-aa6c-de81d182b557}.
2025-10-08 14:58:49,096 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e2a4cba7-d652-48bf-8a81-dd05b50b02d6/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e2a4cba7-d652-48bf-8a81-dd05b50b02d6/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:58:49,098 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 14:58:49,099 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e2a4cba7-d652-48bf-8a81-dd05b50b02d6/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e2a4cba7-d652-48bf-8a81-dd05b50b02d6/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:58:49,101 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e2a4cba7-d652-48bf-8a81-dd05b50b02d6/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e2a4cba7-d652-48bf-8a81-dd05b50b02d6/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 14:58:49,102 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#20 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_20) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e2a4cba7-d652-48bf-8a81-dd05b50b02d6/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e2a4cba7-d652-48bf-8a81-dd05b50b02d6/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:58:49,106 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#20 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_20).
2025-10-08 14:58:49,110 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#20 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_20.
2025-10-08 14:58:49,129 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#20 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_20).
2025-10-08 14:58:49,129 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#20 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_20) switched from INITIALIZING to CANCELING.
2025-10-08 14:58:49,129 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#20 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_20).
2025-10-08 14:58:49,130 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 5-1 still running. Killing.
2025-10-08 14:58:49,135 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@460a18b2, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@54ff0b00, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@1bc5806, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@61818c04, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@77d8c70e, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@5bd375fe}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 14:58:49,141 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#20 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_20) switched from CANCELING to CANCELED.
2025-10-08 14:58:49,142 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#20 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_20).
2025-10-08 14:58:49,145 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#20 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_20.
2025-10-08 14:59:49,132 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:59:49,133 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#21 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_21), deploy into slot with allocation id 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:59:49,134 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:59:49,134 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#21 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_21) switched from CREATED to DEPLOYING.
2025-10-08 14:59:49,136 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#21 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_21) [DEPLOYING].
2025-10-08 14:59:49,136 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#21 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_21), deploy into slot with allocation id 8220171550d74ab189fb532bbda2484c.
2025-10-08 14:59:49,137 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#21 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_21) switched from CREATED to DEPLOYING.
2025-10-08 14:59:49,137 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#21 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_21) [DEPLOYING].
2025-10-08 14:59:49,138 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:59:49,138 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:59:49,139 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:59:49,139 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:59:49,139 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#21 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_21) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:59:49,139 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:59:49,139 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:59:49,140 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:59:49,140 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:59:49,140 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#21 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_21) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:59:49,142 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:59:49,142 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:59:49,143 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:59:49,143 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:59:49,144 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 14:59:49,145 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 14:59:49,145 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 14:59:49,146 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:59:49,149 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 14:59:49,149 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a358eb4d-b0e6-4b0d-8229-f66ad830333e/71999012-884f-47ff-9dc5-f5ce4d7b1c18', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=c563846b-1a37-4659-9be1-5b68c4dbe08c}.
2025-10-08 14:59:49,151 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:59:49,154 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:59:49,154 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 14:59:49,154 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 14:59:49,157 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:59:49,157 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:59:49,159 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 14:59:49,160 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 14:59:49,167 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a358eb4d-b0e6-4b0d-8229-f66ad830333e/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a358eb4d-b0e6-4b0d-8229-f66ad830333e/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:59:49,168 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 14:59:49,169 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a358eb4d-b0e6-4b0d-8229-f66ad830333e/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a358eb4d-b0e6-4b0d-8229-f66ad830333e/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 14:59:49,169 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a358eb4d-b0e6-4b0d-8229-f66ad830333e/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a358eb4d-b0e6-4b0d-8229-f66ad830333e/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 14:59:49,170 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#21 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_21) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a358eb4d-b0e6-4b0d-8229-f66ad830333e/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a358eb4d-b0e6-4b0d-8229-f66ad830333e/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:59:49,170 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#21 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_21).
2025-10-08 14:59:49,176 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#21 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_21.
2025-10-08 14:59:49,188 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#21 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_21).
2025-10-08 14:59:49,189 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#21 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_21) switched from INITIALIZING to CANCELING.
2025-10-08 14:59:49,189 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#21 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_21).
2025-10-08 14:59:49,283 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 14:59:52,450 INFO  org.apache.beam.runners.fnexecution.logging.GrpcLoggingService [] - Beam Fn Logging client connected.
2025-10-08 14:59:52,462 INFO  /app/.venv/lib/python3.9/site-packages/apache_beam/runners/worker/sdk_worker_main.py:84 [] - Logging handler created.
2025-10-08 14:59:52,462 INFO  /app/.venv/lib/python3.9/site-packages/apache_beam/runners/worker/sdk_worker_main.py:110 [] - semi_persistent_directory: /tmp
2025-10-08 14:59:52,463 WARN  /app/.venv/lib/python3.9/site-packages/apache_beam/runners/worker/sdk_worker_main.py:356 [] - No session file found: /tmp/staged/pickled_main_session. Functions defined in __main__ (interactive session) may fail. 
2025-10-08 14:59:52,463 WARN  /app/.venv/lib/python3.9/site-packages/apache_beam/options/pipeline_options.py:394 [] - Discarding unparseable args: ['--app_name=BeamPythonFunctionRunner', '--options_id=6.0'] 
2025-10-08 14:59:52,463 INFO  /app/.venv/lib/python3.9/site-packages/apache_beam/runners/worker/sdk_worker_main.py:134 [] - Pipeline_options: {'experiments': ['state_cache_size=1000']}
2025-10-08 14:59:52,468 INFO  /app/.venv/lib/python3.9/site-packages/apache_beam/runners/worker/statecache.py:214 [] - Creating state cache with size 1000
2025-10-08 14:59:52,468 INFO  /app/.venv/lib/python3.9/site-packages/apache_beam/runners/worker/sdk_worker.py:189 [] - Creating insecure control channel for localhost:33151.
2025-10-08 14:59:52,472 INFO  /app/.venv/lib/python3.9/site-packages/apache_beam/runners/worker/sdk_worker.py:197 [] - Control channel established.
2025-10-08 14:59:52,476 INFO  /app/.venv/lib/python3.9/site-packages/apache_beam/runners/worker/sdk_worker.py:247 [] - Initializing SDKHarness with unbounded number of workers.
2025-10-08 14:59:52,477 INFO  /app/.venv/lib/python3.9/site-packages/apache_beam/runners/worker/sdk_worker_main.py:211 [] - Python sdk harness starting.
2025-10-08 14:59:52,477 INFO  org.apache.beam.runners.fnexecution.control.FnApiControlClientPoolService [] - Beam Fn Control client connected with id 6-1
2025-10-08 14:59:52,560 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:59:52,561 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:59:52,576 INFO  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Closing environment urn: "beam:env:process:v1"
payload: "\032H/app/.venv/lib/python3.9/site-packages/pyflink/bin/pyflink-udf-runner.sh\"Z\n\rFLINK_TGZ_URL\022Ihttps://dlcdn.apache.org/flink/flink-2.1.0/flink-2.1.0-bin-scala_2.12.tgz\"i\n\004PATH\022a/opt/flink/bin:/opt/java/openjdk/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"&\n\bJAVA_RUN\022\032/opt/java/openjdk/bin/java\" \n\025TABLE_LOCAL_TIME_ZONE\022\aEtc/UTC\"\026\n\016ROOT_LOG_LEVEL\022\004INFO\"\036\n\tJAVA_HOME\022\021/opt/java/openjdk\"$\n\031PYFLINK_CLIENT_EXECUTABLE\022\apython3\"\021\n\tCHECK_GPG\022\004true\"\'\n\021FLINK_PLUGINS_DIR\022\022/opt/flink/plugins\"3\n\aGPG_KEY\022(7A14EF9AD986EF0D56B2E73F6AF817E6C59EC690\"\023\n\004LANG\022\ven_US.UTF-8\"E\n\fBOOT_LOG_DIR\0225/tmp/python-dist-f70f406b-e6a3-4e13-bfe2-bab28c5df55c\"!\n\016FLINK_CONF_DIR\022\017/opt/flink/conf\"\356\005\n\023FLINK_ENV_JAVA_OPTS\022\326\005-XX:+IgnoreUnrecognizedVMOptions --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.text=ALL-UNNAMED --add-opens=java.base/java.time=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED\"(\n\033_PYTHON_WORKER_MEMORY_LIMIT\022\t161061276\"b\n\rFLINK_ASC_URL\022Qhttps://downloads.apache.org/flink/flink-2.1.0/flink-2.1.0-bin-scala_2.12.tgz.asc\"\035\n\fJAVA_VERSION\022\rjdk-17.0.16+8\"\v\n\003PWD\022\004/app\"\037\n\001_\022\032/opt/java/openjdk/bin/java\"\024\n\bLANGUAGE\022\ben_US:en\"\037\n\rFLINK_OPT_DIR\022\016/opt/flink/opt\"\037\n\006python\022\025/app/.venv/bin/python\"\035\n\rXDG_DATA_HOME\022\f/opt/uv/data\"\030\n\nFLINK_HOME\022\n/opt/flink\" \n\030PYFLINK_GATEWAY_DISABLED\022\004true\"\031\n\023MAX_LOG_FILE_NUMBER\022\00210\"\037\n\rFLINK_LIB_DIR\022\016/opt/flink/lib\"\025\n\020PIP_NO_CACHE_DIR\022\0011\"\333\004\n\022DYNAMIC_PARAMETERS\022\304\004-D taskmanager.memory.network.min=134217730b -D taskmanager.cpu.cores=1.0 -D taskmanager.memory.task.off-heap.size=0b -D taskmanager.memory.jvm-metaspace.size=268435456b -D external-resources=none -D taskmanager.memory.jvm-overhead.min=201326592b -D taskmanager.memory.framework.off-heap.size=134217728b -D taskmanager.memory.network.max=134217730b -D taskmanager.memory.framework.heap.size=134217728b -D taskmanager.memory.managed.size=536870920b -D taskmanager.memory.task.heap.size=402653174b -D taskmanager.numberOfTaskSlots=1 -D taskmanager.memory.jvm-overhead.max=201326592b\"\034\n\027PYTHONDONTWRITEBYTECODE\022\0011\"\305#\n\024FLINK_INHERITED_LOGS\022\254#\n\n\nRESOURCE_PARAMS extraction logs:\njvm_params: -Xmx536870902 -Xms536870902 -XX:MaxDirectMemorySize=268435458 -XX:MaxMetaspaceSize=268435456\ndynamic_configs: -D taskmanager.memory.network.min=134217730b -D taskmanager.cpu.cores=1.0 -D taskmanager.memory.task.off-heap.size=0b -D taskmanager.memory.jvm-metaspace.size=268435456b -D external-resources=none -D taskmanager.memory.jvm-overhead.min=201326592b -D taskmanager.memory.framework.off-heap.size=134217728b -D taskmanager.memory.network.max=134217730b -D taskmanager.memory.framework.heap.size=134217728b -D taskmanager.memory.managed.size=536870920b -D taskmanager.memory.task.heap.size=402653174b -D taskmanager.numberOfTaskSlots=1 -D taskmanager.memory.jvm-overhead.max=201326592b\nlogs: INFO  [] - Using standard YAML parser to load flink configuration file from /opt/flink/conf/config.yaml.\nINFO  [] - Loading configuration property: blob.server.port, 6124\nINFO  [] - Loading configuration property: taskmanager.memory.process.size, 1728m\nINFO  [] - Loading configuration property: taskmanager.bind-host, 0.0.0.0\nINFO  [] - Loading configuration property: jobmanager.execution.failover-strategy, region\nINFO  [] - Loading configuration property: jobmanager.rpc.address, 30a48f53a5ec\nINFO  [] - Loading configuration property: execution.checkpointing.incremental, false\nINFO  [] - Loading configuration property: state.backend.rocksdb.localdir, /tmp/rocksdb\nINFO  [] - Loading configuration property: execution.target, remote\nINFO  [] - Loading configuration property: jobmanager.memory.process.size, 1600m\nINFO  [] - Loading configuration property: jobmanager.rpc.port, 6123\nINFO  [] - Loading configuration property: query.server.port, 6125\nINFO  [] - Loading configuration property: rest.bind-address, 0.0.0.0\nINFO  [] - Loading configuration property: jobmanager.bind-host, 0.0.0.0\nINFO  [] - Loading configuration property: execution.checkpointing.savepoint-dir, file:///tmp/flink-checkpoints\nINFO  [] - Loading configuration property: taskmanager.host, 127.0.0.1\nINFO  [] - Loading configuration property: execution.checkpointing.externalized-checkpoint-retention, RETAIN_ON_CANCELLATION\nINFO  [] - Loading configuration property: parallelism.default, 1\nINFO  [] - Loading configuration property: taskmanager.numberOfTaskSlots, 1\nINFO  [] - Loading configuration property: execution.checkpointing.local-backup.enabled, true\nINFO  [] - Loading configuration property: rest.address, 127.0.0.1\nINFO  [] - Loading configuration property: execution.checkpointing.dir, file:///tmp/flink-checkpoints\nINFO  [] - Loading configuration property: env.java.opts.all, --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.text=ALL-UNNAMED --add-opens=java.base/java.time=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED\nINFO  [] - Loading configuration property: state.backend.type, rocksdb\nINFO  [] - The derived from fraction jvm overhead memory (172.800mb (181193935 bytes)) is less than its min value 192.000mb (201326592 bytes), min value will be used instead\nINFO  [] - Final TaskExecutor Memory configuration:\nINFO  [] -   Total Process Memory:          1.688gb (1811939328 bytes)\nINFO  [] -     Total Flink Memory:          1.250gb (1342177280 bytes)\nINFO  [] -       Total JVM Heap Memory:     512.000mb (536870902 bytes)\nINFO  [] -         Framework:               128.000mb (134217728 bytes)\nINFO  [] -         Task:                    384.000mb (402653174 bytes)\nINFO  [] -       Total Off-heap Memory:     768.000mb (805306378 bytes)\nINFO  [] -         Managed:                 512.000mb (536870920 bytes)\nINFO  [] -         Total JVM Direct Memory: 256.000mb (268435458 bytes)\nINFO  [] -           Framework:             128.000mb (134217728 bytes)\nINFO  [] -           Task:                  0 bytes\nINFO  [] -           Network:               128.000mb (134217730 bytes)\nINFO  [] -     JVM Metaspace:               256.000mb (268435456 bytes)\nINFO  [] -     JVM Overhead:                192.000mb (201326592 bytes)\n\"\024\n\fGOSU_VERSION\022\0041.11\"\025\n\020PYTHONUNBUFFERED\022\0011\"\030\n\bHOSTNAME\022\f30a48f53a5ec\"\025\n\006LC_ALL\022\ven_US.UTF-8\"i\n\bJVM_ARGS\022] -Xmx536870902 -Xms536870902 -XX:MaxDirectMemorySize=268435458 -XX:MaxMetaspaceSize=268435456\"7\n\nLD_PRELOAD\022):/usr/lib/x86_64-linux-gnu/libjemalloc.so\"\n\n\005SHLVL\022\0013\"\022\n\004HOME\022\n/opt/flink\"\037\n\rFLINK_BIN_DIR\022\016/opt/flink/bin"

2025-10-08 14:59:52,576 INFO  org.apache.beam.runners.fnexecution.logging.GrpcLoggingService [] - 1 Beam Fn Logging clients still connected during shutdown.
2025-10-08 14:59:52,637 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#21 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_21) switched from CANCELING to CANCELED.
2025-10-08 14:59:52,637 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#21 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_21).
2025-10-08 14:59:52,637 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#21 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_21.
2025-10-08 15:00:49,195 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 8220171550d74ab189fb532bbda2484c.
2025-10-08 15:00:49,196 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#22 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_22), deploy into slot with allocation id 8220171550d74ab189fb532bbda2484c.
2025-10-08 15:00:49,196 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 8220171550d74ab189fb532bbda2484c.
2025-10-08 15:00:49,196 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#22 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_22) switched from CREATED to DEPLOYING.
2025-10-08 15:00:49,198 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#22 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_22), deploy into slot with allocation id 8220171550d74ab189fb532bbda2484c.
2025-10-08 15:00:49,198 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#22 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_22) [DEPLOYING].
2025-10-08 15:00:49,198 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#22 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_22) switched from CREATED to DEPLOYING.
2025-10-08 15:00:49,199 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#22 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_22) [DEPLOYING].
2025-10-08 15:00:49,199 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:00:49,200 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:00:49,201 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:00:49,201 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:00:49,202 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:00:49,201 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:00:49,202 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#22 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_22) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:00:49,205 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:00:49,205 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:00:49,205 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:00:49,205 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:00:49,207 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#22 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_22) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:00:49,206 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:00:49,207 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:00:49,209 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:00:49,210 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:00:49,210 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:00:49,211 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:00:49,213 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:00:49,214 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:00:49,215 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:00:49,215 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:00:49,216 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:00:49,217 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c118f564-2698-4fab-9c4e-2ed84c0709c0/9a2b6f7d-a34f-419f-b02e-d554dff53b42', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=95282013-858f-4bd6-b7da-d75ccf543a00}.
2025-10-08 15:00:49,217 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:00:49,217 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:00:49,218 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:00:49,219 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:00:49,234 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c118f564-2698-4fab-9c4e-2ed84c0709c0/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c118f564-2698-4fab-9c4e-2ed84c0709c0/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:00:49,335 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:00:49,336 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:00:49,338 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c118f564-2698-4fab-9c4e-2ed84c0709c0/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c118f564-2698-4fab-9c4e-2ed84c0709c0/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:00:49,338 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c118f564-2698-4fab-9c4e-2ed84c0709c0/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c118f564-2698-4fab-9c4e-2ed84c0709c0/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:00:49,340 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#22 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_22) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c118f564-2698-4fab-9c4e-2ed84c0709c0/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c118f564-2698-4fab-9c4e-2ed84c0709c0/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:00:49,341 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#22 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_22).
2025-10-08 15:00:49,343 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#22 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_22.
2025-10-08 15:00:49,355 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#22 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_22).
2025-10-08 15:00:49,355 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#22 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_22) switched from INITIALIZING to CANCELING.
2025-10-08 15:00:49,355 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#22 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_22).
2025-10-08 15:00:49,356 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 7-1 still running. Killing.
2025-10-08 15:00:49,358 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@3ebb4319, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@4a7c09fa, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@71a507c1, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@2f89bf38, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@4bce925b, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@61576101}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:00:49,361 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#22 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_22) switched from CANCELING to CANCELED.
2025-10-08 15:00:49,361 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#22 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_22).
2025-10-08 15:00:49,364 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#22 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_22.
2025-10-08 15:01:48,622 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Free slot TaskSlot(index:3, state:ACTIVE, resource profile: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}, allocationId: 8220171550d74ab189fb532bbda2484c, jobId: d1f164921ad7c2fe36d4e92a16bdba98).
2025-10-08 15:01:48,622 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Remove job d1f164921ad7c2fe36d4e92a16bdba98 from job leader monitoring.
2025-10-08 15:01:48,623 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Close JobManager connection for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:01:49,449 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Receive slot request 061af1b6749069abb1ce465beb001a6b for job d1f164921ad7c2fe36d4e92a16bdba98 from resource manager with leader id 00000000000000000000000000000000.
2025-10-08 15:01:49,450 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Allocated slot for 061af1b6749069abb1ce465beb001a6b with resources ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 15:01:49,450 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Add job d1f164921ad7c2fe36d4e92a16bdba98 for job leader monitoring.
2025-10-08 15:01:49,451 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Try to register at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 with leader id 00000000-0000-0000-0000-000000000000.
2025-10-08 15:01:49,455 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Resolved JobManager address, beginning registration
2025-10-08 15:01:49,460 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Successful registration at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:01:49,460 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Establish JobManager connection for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:01:49,460 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Offer reserved slots to the leader of job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:01:49,467 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 061af1b6749069abb1ce465beb001a6b.
2025-10-08 15:01:49,469 INFO  org.apache.flink.runtime.state.changelog.StateChangelogStorageLoader [] - Creating a changelog storage with name 'memory'.
2025-10-08 15:01:49,469 INFO  org.apache.flink.runtime.state.TaskExecutorChannelStateExecutorFactoryManager [] - Creating the channel state executor factory for job id d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:01:49,469 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#23 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_23), deploy into slot with allocation id 061af1b6749069abb1ce465beb001a6b.
2025-10-08 15:01:49,469 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 061af1b6749069abb1ce465beb001a6b.
2025-10-08 15:01:49,469 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#23 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_23) switched from CREATED to DEPLOYING.
2025-10-08 15:01:49,470 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 061af1b6749069abb1ce465beb001a6b.
2025-10-08 15:01:49,470 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#23 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_23) [DEPLOYING].
2025-10-08 15:01:49,471 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#23 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_23), deploy into slot with allocation id 061af1b6749069abb1ce465beb001a6b.
2025-10-08 15:01:49,472 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#23 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_23) switched from CREATED to DEPLOYING.
2025-10-08 15:01:49,473 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#23 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_23) [DEPLOYING].
2025-10-08 15:01:49,473 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:01:49,473 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:01:49,474 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:01:49,474 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:01:49,474 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#23 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_23) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:01:49,493 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:01:49,494 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:01:49,494 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:01:49,495 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:01:49,495 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#23 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_23) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:01:49,519 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:01:49,521 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:01:49,523 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:01:49,524 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:01:49,525 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:01:49,525 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:01:49,527 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:01:49,527 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:01:49,528 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:01:49,528 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:01:49,528 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:01:49,530 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:01:49,534 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:01:49,534 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_90df9a0c-9e2c-4b47-a8d7-4c65cc8e4833/c5ddd6b7-8bd9-44da-994c-55edbe64e877', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=2f4c9c3d-d806-4353-8770-da3b30fb2d46}.
2025-10-08 15:01:49,547 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_90df9a0c-9e2c-4b47-a8d7-4c65cc8e4833/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_90df9a0c-9e2c-4b47-a8d7-4c65cc8e4833/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:01:49,549 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:01:49,550 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_90df9a0c-9e2c-4b47-a8d7-4c65cc8e4833/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_90df9a0c-9e2c-4b47-a8d7-4c65cc8e4833/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:01:49,550 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_90df9a0c-9e2c-4b47-a8d7-4c65cc8e4833/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_90df9a0c-9e2c-4b47-a8d7-4c65cc8e4833/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:01:49,670 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#23 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_23) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_90df9a0c-9e2c-4b47-a8d7-4c65cc8e4833/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_90df9a0c-9e2c-4b47-a8d7-4c65cc8e4833/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:01:49,673 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#23 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_23).
2025-10-08 15:01:49,674 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#23 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_23.
2025-10-08 15:01:49,699 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#23 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_23).
2025-10-08 15:01:49,700 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#23 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_23) switched from INITIALIZING to CANCELING.
2025-10-08 15:01:49,700 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#23 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_23).
2025-10-08 15:01:49,743 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Using standard YAML parser to load flink configuration file from /opt/flink/conf/config.yaml.
2025-10-08 15:01:49,752 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: blob.server.port, 6124
2025-10-08 15:01:49,752 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.memory.process.size, 1728m
2025-10-08 15:01:49,752 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.bind-host, 0.0.0.0
2025-10-08 15:01:49,752 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.execution.failover-strategy, region
2025-10-08 15:01:49,752 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.address, 30a48f53a5ec
2025-10-08 15:01:49,752 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.incremental, false
2025-10-08 15:01:49,752 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.rocksdb.localdir, /tmp/rocksdb
2025-10-08 15:01:49,752 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.target, remote
2025-10-08 15:01:49,752 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.memory.process.size, 1600m
2025-10-08 15:01:49,752 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.port, 6123
2025-10-08 15:01:49,752 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: query.server.port, 6125
2025-10-08 15:01:49,752 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.bind-address, 0.0.0.0
2025-10-08 15:01:49,752 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.bind-host, 0.0.0.0
2025-10-08 15:01:49,752 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.savepoint-dir, file:///tmp/flink-checkpoints
2025-10-08 15:01:49,752 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.host, 127.0.0.1
2025-10-08 15:01:49,752 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.externalized-checkpoint-retention, RETAIN_ON_CANCELLATION
2025-10-08 15:01:49,752 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: parallelism.default, 1
2025-10-08 15:01:49,752 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.numberOfTaskSlots, 1
2025-10-08 15:01:49,752 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.local-backup.enabled, true
2025-10-08 15:01:49,752 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.address, 127.0.0.1
2025-10-08 15:01:49,752 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.dir, file:///tmp/flink-checkpoints
2025-10-08 15:01:49,752 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: env.java.opts.all, --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.text=ALL-UNNAMED --add-opens=java.base/java.time=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED
2025-10-08 15:01:49,752 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.type, rocksdb
2025-10-08 15:01:49,763 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:01:49,764 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:01:49,825 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#23 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_23) switched from CANCELING to CANCELED.
2025-10-08 15:01:49,825 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#23 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_23).
2025-10-08 15:01:49,826 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#23 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_23.
2025-10-08 15:02:49,705 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 061af1b6749069abb1ce465beb001a6b.
2025-10-08 15:02:49,706 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#24 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_24), deploy into slot with allocation id 061af1b6749069abb1ce465beb001a6b.
2025-10-08 15:02:49,707 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 061af1b6749069abb1ce465beb001a6b.
2025-10-08 15:02:49,707 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#24 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_24) switched from CREATED to DEPLOYING.
2025-10-08 15:02:49,708 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#24 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_24), deploy into slot with allocation id 061af1b6749069abb1ce465beb001a6b.
2025-10-08 15:02:49,708 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#24 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_24) [DEPLOYING].
2025-10-08 15:02:49,708 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#24 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_24) switched from CREATED to DEPLOYING.
2025-10-08 15:02:49,709 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#24 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_24) [DEPLOYING].
2025-10-08 15:02:49,709 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:02:49,709 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:02:49,710 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:02:49,710 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:02:49,710 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#24 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_24) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:02:49,714 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:02:49,714 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:02:49,714 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:02:49,714 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:02:49,715 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:02:49,715 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:02:49,716 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#24 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_24) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:02:49,717 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:02:49,719 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:02:49,720 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:02:49,720 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:02:49,722 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:02:49,722 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:02:49,722 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:02:49,723 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:02:49,723 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:02:49,723 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:02:49,724 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:02:49,724 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:02:49,725 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:02:49,725 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:02:49,728 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:02:49,728 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_63832fdd-2089-4a61-adbb-b0f3d920e6ce/a90acddf-57b9-495f-958e-28cfc385b78f', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0c369f09-d0ec-4707-929f-dcf25b14b192}.
2025-10-08 15:02:49,746 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_63832fdd-2089-4a61-adbb-b0f3d920e6ce/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_63832fdd-2089-4a61-adbb-b0f3d920e6ce/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:02:49,748 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:02:49,750 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_63832fdd-2089-4a61-adbb-b0f3d920e6ce/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_63832fdd-2089-4a61-adbb-b0f3d920e6ce/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:02:49,750 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_63832fdd-2089-4a61-adbb-b0f3d920e6ce/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_63832fdd-2089-4a61-adbb-b0f3d920e6ce/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:02:49,753 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#24 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_24) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_63832fdd-2089-4a61-adbb-b0f3d920e6ce/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_63832fdd-2089-4a61-adbb-b0f3d920e6ce/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:02:49,756 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#24 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_24).
2025-10-08 15:02:49,757 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#24 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_24.
2025-10-08 15:02:49,785 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#24 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_24).
2025-10-08 15:02:49,786 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#24 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_24) switched from INITIALIZING to CANCELING.
2025-10-08 15:02:49,786 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#24 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_24).
2025-10-08 15:02:50,703 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#24 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_24) switched from CANCELING to CANCELED.
2025-10-08 15:02:50,703 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#24 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_24).
2025-10-08 15:02:50,703 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#24 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_24.
2025-10-08 15:03:49,785 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 061af1b6749069abb1ce465beb001a6b.
2025-10-08 15:03:49,786 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#25 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_25), deploy into slot with allocation id 061af1b6749069abb1ce465beb001a6b.
2025-10-08 15:03:49,787 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 061af1b6749069abb1ce465beb001a6b.
2025-10-08 15:03:49,787 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#25 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_25) switched from CREATED to DEPLOYING.
2025-10-08 15:03:49,789 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#25 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_25), deploy into slot with allocation id 061af1b6749069abb1ce465beb001a6b.
2025-10-08 15:03:49,789 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#25 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_25) [DEPLOYING].
2025-10-08 15:03:49,790 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:03:49,790 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:03:49,790 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#25 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_25) switched from CREATED to DEPLOYING.
2025-10-08 15:03:49,790 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#25 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_25) [DEPLOYING].
2025-10-08 15:03:49,791 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:03:49,791 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:03:49,791 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:03:49,791 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:03:49,792 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:03:49,793 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:03:49,793 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#25 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_25) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:03:49,793 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#25 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_25) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:03:49,798 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:03:49,798 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:03:49,799 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:03:49,799 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:03:49,801 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:03:49,801 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:03:49,802 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:03:49,802 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:03:49,802 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:03:49,803 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:03:49,804 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:03:49,804 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:03:49,804 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:03:49,805 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:03:49,805 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:03:49,806 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:03:49,807 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:03:49,808 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_97e86ee7-f5ac-43f4-8812-7553b7cf4255/8847e4c4-fee9-439b-8c13-646f09ae7340', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=de0c587f-3fd1-4d94-9f81-c60038f93a1e}.
2025-10-08 15:03:49,821 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_97e86ee7-f5ac-43f4-8812-7553b7cf4255/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_97e86ee7-f5ac-43f4-8812-7553b7cf4255/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:03:50,144 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:03:50,146 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:03:50,147 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_97e86ee7-f5ac-43f4-8812-7553b7cf4255/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_97e86ee7-f5ac-43f4-8812-7553b7cf4255/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:03:50,148 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_97e86ee7-f5ac-43f4-8812-7553b7cf4255/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_97e86ee7-f5ac-43f4-8812-7553b7cf4255/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:03:50,149 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#25 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_25) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_97e86ee7-f5ac-43f4-8812-7553b7cf4255/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_97e86ee7-f5ac-43f4-8812-7553b7cf4255/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:03:50,149 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#25 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_25).
2025-10-08 15:03:50,150 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#25 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_25.
2025-10-08 15:03:50,165 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#25 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_25).
2025-10-08 15:03:50,166 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#25 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_25) switched from INITIALIZING to CANCELING.
2025-10-08 15:03:50,166 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#25 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_25).
2025-10-08 15:03:50,558 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 1-1 still running. Killing.
2025-10-08 15:03:50,564 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@435be442, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@46cd39e3, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@56b3443e, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@7dd6e47a, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@61b37676, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@4e9e4982}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:03:50,570 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#25 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_25) switched from CANCELING to CANCELED.
2025-10-08 15:03:50,570 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#25 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_25).
2025-10-08 15:03:50,571 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#25 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_25.
2025-10-08 15:04:50,177 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 061af1b6749069abb1ce465beb001a6b.
2025-10-08 15:04:50,180 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#26 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_26), deploy into slot with allocation id 061af1b6749069abb1ce465beb001a6b.
2025-10-08 15:04:50,180 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 061af1b6749069abb1ce465beb001a6b.
2025-10-08 15:04:50,182 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#26 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_26), deploy into slot with allocation id 061af1b6749069abb1ce465beb001a6b.
2025-10-08 15:04:50,180 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#26 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_26) switched from CREATED to DEPLOYING.
2025-10-08 15:04:50,183 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#26 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_26) [DEPLOYING].
2025-10-08 15:04:50,184 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:04:50,184 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:04:50,184 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#26 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_26) switched from CREATED to DEPLOYING.
2025-10-08 15:04:50,185 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#26 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_26) [DEPLOYING].
2025-10-08 15:04:50,184 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:04:50,186 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:04:50,186 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:04:50,186 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#26 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_26) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:04:50,186 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:04:50,187 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:04:50,188 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:04:50,189 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#26 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_26) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:04:50,191 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:04:50,191 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:04:50,193 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:04:50,193 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:04:50,193 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:04:50,194 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:04:50,194 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:04:50,195 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:04:50,194 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:04:50,195 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:04:50,196 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:04:50,196 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:04:50,197 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:04:50,197 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:04:50,199 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:04:50,199 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:04:50,199 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:04:50,199 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_b40fb6c7-7170-488f-893a-42145d3ec464/48e093e4-c5a9-4adf-b4a5-626bb974c779', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=5d6816d3-d9ef-4917-89a8-9cfff35f99a5}.
2025-10-08 15:04:50,210 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_b40fb6c7-7170-488f-893a-42145d3ec464/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_b40fb6c7-7170-488f-893a-42145d3ec464/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:04:50,320 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:04:50,320 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:04:50,322 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_b40fb6c7-7170-488f-893a-42145d3ec464/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_b40fb6c7-7170-488f-893a-42145d3ec464/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:04:50,323 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_b40fb6c7-7170-488f-893a-42145d3ec464/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_b40fb6c7-7170-488f-893a-42145d3ec464/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:04:50,325 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#26 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_26) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_b40fb6c7-7170-488f-893a-42145d3ec464/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_b40fb6c7-7170-488f-893a-42145d3ec464/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:04:50,326 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#26 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_26).
2025-10-08 15:04:50,328 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#26 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_26.
2025-10-08 15:04:50,348 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#26 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_26).
2025-10-08 15:04:50,349 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#26 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_26) switched from INITIALIZING to CANCELING.
2025-10-08 15:04:50,350 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#26 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_26).
2025-10-08 15:04:50,352 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 2-1 still running. Killing.
2025-10-08 15:04:50,355 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@6869a417, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@2a77c475, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@1c4bd06b, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@49c9b614, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@6ca5fa26, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@78e5dfab}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:04:50,360 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#26 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_26) switched from CANCELING to CANCELED.
2025-10-08 15:04:50,360 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#26 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_26).
2025-10-08 15:04:50,360 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#26 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_26.
2025-10-08 15:05:50,356 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 061af1b6749069abb1ce465beb001a6b.
2025-10-08 15:05:50,357 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#27 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_27), deploy into slot with allocation id 061af1b6749069abb1ce465beb001a6b.
2025-10-08 15:05:50,358 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 061af1b6749069abb1ce465beb001a6b.
2025-10-08 15:05:50,358 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#27 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_27) switched from CREATED to DEPLOYING.
2025-10-08 15:05:50,359 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#27 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_27) [DEPLOYING].
2025-10-08 15:05:50,360 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#27 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_27), deploy into slot with allocation id 061af1b6749069abb1ce465beb001a6b.
2025-10-08 15:05:50,360 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#27 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_27) switched from CREATED to DEPLOYING.
2025-10-08 15:05:50,360 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#27 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_27) [DEPLOYING].
2025-10-08 15:05:50,361 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:05:50,361 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:05:50,361 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:05:50,361 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:05:50,362 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:05:50,362 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:05:50,362 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:05:50,362 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#27 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_27) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:05:50,362 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:05:50,362 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#27 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_27) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:05:50,366 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:05:50,367 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:05:50,367 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:05:50,367 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:05:50,368 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:05:50,368 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:05:50,369 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:05:50,369 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:05:50,369 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:05:50,371 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:05:50,371 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:05:50,373 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:05:50,375 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:05:50,476 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:05:50,477 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:05:50,478 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:05:50,478 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:05:50,482 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:05:50,483 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e7964387-1485-4337-8fc2-364ae8cf993f/f82995a9-3d9b-4c18-9860-42929f74911f', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=ff32df5b-ca07-4550-8e62-9197aa0fcaa5}.
2025-10-08 15:05:50,493 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e7964387-1485-4337-8fc2-364ae8cf993f/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e7964387-1485-4337-8fc2-364ae8cf993f/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:05:50,494 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:05:50,495 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e7964387-1485-4337-8fc2-364ae8cf993f/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e7964387-1485-4337-8fc2-364ae8cf993f/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:05:50,495 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e7964387-1485-4337-8fc2-364ae8cf993f/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e7964387-1485-4337-8fc2-364ae8cf993f/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:05:50,496 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#27 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_27) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e7964387-1485-4337-8fc2-364ae8cf993f/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e7964387-1485-4337-8fc2-364ae8cf993f/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:05:50,496 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#27 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_27).
2025-10-08 15:05:50,498 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#27 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_27.
2025-10-08 15:05:50,518 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#27 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_27).
2025-10-08 15:05:50,518 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#27 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_27) switched from INITIALIZING to CANCELING.
2025-10-08 15:05:50,518 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#27 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_27).
2025-10-08 15:05:50,521 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 3-1 still running. Killing.
2025-10-08 15:05:50,523 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@3962e630, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@220f89e8, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@73ea6e5a, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@47131152, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@69ee3ce6, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@3770b8fa}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:05:50,528 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#27 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_27) switched from CANCELING to CANCELED.
2025-10-08 15:05:50,529 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#27 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_27).
2025-10-08 15:05:50,530 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#27 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_27.
2025-10-08 15:06:48,624 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Free slot TaskSlot(index:4, state:ACTIVE, resource profile: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}, allocationId: 061af1b6749069abb1ce465beb001a6b, jobId: d1f164921ad7c2fe36d4e92a16bdba98).
2025-10-08 15:06:48,625 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Remove job d1f164921ad7c2fe36d4e92a16bdba98 from job leader monitoring.
2025-10-08 15:06:48,625 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Close JobManager connection for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:06:50,609 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Receive slot request 61341874fb49fc00bd3f9d52f838616e for job d1f164921ad7c2fe36d4e92a16bdba98 from resource manager with leader id 00000000000000000000000000000000.
2025-10-08 15:06:50,610 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Allocated slot for 61341874fb49fc00bd3f9d52f838616e with resources ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 15:06:50,610 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Add job d1f164921ad7c2fe36d4e92a16bdba98 for job leader monitoring.
2025-10-08 15:06:50,610 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Try to register at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 with leader id 00000000-0000-0000-0000-000000000000.
2025-10-08 15:06:50,614 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Resolved JobManager address, beginning registration
2025-10-08 15:06:50,618 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Successful registration at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:06:50,618 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Establish JobManager connection for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:06:50,619 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Offer reserved slots to the leader of job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:06:50,624 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 61341874fb49fc00bd3f9d52f838616e.
2025-10-08 15:06:50,628 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 61341874fb49fc00bd3f9d52f838616e.
2025-10-08 15:06:50,629 INFO  org.apache.flink.runtime.state.changelog.StateChangelogStorageLoader [] - Creating a changelog storage with name 'memory'.
2025-10-08 15:06:50,629 INFO  org.apache.flink.runtime.state.TaskExecutorChannelStateExecutorFactoryManager [] - Creating the channel state executor factory for job id d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:06:50,630 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#28 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_28), deploy into slot with allocation id 61341874fb49fc00bd3f9d52f838616e.
2025-10-08 15:06:50,630 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 61341874fb49fc00bd3f9d52f838616e.
2025-10-08 15:06:50,630 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#28 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_28) switched from CREATED to DEPLOYING.
2025-10-08 15:06:50,630 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#28 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_28) [DEPLOYING].
2025-10-08 15:06:50,631 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#28 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_28), deploy into slot with allocation id 61341874fb49fc00bd3f9d52f838616e.
2025-10-08 15:06:50,632 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#28 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_28) switched from CREATED to DEPLOYING.
2025-10-08 15:06:50,632 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#28 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_28) [DEPLOYING].
2025-10-08 15:06:50,633 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:06:50,633 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:06:50,634 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:06:50,634 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:06:50,635 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#28 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_28) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:06:50,651 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:06:50,652 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:06:50,653 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:06:50,653 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:06:50,654 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#28 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_28) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:06:50,681 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:06:50,681 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:06:50,682 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:06:50,682 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:06:50,683 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:06:50,683 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:06:50,684 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:06:50,684 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:06:50,684 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:06:50,684 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:06:50,687 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:06:50,688 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_17369afe-11e6-4a09-99e7-db448f004a6b/f3ebbe09-f1f6-48ac-9d66-6b9bda3a6b61', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=e09a9da2-2a5a-4fa9-923b-1a25252ef254}.
2025-10-08 15:06:50,696 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:06:50,696 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:06:50,700 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_17369afe-11e6-4a09-99e7-db448f004a6b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_17369afe-11e6-4a09-99e7-db448f004a6b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:06:50,700 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:06:50,702 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_17369afe-11e6-4a09-99e7-db448f004a6b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_17369afe-11e6-4a09-99e7-db448f004a6b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:06:50,702 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_17369afe-11e6-4a09-99e7-db448f004a6b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_17369afe-11e6-4a09-99e7-db448f004a6b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:06:50,837 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#28 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_28) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_17369afe-11e6-4a09-99e7-db448f004a6b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_17369afe-11e6-4a09-99e7-db448f004a6b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:06:50,839 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#28 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_28).
2025-10-08 15:06:50,847 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#28 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_28.
2025-10-08 15:06:50,876 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#28 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_28).
2025-10-08 15:06:50,876 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#28 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_28) switched from INITIALIZING to CANCELING.
2025-10-08 15:06:50,876 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#28 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_28).
2025-10-08 15:06:50,921 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Using standard YAML parser to load flink configuration file from /opt/flink/conf/config.yaml.
2025-10-08 15:06:50,930 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: blob.server.port, 6124
2025-10-08 15:06:50,931 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.memory.process.size, 1728m
2025-10-08 15:06:50,931 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.bind-host, 0.0.0.0
2025-10-08 15:06:50,931 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.execution.failover-strategy, region
2025-10-08 15:06:50,931 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.address, 30a48f53a5ec
2025-10-08 15:06:50,931 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.incremental, false
2025-10-08 15:06:50,931 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.rocksdb.localdir, /tmp/rocksdb
2025-10-08 15:06:50,931 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.target, remote
2025-10-08 15:06:50,931 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.memory.process.size, 1600m
2025-10-08 15:06:50,931 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.port, 6123
2025-10-08 15:06:50,931 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: query.server.port, 6125
2025-10-08 15:06:50,931 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.bind-address, 0.0.0.0
2025-10-08 15:06:50,932 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.bind-host, 0.0.0.0
2025-10-08 15:06:50,932 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.savepoint-dir, file:///tmp/flink-checkpoints
2025-10-08 15:06:50,932 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.host, 127.0.0.1
2025-10-08 15:06:50,932 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.externalized-checkpoint-retention, RETAIN_ON_CANCELLATION
2025-10-08 15:06:50,932 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: parallelism.default, 1
2025-10-08 15:06:50,932 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.numberOfTaskSlots, 1
2025-10-08 15:06:50,932 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.local-backup.enabled, true
2025-10-08 15:06:50,932 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.address, 127.0.0.1
2025-10-08 15:06:50,932 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.dir, file:///tmp/flink-checkpoints
2025-10-08 15:06:50,932 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: env.java.opts.all, --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.text=ALL-UNNAMED --add-opens=java.base/java.time=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED
2025-10-08 15:06:50,932 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.type, rocksdb
2025-10-08 15:06:50,950 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:06:50,950 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:06:51,002 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#28 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_28) switched from CANCELING to CANCELED.
2025-10-08 15:06:51,002 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#28 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_28).
2025-10-08 15:06:51,003 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#28 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_28.
2025-10-08 15:07:50,881 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 61341874fb49fc00bd3f9d52f838616e.
2025-10-08 15:07:50,882 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#29 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_29), deploy into slot with allocation id 61341874fb49fc00bd3f9d52f838616e.
2025-10-08 15:07:50,883 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 61341874fb49fc00bd3f9d52f838616e.
2025-10-08 15:07:50,883 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#29 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_29) switched from CREATED to DEPLOYING.
2025-10-08 15:07:50,883 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#29 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_29) [DEPLOYING].
2025-10-08 15:07:50,884 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#29 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_29), deploy into slot with allocation id 61341874fb49fc00bd3f9d52f838616e.
2025-10-08 15:07:50,885 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:07:50,885 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:07:50,885 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#29 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_29) switched from CREATED to DEPLOYING.
2025-10-08 15:07:50,885 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#29 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_29) [DEPLOYING].
2025-10-08 15:07:50,886 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:07:50,886 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:07:50,886 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:07:50,886 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:07:50,886 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#29 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_29) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:07:50,887 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:07:50,888 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:07:50,888 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#29 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_29) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:07:50,889 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:07:50,890 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:07:50,890 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:07:50,890 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:07:50,892 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:07:50,892 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:07:50,893 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:07:50,893 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:07:50,894 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:07:50,894 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:07:50,895 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:07:50,896 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:07:50,898 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:07:50,899 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:07:50,900 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:07:50,900 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:07:50,905 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:07:50,905 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_1c0d07eb-81f1-4f70-bdea-037989556d08/0fcea016-8b8d-4b82-bb76-b2888cda130d', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=25db5fc9-fffa-41da-a6ba-11e66bdeaa27}.
2025-10-08 15:07:50,918 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_1c0d07eb-81f1-4f70-bdea-037989556d08/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_1c0d07eb-81f1-4f70-bdea-037989556d08/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:07:50,919 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:07:50,920 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_1c0d07eb-81f1-4f70-bdea-037989556d08/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_1c0d07eb-81f1-4f70-bdea-037989556d08/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:07:50,920 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_1c0d07eb-81f1-4f70-bdea-037989556d08/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_1c0d07eb-81f1-4f70-bdea-037989556d08/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:07:50,921 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#29 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_29) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_1c0d07eb-81f1-4f70-bdea-037989556d08/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_1c0d07eb-81f1-4f70-bdea-037989556d08/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:07:50,921 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#29 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_29).
2025-10-08 15:07:50,922 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#29 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_29.
2025-10-08 15:07:50,940 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#29 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_29).
2025-10-08 15:07:50,940 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#29 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_29) switched from INITIALIZING to CANCELING.
2025-10-08 15:07:50,940 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#29 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_29).
2025-10-08 15:07:51,624 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#29 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_29) switched from CANCELING to CANCELED.
2025-10-08 15:07:51,625 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#29 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_29).
2025-10-08 15:07:51,626 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#29 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_29.
2025-10-08 15:08:50,943 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 61341874fb49fc00bd3f9d52f838616e.
2025-10-08 15:08:50,944 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#30 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_30), deploy into slot with allocation id 61341874fb49fc00bd3f9d52f838616e.
2025-10-08 15:08:50,945 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 61341874fb49fc00bd3f9d52f838616e.
2025-10-08 15:08:50,945 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#30 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_30) switched from CREATED to DEPLOYING.
2025-10-08 15:08:50,947 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#30 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_30) [DEPLOYING].
2025-10-08 15:08:50,948 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:08:50,949 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:08:50,949 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:08:50,949 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:08:50,950 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#30 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_30) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:08:50,950 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#30 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_30), deploy into slot with allocation id 61341874fb49fc00bd3f9d52f838616e.
2025-10-08 15:08:50,953 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:08:50,953 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:08:50,954 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:08:50,954 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:08:50,952 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#30 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_30) switched from CREATED to DEPLOYING.
2025-10-08 15:08:50,955 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#30 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_30) [DEPLOYING].
2025-10-08 15:08:50,955 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:08:50,955 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:08:50,956 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:08:50,956 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:08:50,956 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:08:50,956 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:08:50,957 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:08:50,957 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:08:50,957 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#30 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_30) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:08:50,964 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:08:50,964 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:08:50,965 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:08:50,966 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:08:50,967 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:08:51,312 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:08:51,313 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:08:51,315 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:08:51,315 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:08:51,318 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:08:51,318 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c5133216-27ea-4c07-8578-b583a4763b2c/cc65263e-5aeb-4bcc-b7b2-386df98eddc3', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=a68da0ed-710f-410c-8639-12fc98104cd9}.
2025-10-08 15:08:51,331 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c5133216-27ea-4c07-8578-b583a4763b2c/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c5133216-27ea-4c07-8578-b583a4763b2c/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:08:51,333 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:08:51,336 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c5133216-27ea-4c07-8578-b583a4763b2c/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c5133216-27ea-4c07-8578-b583a4763b2c/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:08:51,339 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c5133216-27ea-4c07-8578-b583a4763b2c/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c5133216-27ea-4c07-8578-b583a4763b2c/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:08:51,339 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#30 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_30) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c5133216-27ea-4c07-8578-b583a4763b2c/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c5133216-27ea-4c07-8578-b583a4763b2c/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:08:51,342 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#30 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_30).
2025-10-08 15:08:51,344 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#30 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_30.
2025-10-08 15:08:51,352 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#30 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_30).
2025-10-08 15:08:51,353 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#30 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_30) switched from INITIALIZING to CANCELING.
2025-10-08 15:08:51,355 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#30 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_30).
2025-10-08 15:08:51,684 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 1-1 still running. Killing.
2025-10-08 15:08:51,688 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@26ac8e49, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@7eec34a2, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@4d93e022, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@fd61814, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@4dca1161, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@529c755e}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:08:51,694 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#30 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_30) switched from CANCELING to CANCELED.
2025-10-08 15:08:51,694 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#30 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_30).
2025-10-08 15:08:51,694 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#30 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_30.
2025-10-08 15:09:51,366 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 61341874fb49fc00bd3f9d52f838616e.
2025-10-08 15:09:51,369 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#31 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_31), deploy into slot with allocation id 61341874fb49fc00bd3f9d52f838616e.
2025-10-08 15:09:51,369 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 61341874fb49fc00bd3f9d52f838616e.
2025-10-08 15:09:51,369 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#31 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_31) switched from CREATED to DEPLOYING.
2025-10-08 15:09:51,371 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#31 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_31), deploy into slot with allocation id 61341874fb49fc00bd3f9d52f838616e.
2025-10-08 15:09:51,371 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#31 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_31) [DEPLOYING].
2025-10-08 15:09:51,373 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:09:51,373 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:09:51,372 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#31 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_31) switched from CREATED to DEPLOYING.
2025-10-08 15:09:51,373 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#31 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_31) [DEPLOYING].
2025-10-08 15:09:51,373 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:09:51,374 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:09:51,374 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#31 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_31) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:09:51,374 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:09:51,376 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:09:51,376 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:09:51,376 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:09:51,377 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#31 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_31) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:09:51,379 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:09:51,379 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:09:51,380 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:09:51,380 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:09:51,381 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:09:51,381 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:09:51,382 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:09:51,382 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:09:51,384 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:09:51,384 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:09:51,385 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:09:51,385 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:09:51,386 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:09:51,386 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:09:51,387 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:09:51,388 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:09:51,393 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:09:51,393 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_48bbe7a1-cf64-4bec-a2b8-d970303b88a9/34a5ad0f-8916-4d19-9497-5d6082b7f01d', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=c3e2b2f5-ed09-4514-9a48-0fb4041d8fee}.
2025-10-08 15:09:51,415 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_48bbe7a1-cf64-4bec-a2b8-d970303b88a9/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_48bbe7a1-cf64-4bec-a2b8-d970303b88a9/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:09:51,569 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:09:51,569 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:09:51,570 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_48bbe7a1-cf64-4bec-a2b8-d970303b88a9/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_48bbe7a1-cf64-4bec-a2b8-d970303b88a9/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:09:51,571 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_48bbe7a1-cf64-4bec-a2b8-d970303b88a9/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_48bbe7a1-cf64-4bec-a2b8-d970303b88a9/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:09:51,576 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#31 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_31) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_48bbe7a1-cf64-4bec-a2b8-d970303b88a9/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_48bbe7a1-cf64-4bec-a2b8-d970303b88a9/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:09:51,577 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#31 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_31).
2025-10-08 15:09:51,579 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#31 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_31.
2025-10-08 15:09:51,590 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#31 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_31).
2025-10-08 15:09:51,590 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#31 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_31) switched from INITIALIZING to CANCELING.
2025-10-08 15:09:51,590 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#31 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_31).
2025-10-08 15:09:51,593 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 2-1 still running. Killing.
2025-10-08 15:09:51,596 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@74681330, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@65d4b730, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@4b0d9050, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@6a231db2, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@5ee67255, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@1e4b238e}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:09:51,600 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#31 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_31) switched from CANCELING to CANCELED.
2025-10-08 15:09:51,601 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#31 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_31).
2025-10-08 15:09:51,601 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#31 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_31.
2025-10-08 15:10:51,597 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 61341874fb49fc00bd3f9d52f838616e.
2025-10-08 15:10:51,598 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#32 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_32), deploy into slot with allocation id 61341874fb49fc00bd3f9d52f838616e.
2025-10-08 15:10:51,599 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 61341874fb49fc00bd3f9d52f838616e.
2025-10-08 15:10:51,599 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#32 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_32) switched from CREATED to DEPLOYING.
2025-10-08 15:10:51,599 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#32 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_32) [DEPLOYING].
2025-10-08 15:10:51,600 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#32 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_32), deploy into slot with allocation id 61341874fb49fc00bd3f9d52f838616e.
2025-10-08 15:10:51,601 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#32 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_32) switched from CREATED to DEPLOYING.
2025-10-08 15:10:51,602 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#32 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_32) [DEPLOYING].
2025-10-08 15:10:51,602 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:10:51,602 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:10:51,603 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:10:51,603 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:10:51,603 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#32 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_32) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:10:51,604 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:10:51,605 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:10:51,605 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:10:51,605 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:10:51,605 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#32 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_32) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:10:51,607 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:10:51,607 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:10:51,608 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:10:51,609 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:10:51,609 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:10:51,610 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:10:51,610 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:10:51,611 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:10:51,612 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:10:51,612 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:10:51,613 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:10:51,613 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:10:51,615 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:10:51,615 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:10:51,615 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:10:51,615 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0a00ecc3-8e86-4d19-b3d7-5c1005ef3462/19d314c9-92bb-4b47-8cc1-5e310eb03912', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=20a7afaf-43d2-4dfc-8ecc-4e2d93a74a14}.
2025-10-08 15:10:51,617 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:10:51,617 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:10:51,630 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0a00ecc3-8e86-4d19-b3d7-5c1005ef3462/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0a00ecc3-8e86-4d19-b3d7-5c1005ef3462/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:10:51,730 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:10:51,730 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:10:51,731 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0a00ecc3-8e86-4d19-b3d7-5c1005ef3462/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0a00ecc3-8e86-4d19-b3d7-5c1005ef3462/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:10:51,731 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0a00ecc3-8e86-4d19-b3d7-5c1005ef3462/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0a00ecc3-8e86-4d19-b3d7-5c1005ef3462/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:10:51,734 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#32 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_32) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0a00ecc3-8e86-4d19-b3d7-5c1005ef3462/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0a00ecc3-8e86-4d19-b3d7-5c1005ef3462/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:10:51,734 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#32 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_32).
2025-10-08 15:10:51,735 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#32 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_32.
2025-10-08 15:10:51,744 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#32 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_32).
2025-10-08 15:10:51,744 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#32 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_32) switched from INITIALIZING to CANCELING.
2025-10-08 15:10:51,745 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#32 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_32).
2025-10-08 15:10:51,754 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@377ade28, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@63463255, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@34d91dbb, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@71198ad, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@66fb9df9, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@347dcfe9}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:10:51,760 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#32 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_32) switched from CANCELING to CANCELED.
2025-10-08 15:10:51,760 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#32 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_32).
2025-10-08 15:10:51,762 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#32 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_32.
2025-10-08 15:11:48,627 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Free slot TaskSlot(index:5, state:ACTIVE, resource profile: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}, allocationId: 61341874fb49fc00bd3f9d52f838616e, jobId: d1f164921ad7c2fe36d4e92a16bdba98).
2025-10-08 15:11:48,627 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Remove job d1f164921ad7c2fe36d4e92a16bdba98 from job leader monitoring.
2025-10-08 15:11:48,627 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Close JobManager connection for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:11:51,839 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Receive slot request d9db0df651efa64cbc14c8d505cc4b91 for job d1f164921ad7c2fe36d4e92a16bdba98 from resource manager with leader id 00000000000000000000000000000000.
2025-10-08 15:11:51,840 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Allocated slot for d9db0df651efa64cbc14c8d505cc4b91 with resources ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 15:11:51,840 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Add job d1f164921ad7c2fe36d4e92a16bdba98 for job leader monitoring.
2025-10-08 15:11:51,840 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Try to register at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 with leader id 00000000-0000-0000-0000-000000000000.
2025-10-08 15:11:51,844 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Resolved JobManager address, beginning registration
2025-10-08 15:11:51,847 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Successful registration at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:11:51,848 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Establish JobManager connection for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:11:51,848 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Offer reserved slots to the leader of job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:11:51,852 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot d9db0df651efa64cbc14c8d505cc4b91.
2025-10-08 15:11:51,853 INFO  org.apache.flink.runtime.state.changelog.StateChangelogStorageLoader [] - Creating a changelog storage with name 'memory'.
2025-10-08 15:11:51,853 INFO  org.apache.flink.runtime.state.TaskExecutorChannelStateExecutorFactoryManager [] - Creating the channel state executor factory for job id d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:11:51,854 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#33 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_33), deploy into slot with allocation id d9db0df651efa64cbc14c8d505cc4b91.
2025-10-08 15:11:51,854 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot d9db0df651efa64cbc14c8d505cc4b91.
2025-10-08 15:11:51,854 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#33 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_33) switched from CREATED to DEPLOYING.
2025-10-08 15:11:51,854 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot d9db0df651efa64cbc14c8d505cc4b91.
2025-10-08 15:11:51,855 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#33 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_33) [DEPLOYING].
2025-10-08 15:11:51,856 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#33 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_33), deploy into slot with allocation id d9db0df651efa64cbc14c8d505cc4b91.
2025-10-08 15:11:51,856 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#33 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_33) switched from CREATED to DEPLOYING.
2025-10-08 15:11:51,857 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#33 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_33) [DEPLOYING].
2025-10-08 15:11:51,857 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:11:51,859 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:11:51,860 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:11:51,860 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:11:51,860 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#33 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_33) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:11:51,863 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:11:51,863 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:11:51,863 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:11:51,864 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:11:51,864 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#33 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_33) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:11:51,878 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:11:51,878 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:11:51,881 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:11:51,881 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:11:51,882 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:11:51,883 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:11:51,884 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:11:51,884 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:11:51,884 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:11:51,885 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:11:51,885 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:11:51,886 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:11:51,888 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:11:51,888 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6ff98e7d-6ce6-43c1-8551-8440dfb56c1c/ca1d0055-cad1-487c-80fb-3bdaa7d8d2dc', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=9f4c34a0-26f6-408c-aac7-8922b7e8e5c6}.
2025-10-08 15:11:51,898 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6ff98e7d-6ce6-43c1-8551-8440dfb56c1c/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6ff98e7d-6ce6-43c1-8551-8440dfb56c1c/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:11:51,899 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:11:51,899 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6ff98e7d-6ce6-43c1-8551-8440dfb56c1c/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6ff98e7d-6ce6-43c1-8551-8440dfb56c1c/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:11:51,900 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6ff98e7d-6ce6-43c1-8551-8440dfb56c1c/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6ff98e7d-6ce6-43c1-8551-8440dfb56c1c/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:11:52,001 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#33 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_33) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6ff98e7d-6ce6-43c1-8551-8440dfb56c1c/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6ff98e7d-6ce6-43c1-8551-8440dfb56c1c/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:11:52,002 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#33 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_33).
2025-10-08 15:11:52,003 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#33 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_33.
2025-10-08 15:11:52,022 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#33 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_33).
2025-10-08 15:11:52,022 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#33 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_33) switched from INITIALIZING to CANCELING.
2025-10-08 15:11:52,023 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#33 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_33).
2025-10-08 15:11:52,041 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Using standard YAML parser to load flink configuration file from /opt/flink/conf/config.yaml.
2025-10-08 15:11:52,045 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: blob.server.port, 6124
2025-10-08 15:11:52,045 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.memory.process.size, 1728m
2025-10-08 15:11:52,045 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.bind-host, 0.0.0.0
2025-10-08 15:11:52,045 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.execution.failover-strategy, region
2025-10-08 15:11:52,045 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.address, 30a48f53a5ec
2025-10-08 15:11:52,045 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.incremental, false
2025-10-08 15:11:52,045 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.rocksdb.localdir, /tmp/rocksdb
2025-10-08 15:11:52,045 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.target, remote
2025-10-08 15:11:52,045 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.memory.process.size, 1600m
2025-10-08 15:11:52,045 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.port, 6123
2025-10-08 15:11:52,045 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: query.server.port, 6125
2025-10-08 15:11:52,045 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.bind-address, 0.0.0.0
2025-10-08 15:11:52,045 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.bind-host, 0.0.0.0
2025-10-08 15:11:52,045 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.savepoint-dir, file:///tmp/flink-checkpoints
2025-10-08 15:11:52,045 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.host, 127.0.0.1
2025-10-08 15:11:52,045 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.externalized-checkpoint-retention, RETAIN_ON_CANCELLATION
2025-10-08 15:11:52,045 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: parallelism.default, 1
2025-10-08 15:11:52,045 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.numberOfTaskSlots, 1
2025-10-08 15:11:52,045 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.local-backup.enabled, true
2025-10-08 15:11:52,045 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.address, 127.0.0.1
2025-10-08 15:11:52,045 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.dir, file:///tmp/flink-checkpoints
2025-10-08 15:11:52,045 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: env.java.opts.all, --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.text=ALL-UNNAMED --add-opens=java.base/java.time=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED
2025-10-08 15:11:52,045 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.type, rocksdb
2025-10-08 15:11:52,057 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:11:52,057 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:11:52,098 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#33 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_33) switched from CANCELING to CANCELED.
2025-10-08 15:11:52,099 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#33 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_33).
2025-10-08 15:11:52,099 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#33 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_33.
2025-10-08 15:12:52,027 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot d9db0df651efa64cbc14c8d505cc4b91.
2025-10-08 15:12:52,028 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#34 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_34), deploy into slot with allocation id d9db0df651efa64cbc14c8d505cc4b91.
2025-10-08 15:12:52,029 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot d9db0df651efa64cbc14c8d505cc4b91.
2025-10-08 15:12:52,029 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#34 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_34) switched from CREATED to DEPLOYING.
2025-10-08 15:12:52,030 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#34 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_34) [DEPLOYING].
2025-10-08 15:12:52,031 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:12:52,031 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#34 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_34), deploy into slot with allocation id d9db0df651efa64cbc14c8d505cc4b91.
2025-10-08 15:12:52,031 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:12:52,031 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#34 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_34) switched from CREATED to DEPLOYING.
2025-10-08 15:12:52,032 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#34 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_34) [DEPLOYING].
2025-10-08 15:12:52,032 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:12:52,032 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:12:52,032 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:12:52,033 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:12:52,033 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#34 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_34) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:12:52,033 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:12:52,034 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:12:52,035 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#34 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_34) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:12:52,039 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:12:52,040 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:12:52,039 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:12:52,041 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:12:52,042 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:12:52,042 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:12:52,042 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:12:52,043 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:12:52,043 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:12:52,045 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:12:52,046 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:12:52,044 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:12:52,047 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:12:52,047 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:12:52,048 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:12:52,049 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:12:52,055 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:12:52,056 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a8496283-28d7-46a4-ac7a-af43a8ea0354/9d44387e-b73e-43f8-8980-0a98a287c4a0', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=c6b21b28-aa99-420d-a320-69e3a074eed1}.
2025-10-08 15:12:52,075 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a8496283-28d7-46a4-ac7a-af43a8ea0354/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a8496283-28d7-46a4-ac7a-af43a8ea0354/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:12:52,076 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:12:52,077 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a8496283-28d7-46a4-ac7a-af43a8ea0354/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a8496283-28d7-46a4-ac7a-af43a8ea0354/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:12:52,077 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a8496283-28d7-46a4-ac7a-af43a8ea0354/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a8496283-28d7-46a4-ac7a-af43a8ea0354/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:12:52,079 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#34 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_34) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a8496283-28d7-46a4-ac7a-af43a8ea0354/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a8496283-28d7-46a4-ac7a-af43a8ea0354/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:12:52,080 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#34 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_34).
2025-10-08 15:12:52,081 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#34 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_34.
2025-10-08 15:12:52,090 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#34 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_34).
2025-10-08 15:12:52,091 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#34 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_34) switched from INITIALIZING to CANCELING.
2025-10-08 15:12:52,091 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#34 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_34).
2025-10-08 15:12:52,670 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#34 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_34) switched from CANCELING to CANCELED.
2025-10-08 15:12:52,670 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#34 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_34).
2025-10-08 15:12:52,671 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#34 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_34.
2025-10-08 15:13:52,097 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot d9db0df651efa64cbc14c8d505cc4b91.
2025-10-08 15:13:52,098 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#35 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_35), deploy into slot with allocation id d9db0df651efa64cbc14c8d505cc4b91.
2025-10-08 15:13:52,099 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot d9db0df651efa64cbc14c8d505cc4b91.
2025-10-08 15:13:52,099 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#35 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_35) switched from CREATED to DEPLOYING.
2025-10-08 15:13:52,099 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#35 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_35) [DEPLOYING].
2025-10-08 15:13:52,100 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#35 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_35), deploy into slot with allocation id d9db0df651efa64cbc14c8d505cc4b91.
2025-10-08 15:13:52,100 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#35 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_35) switched from CREATED to DEPLOYING.
2025-10-08 15:13:52,101 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#35 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_35) [DEPLOYING].
2025-10-08 15:13:52,101 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:13:52,101 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:13:52,101 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:13:52,102 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:13:52,102 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:13:52,102 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:13:52,102 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:13:52,102 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:13:52,103 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#35 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_35) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:13:52,103 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#35 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_35) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:13:52,105 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:13:52,106 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:13:52,107 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:13:52,107 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:13:52,108 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:13:52,108 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:13:52,109 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:13:52,109 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:13:52,111 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:13:52,111 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:13:52,112 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:13:52,112 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:13:52,113 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:13:52,114 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_eadfe59f-f57d-4bbf-bc5e-12f4fb441c3d/67601f67-5c3d-46b1-8396-d3241b84f2d8', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=94191c92-1cd2-40bc-9b6b-360e53fdfbe9}.
2025-10-08 15:13:52,114 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:13:52,115 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:13:52,115 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:13:52,116 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:13:52,133 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_eadfe59f-f57d-4bbf-bc5e-12f4fb441c3d/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_eadfe59f-f57d-4bbf-bc5e-12f4fb441c3d/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:13:52,355 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:13:52,356 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:13:52,358 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_eadfe59f-f57d-4bbf-bc5e-12f4fb441c3d/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_eadfe59f-f57d-4bbf-bc5e-12f4fb441c3d/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:13:52,358 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_eadfe59f-f57d-4bbf-bc5e-12f4fb441c3d/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_eadfe59f-f57d-4bbf-bc5e-12f4fb441c3d/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:13:52,359 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#35 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_35) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_eadfe59f-f57d-4bbf-bc5e-12f4fb441c3d/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_eadfe59f-f57d-4bbf-bc5e-12f4fb441c3d/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:13:52,361 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#35 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_35).
2025-10-08 15:13:52,362 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#35 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_35.
2025-10-08 15:13:52,371 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#35 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_35).
2025-10-08 15:13:52,371 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#35 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_35) switched from INITIALIZING to CANCELING.
2025-10-08 15:13:52,372 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#35 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_35).
2025-10-08 15:13:52,641 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 1-1 still running. Killing.
2025-10-08 15:13:52,649 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@2833c3af, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@2144ecfb, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@5735f500, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@1548ef03, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@235078be, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@25f56b1b}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:13:52,684 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#35 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_35) switched from CANCELING to CANCELED.
2025-10-08 15:13:52,684 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#35 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_35).
2025-10-08 15:13:52,689 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#35 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_35.
2025-10-08 15:14:52,378 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot d9db0df651efa64cbc14c8d505cc4b91.
2025-10-08 15:14:52,379 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#36 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_36), deploy into slot with allocation id d9db0df651efa64cbc14c8d505cc4b91.
2025-10-08 15:14:52,379 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot d9db0df651efa64cbc14c8d505cc4b91.
2025-10-08 15:14:52,380 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#36 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_36) switched from CREATED to DEPLOYING.
2025-10-08 15:14:52,381 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#36 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_36), deploy into slot with allocation id d9db0df651efa64cbc14c8d505cc4b91.
2025-10-08 15:14:52,382 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#36 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_36) [DEPLOYING].
2025-10-08 15:14:52,383 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:14:52,383 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:14:52,384 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:14:52,384 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:14:52,384 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#36 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_36) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:14:52,385 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#36 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_36) switched from CREATED to DEPLOYING.
2025-10-08 15:14:52,386 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#36 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_36) [DEPLOYING].
2025-10-08 15:14:52,388 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:14:52,388 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:14:52,388 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:14:52,388 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:14:52,390 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:14:52,388 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:14:52,390 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:14:52,390 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:14:52,390 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#36 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_36) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:14:52,392 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:14:52,392 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:14:52,393 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:14:52,393 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:14:52,393 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:14:52,393 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:14:52,394 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:14:52,394 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:14:52,396 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:14:52,396 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:14:52,397 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:14:52,398 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:14:52,401 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:14:52,402 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_b10c1352-de67-4207-9d7f-9c5231876588/2a3c6a50-5965-44f9-bb12-e52747cca199', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=008b6300-0555-480e-b1d8-9336f865c3c1}.
2025-10-08 15:14:52,427 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_b10c1352-de67-4207-9d7f-9c5231876588/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_b10c1352-de67-4207-9d7f-9c5231876588/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:14:52,593 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:14:52,593 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:14:52,595 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_b10c1352-de67-4207-9d7f-9c5231876588/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_b10c1352-de67-4207-9d7f-9c5231876588/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:14:52,596 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_b10c1352-de67-4207-9d7f-9c5231876588/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_b10c1352-de67-4207-9d7f-9c5231876588/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:14:52,601 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#36 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_36) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_b10c1352-de67-4207-9d7f-9c5231876588/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_b10c1352-de67-4207-9d7f-9c5231876588/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:14:52,602 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#36 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_36).
2025-10-08 15:14:52,604 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#36 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_36.
2025-10-08 15:14:52,627 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#36 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_36).
2025-10-08 15:14:52,627 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#36 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_36) switched from INITIALIZING to CANCELING.
2025-10-08 15:14:52,627 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#36 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_36).
2025-10-08 15:14:52,634 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 2-1 still running. Killing.
2025-10-08 15:14:52,636 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@1054968f, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@6c71300a, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@7f85a4a9, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@4c843756, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@785020a7, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@1dc4aec7}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:14:52,641 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#36 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_36) switched from CANCELING to CANCELED.
2025-10-08 15:14:52,641 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#36 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_36).
2025-10-08 15:14:52,643 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#36 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_36.
2025-10-08 15:15:52,634 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot d9db0df651efa64cbc14c8d505cc4b91.
2025-10-08 15:15:52,635 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#37 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_37), deploy into slot with allocation id d9db0df651efa64cbc14c8d505cc4b91.
2025-10-08 15:15:52,635 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#37 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_37) switched from CREATED to DEPLOYING.
2025-10-08 15:15:52,636 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot d9db0df651efa64cbc14c8d505cc4b91.
2025-10-08 15:15:52,636 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#37 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_37) [DEPLOYING].
2025-10-08 15:15:52,638 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:15:52,638 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#37 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_37), deploy into slot with allocation id d9db0df651efa64cbc14c8d505cc4b91.
2025-10-08 15:15:52,638 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:15:52,638 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#37 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_37) switched from CREATED to DEPLOYING.
2025-10-08 15:15:52,638 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#37 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_37) [DEPLOYING].
2025-10-08 15:15:52,639 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:15:52,639 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:15:52,639 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:15:52,639 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:15:52,640 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#37 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_37) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:15:52,640 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:15:52,640 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:15:52,641 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#37 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_37) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:15:52,645 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:15:52,646 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:15:52,646 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:15:52,646 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:15:52,647 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:15:52,647 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:15:52,648 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:15:52,648 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:15:52,648 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:15:52,649 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:15:52,650 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:15:52,653 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:15:52,654 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:15:52,809 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:15:52,810 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:15:52,813 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:15:52,815 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:15:52,825 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:15:52,825 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_06f8c50d-4a12-4c0f-b500-c40fded1d7d1/e903665a-babf-4dba-ae86-7306d35a94e8', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=105d6951-b7ae-4f41-b896-ef7cb58e689e}.
2025-10-08 15:15:52,858 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_06f8c50d-4a12-4c0f-b500-c40fded1d7d1/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_06f8c50d-4a12-4c0f-b500-c40fded1d7d1/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:15:52,860 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:15:52,862 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_06f8c50d-4a12-4c0f-b500-c40fded1d7d1/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_06f8c50d-4a12-4c0f-b500-c40fded1d7d1/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:15:52,864 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_06f8c50d-4a12-4c0f-b500-c40fded1d7d1/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_06f8c50d-4a12-4c0f-b500-c40fded1d7d1/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:15:52,867 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#37 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_37) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_06f8c50d-4a12-4c0f-b500-c40fded1d7d1/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_06f8c50d-4a12-4c0f-b500-c40fded1d7d1/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:15:52,868 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#37 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_37).
2025-10-08 15:15:52,873 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#37 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_37.
2025-10-08 15:15:52,914 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#37 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_37).
2025-10-08 15:15:52,914 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#37 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_37) switched from INITIALIZING to CANCELING.
2025-10-08 15:15:52,914 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#37 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_37).
2025-10-08 15:15:52,916 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 3-1 still running. Killing.
2025-10-08 15:15:52,928 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@15bc5b10, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@77a12ef7, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@29b5a8b0, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@53c7c518, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@24d460ab, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@5afc3450}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:15:52,942 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#37 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_37) switched from CANCELING to CANCELED.
2025-10-08 15:15:52,942 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#37 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_37).
2025-10-08 15:15:52,945 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#37 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_37.
2025-10-08 15:16:48,629 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Free slot TaskSlot(index:6, state:ACTIVE, resource profile: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}, allocationId: d9db0df651efa64cbc14c8d505cc4b91, jobId: d1f164921ad7c2fe36d4e92a16bdba98).
2025-10-08 15:16:48,629 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Remove job d1f164921ad7c2fe36d4e92a16bdba98 from job leader monitoring.
2025-10-08 15:16:48,629 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Close JobManager connection for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:16:53,000 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Receive slot request 18850ae1ee52aef9d30441b70791301f for job d1f164921ad7c2fe36d4e92a16bdba98 from resource manager with leader id 00000000000000000000000000000000.
2025-10-08 15:16:53,001 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Allocated slot for 18850ae1ee52aef9d30441b70791301f with resources ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 15:16:53,001 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Add job d1f164921ad7c2fe36d4e92a16bdba98 for job leader monitoring.
2025-10-08 15:16:53,001 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Try to register at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 with leader id 00000000-0000-0000-0000-000000000000.
2025-10-08 15:16:53,005 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Resolved JobManager address, beginning registration
2025-10-08 15:16:53,008 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Successful registration at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:16:53,008 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Establish JobManager connection for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:16:53,008 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Offer reserved slots to the leader of job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:16:53,013 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 18850ae1ee52aef9d30441b70791301f.
2025-10-08 15:16:53,016 INFO  org.apache.flink.runtime.state.changelog.StateChangelogStorageLoader [] - Creating a changelog storage with name 'memory'.
2025-10-08 15:16:53,016 INFO  org.apache.flink.runtime.state.TaskExecutorChannelStateExecutorFactoryManager [] - Creating the channel state executor factory for job id d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:16:53,017 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#38 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_38), deploy into slot with allocation id 18850ae1ee52aef9d30441b70791301f.
2025-10-08 15:16:53,017 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#38 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_38) switched from CREATED to DEPLOYING.
2025-10-08 15:16:53,018 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 18850ae1ee52aef9d30441b70791301f.
2025-10-08 15:16:53,018 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 18850ae1ee52aef9d30441b70791301f.
2025-10-08 15:16:53,019 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#38 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_38), deploy into slot with allocation id 18850ae1ee52aef9d30441b70791301f.
2025-10-08 15:16:53,020 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#38 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_38) [DEPLOYING].
2025-10-08 15:16:53,020 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#38 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_38) switched from CREATED to DEPLOYING.
2025-10-08 15:16:53,020 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#38 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_38) [DEPLOYING].
2025-10-08 15:16:53,021 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:16:53,021 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:16:53,022 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:16:53,022 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:16:53,022 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#38 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_38) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:16:53,044 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:16:53,044 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:16:53,045 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:16:53,045 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:16:53,045 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#38 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_38) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:16:53,071 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:16:53,072 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:16:53,072 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:16:53,074 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:16:53,075 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:16:53,075 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:16:53,077 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:16:53,077 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:16:53,079 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:16:53,079 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:16:53,083 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:16:53,083 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:16:53,083 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:16:53,083 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_37d1f291-bcf5-4879-82fa-bfa46f794f58/8d409bda-3877-43ca-b113-76b5c89940d0', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=ca9a0c12-8a88-4666-b687-a8f3d5534de6}.
2025-10-08 15:16:53,103 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_37d1f291-bcf5-4879-82fa-bfa46f794f58/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_37d1f291-bcf5-4879-82fa-bfa46f794f58/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:16:53,106 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:16:53,109 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_37d1f291-bcf5-4879-82fa-bfa46f794f58/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_37d1f291-bcf5-4879-82fa-bfa46f794f58/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:16:53,109 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_37d1f291-bcf5-4879-82fa-bfa46f794f58/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_37d1f291-bcf5-4879-82fa-bfa46f794f58/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:16:53,118 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#38 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_38) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_37d1f291-bcf5-4879-82fa-bfa46f794f58/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_37d1f291-bcf5-4879-82fa-bfa46f794f58/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:16:53,118 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#38 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_38).
2025-10-08 15:16:53,134 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#38 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_38.
2025-10-08 15:16:53,147 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#38 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_38).
2025-10-08 15:16:53,147 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#38 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_38) switched from INITIALIZING to CANCELING.
2025-10-08 15:16:53,147 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#38 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_38).
2025-10-08 15:16:53,174 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Using standard YAML parser to load flink configuration file from /opt/flink/conf/config.yaml.
2025-10-08 15:16:53,178 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: blob.server.port, 6124
2025-10-08 15:16:53,178 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.memory.process.size, 1728m
2025-10-08 15:16:53,178 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.bind-host, 0.0.0.0
2025-10-08 15:16:53,178 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.execution.failover-strategy, region
2025-10-08 15:16:53,178 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.address, 30a48f53a5ec
2025-10-08 15:16:53,178 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.incremental, false
2025-10-08 15:16:53,178 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.rocksdb.localdir, /tmp/rocksdb
2025-10-08 15:16:53,178 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.target, remote
2025-10-08 15:16:53,178 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.memory.process.size, 1600m
2025-10-08 15:16:53,178 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.port, 6123
2025-10-08 15:16:53,178 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: query.server.port, 6125
2025-10-08 15:16:53,178 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.bind-address, 0.0.0.0
2025-10-08 15:16:53,178 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.bind-host, 0.0.0.0
2025-10-08 15:16:53,178 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.savepoint-dir, file:///tmp/flink-checkpoints
2025-10-08 15:16:53,179 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.host, 127.0.0.1
2025-10-08 15:16:53,179 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.externalized-checkpoint-retention, RETAIN_ON_CANCELLATION
2025-10-08 15:16:53,179 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: parallelism.default, 1
2025-10-08 15:16:53,179 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.numberOfTaskSlots, 1
2025-10-08 15:16:53,179 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.local-backup.enabled, true
2025-10-08 15:16:53,179 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.address, 127.0.0.1
2025-10-08 15:16:53,179 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.dir, file:///tmp/flink-checkpoints
2025-10-08 15:16:53,179 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: env.java.opts.all, --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.text=ALL-UNNAMED --add-opens=java.base/java.time=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED
2025-10-08 15:16:53,179 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.type, rocksdb
2025-10-08 15:16:53,193 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:16:53,193 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:16:53,233 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#38 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_38) switched from CANCELING to CANCELED.
2025-10-08 15:16:53,233 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#38 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_38).
2025-10-08 15:16:53,233 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#38 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_38.
2025-10-08 15:17:53,153 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 18850ae1ee52aef9d30441b70791301f.
2025-10-08 15:17:53,154 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#39 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_39), deploy into slot with allocation id 18850ae1ee52aef9d30441b70791301f.
2025-10-08 15:17:53,154 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 18850ae1ee52aef9d30441b70791301f.
2025-10-08 15:17:53,154 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#39 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_39) switched from CREATED to DEPLOYING.
2025-10-08 15:17:53,155 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#39 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_39) [DEPLOYING].
2025-10-08 15:17:53,156 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#39 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_39), deploy into slot with allocation id 18850ae1ee52aef9d30441b70791301f.
2025-10-08 15:17:53,157 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#39 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_39) switched from CREATED to DEPLOYING.
2025-10-08 15:17:53,157 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#39 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_39) [DEPLOYING].
2025-10-08 15:17:53,158 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:17:53,158 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:17:53,158 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:17:53,158 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:17:53,159 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:17:53,159 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:17:53,160 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#39 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_39) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:17:53,160 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:17:53,161 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:17:53,162 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#39 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_39) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:17:53,168 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:17:53,168 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:17:53,169 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:17:53,169 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:17:53,170 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:17:53,171 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:17:53,171 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:17:53,171 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:17:53,172 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:17:53,172 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:17:53,173 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:17:53,174 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:17:53,174 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:17:53,174 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:17:53,174 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:17:53,175 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:17:53,177 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:17:53,178 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7b495b48-4978-451e-a7ba-d19b9ebfbafe/c8c1abc1-7ded-4090-8746-0559bee312b2', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=55c4eb52-3ed8-499c-84f8-6876bd4ed337}.
2025-10-08 15:17:53,190 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7b495b48-4978-451e-a7ba-d19b9ebfbafe/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7b495b48-4978-451e-a7ba-d19b9ebfbafe/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:17:53,190 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:17:53,191 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7b495b48-4978-451e-a7ba-d19b9ebfbafe/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7b495b48-4978-451e-a7ba-d19b9ebfbafe/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:17:53,191 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7b495b48-4978-451e-a7ba-d19b9ebfbafe/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7b495b48-4978-451e-a7ba-d19b9ebfbafe/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:17:53,192 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#39 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_39) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7b495b48-4978-451e-a7ba-d19b9ebfbafe/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7b495b48-4978-451e-a7ba-d19b9ebfbafe/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:17:53,192 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#39 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_39).
2025-10-08 15:17:53,195 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#39 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_39.
2025-10-08 15:17:53,203 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#39 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_39).
2025-10-08 15:17:53,204 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#39 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_39) switched from INITIALIZING to CANCELING.
2025-10-08 15:17:53,204 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#39 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_39).
2025-10-08 15:17:53,802 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#39 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_39) switched from CANCELING to CANCELED.
2025-10-08 15:17:53,802 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#39 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_39).
2025-10-08 15:17:53,803 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#39 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_39.
2025-10-08 15:18:53,209 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 18850ae1ee52aef9d30441b70791301f.
2025-10-08 15:18:53,210 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#40 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_40), deploy into slot with allocation id 18850ae1ee52aef9d30441b70791301f.
2025-10-08 15:18:53,210 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 18850ae1ee52aef9d30441b70791301f.
2025-10-08 15:18:53,210 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#40 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_40) switched from CREATED to DEPLOYING.
2025-10-08 15:18:53,211 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#40 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_40) [DEPLOYING].
2025-10-08 15:18:53,212 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#40 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_40), deploy into slot with allocation id 18850ae1ee52aef9d30441b70791301f.
2025-10-08 15:18:53,213 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:18:53,213 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:18:53,213 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#40 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_40) switched from CREATED to DEPLOYING.
2025-10-08 15:18:53,213 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#40 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_40) [DEPLOYING].
2025-10-08 15:18:53,214 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:18:53,214 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:18:53,214 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:18:53,214 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:18:53,214 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:18:53,214 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#40 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_40) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:18:53,215 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:18:53,215 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#40 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_40) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:18:53,218 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:18:53,218 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:18:53,219 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:18:53,219 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:18:53,219 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:18:53,219 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:18:53,220 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:18:53,220 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:18:53,220 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:18:53,221 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:18:53,221 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:18:53,221 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:18:53,230 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:18:53,557 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:18:53,557 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:18:53,560 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:18:53,560 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:18:53,567 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:18:53,567 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e0735f52-d47f-47f9-8ae5-77a1bac76130/32c85a52-35ed-40ef-8d8f-7631400699c0', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=4c045003-2d87-4e79-9ecd-933fc1dac7cd}.
2025-10-08 15:18:53,580 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e0735f52-d47f-47f9-8ae5-77a1bac76130/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e0735f52-d47f-47f9-8ae5-77a1bac76130/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:18:53,582 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:18:53,584 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e0735f52-d47f-47f9-8ae5-77a1bac76130/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e0735f52-d47f-47f9-8ae5-77a1bac76130/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:18:53,584 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e0735f52-d47f-47f9-8ae5-77a1bac76130/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e0735f52-d47f-47f9-8ae5-77a1bac76130/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:18:53,587 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#40 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_40) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e0735f52-d47f-47f9-8ae5-77a1bac76130/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e0735f52-d47f-47f9-8ae5-77a1bac76130/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:18:53,587 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#40 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_40).
2025-10-08 15:18:53,589 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#40 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_40.
2025-10-08 15:18:53,600 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#40 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_40).
2025-10-08 15:18:53,600 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#40 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_40) switched from INITIALIZING to CANCELING.
2025-10-08 15:18:53,600 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#40 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_40).
2025-10-08 15:18:53,787 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 1-1 still running. Killing.
2025-10-08 15:18:53,791 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@6ec5c4b2, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@51fdd591, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@1caf4db3, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@284eaa44, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@68ee1bab, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@57001a7a}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:18:53,797 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#40 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_40) switched from CANCELING to CANCELED.
2025-10-08 15:18:53,798 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#40 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_40).
2025-10-08 15:18:53,798 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#40 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_40.
2025-10-08 15:19:53,608 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 18850ae1ee52aef9d30441b70791301f.
2025-10-08 15:19:53,609 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#41 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_41), deploy into slot with allocation id 18850ae1ee52aef9d30441b70791301f.
2025-10-08 15:19:53,609 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 18850ae1ee52aef9d30441b70791301f.
2025-10-08 15:19:53,609 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#41 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_41) switched from CREATED to DEPLOYING.
2025-10-08 15:19:53,610 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#41 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_41) [DEPLOYING].
2025-10-08 15:19:53,611 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#41 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_41), deploy into slot with allocation id 18850ae1ee52aef9d30441b70791301f.
2025-10-08 15:19:53,611 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:19:53,612 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:19:53,612 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#41 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_41) switched from CREATED to DEPLOYING.
2025-10-08 15:19:53,613 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#41 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_41) [DEPLOYING].
2025-10-08 15:19:53,613 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:19:53,613 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:19:53,613 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:19:53,614 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:19:53,615 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#41 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_41) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:19:53,615 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:19:53,615 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:19:53,615 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#41 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_41) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:19:53,621 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:19:53,621 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:19:53,623 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:19:53,623 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:19:53,623 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:19:53,624 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:19:53,624 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:19:53,625 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:19:53,624 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:19:53,625 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:19:53,626 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:19:53,626 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:19:53,627 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:19:53,628 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:19:53,626 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:19:53,628 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:19:53,634 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:19:53,634 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_f511dec5-04fc-4c88-8a02-3271ea1afec4/610c4d05-966c-4023-bf58-240a07c53d56', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=642d136e-62cb-4a71-b025-6478685d24a0}.
2025-10-08 15:19:53,648 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_f511dec5-04fc-4c88-8a02-3271ea1afec4/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_f511dec5-04fc-4c88-8a02-3271ea1afec4/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:19:53,738 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:19:53,739 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_f511dec5-04fc-4c88-8a02-3271ea1afec4/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_f511dec5-04fc-4c88-8a02-3271ea1afec4/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:19:53,739 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:19:53,739 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_f511dec5-04fc-4c88-8a02-3271ea1afec4/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_f511dec5-04fc-4c88-8a02-3271ea1afec4/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:19:53,742 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#41 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_41) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_f511dec5-04fc-4c88-8a02-3271ea1afec4/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_f511dec5-04fc-4c88-8a02-3271ea1afec4/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:19:53,744 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#41 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_41).
2025-10-08 15:19:53,745 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#41 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_41.
2025-10-08 15:19:53,753 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#41 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_41).
2025-10-08 15:19:53,754 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#41 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_41) switched from INITIALIZING to CANCELING.
2025-10-08 15:19:53,754 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#41 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_41).
2025-10-08 15:19:53,761 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@50a75505, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@4ab3a872, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@6e67691c, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@136c3c9b, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@79094c8e, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@2eae8be5}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:19:53,763 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#41 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_41) switched from CANCELING to CANCELED.
2025-10-08 15:19:53,764 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#41 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_41).
2025-10-08 15:19:53,764 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#41 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_41.
2025-10-08 15:20:53,765 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 18850ae1ee52aef9d30441b70791301f.
2025-10-08 15:20:53,766 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#42 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_42), deploy into slot with allocation id 18850ae1ee52aef9d30441b70791301f.
2025-10-08 15:20:53,767 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 18850ae1ee52aef9d30441b70791301f.
2025-10-08 15:20:53,767 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#42 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_42) switched from CREATED to DEPLOYING.
2025-10-08 15:20:53,767 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#42 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_42) [DEPLOYING].
2025-10-08 15:20:53,769 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#42 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_42), deploy into slot with allocation id 18850ae1ee52aef9d30441b70791301f.
2025-10-08 15:20:53,769 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:20:53,769 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:20:53,769 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#42 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_42) switched from CREATED to DEPLOYING.
2025-10-08 15:20:53,769 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#42 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_42) [DEPLOYING].
2025-10-08 15:20:53,770 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:20:53,770 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:20:53,770 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:20:53,770 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:20:53,770 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#42 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_42) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:20:53,770 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:20:53,771 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:20:53,771 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#42 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_42) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:20:53,774 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:20:53,774 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:20:53,775 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:20:53,775 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:20:53,775 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:20:53,775 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:20:53,776 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:20:53,776 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:20:53,777 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:20:53,777 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:20:53,777 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:20:53,777 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:20:53,778 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:20:53,778 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:20:53,779 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:20:53,779 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:20:53,785 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:20:53,785 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_bd845f58-db12-4282-94e7-972091b75767/71956906-346b-4bb7-a751-1bb5b0959c9f', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=88bd108d-d0b3-4ce1-88dc-4676b8a520f3}.
2025-10-08 15:20:53,806 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_bd845f58-db12-4282-94e7-972091b75767/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_bd845f58-db12-4282-94e7-972091b75767/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:20:53,891 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:20:53,892 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:20:53,894 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_bd845f58-db12-4282-94e7-972091b75767/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_bd845f58-db12-4282-94e7-972091b75767/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:20:53,894 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_bd845f58-db12-4282-94e7-972091b75767/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_bd845f58-db12-4282-94e7-972091b75767/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:20:53,895 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#42 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_42) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_bd845f58-db12-4282-94e7-972091b75767/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_bd845f58-db12-4282-94e7-972091b75767/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:20:53,898 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#42 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_42).
2025-10-08 15:20:53,900 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#42 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_42.
2025-10-08 15:20:53,916 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#42 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_42).
2025-10-08 15:20:53,916 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#42 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_42) switched from INITIALIZING to CANCELING.
2025-10-08 15:20:53,916 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#42 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_42).
2025-10-08 15:20:53,921 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 3-1 still running. Killing.
2025-10-08 15:20:53,925 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@71383b08, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@af50b81, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@4499114c, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@48e37d60, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@7833ff0f, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@5ab84a8b}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:20:53,932 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#42 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_42) switched from CANCELING to CANCELED.
2025-10-08 15:20:53,932 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#42 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_42).
2025-10-08 15:20:53,933 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#42 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_42.
2025-10-08 15:21:48,631 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Free slot TaskSlot(index:7, state:ACTIVE, resource profile: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}, allocationId: 18850ae1ee52aef9d30441b70791301f, jobId: d1f164921ad7c2fe36d4e92a16bdba98).
2025-10-08 15:21:48,632 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Remove job d1f164921ad7c2fe36d4e92a16bdba98 from job leader monitoring.
2025-10-08 15:21:48,632 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Close JobManager connection for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:21:54,009 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Receive slot request 5dca860da127f9de667805ffd89c48a8 for job d1f164921ad7c2fe36d4e92a16bdba98 from resource manager with leader id 00000000000000000000000000000000.
2025-10-08 15:21:54,010 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Allocated slot for 5dca860da127f9de667805ffd89c48a8 with resources ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 15:21:54,010 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Add job d1f164921ad7c2fe36d4e92a16bdba98 for job leader monitoring.
2025-10-08 15:21:54,010 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Try to register at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 with leader id 00000000-0000-0000-0000-000000000000.
2025-10-08 15:21:54,015 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Resolved JobManager address, beginning registration
2025-10-08 15:21:54,020 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Successful registration at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:21:54,020 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Establish JobManager connection for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:21:54,020 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Offer reserved slots to the leader of job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:21:54,027 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 5dca860da127f9de667805ffd89c48a8.
2025-10-08 15:21:54,028 INFO  org.apache.flink.runtime.state.changelog.StateChangelogStorageLoader [] - Creating a changelog storage with name 'memory'.
2025-10-08 15:21:54,029 INFO  org.apache.flink.runtime.state.TaskExecutorChannelStateExecutorFactoryManager [] - Creating the channel state executor factory for job id d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:21:54,029 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#43 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_43), deploy into slot with allocation id 5dca860da127f9de667805ffd89c48a8.
2025-10-08 15:21:54,030 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 5dca860da127f9de667805ffd89c48a8.
2025-10-08 15:21:54,030 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#43 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_43) switched from CREATED to DEPLOYING.
2025-10-08 15:21:54,031 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#43 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_43) [DEPLOYING].
2025-10-08 15:21:54,031 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#43 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_43), deploy into slot with allocation id 5dca860da127f9de667805ffd89c48a8.
2025-10-08 15:21:54,031 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 5dca860da127f9de667805ffd89c48a8.
2025-10-08 15:21:54,032 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#43 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_43) switched from CREATED to DEPLOYING.
2025-10-08 15:21:54,032 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#43 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_43) [DEPLOYING].
2025-10-08 15:21:54,032 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:21:54,033 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:21:54,033 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:21:54,034 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:21:54,034 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#43 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_43) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:21:54,041 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:21:54,041 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:21:54,042 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:21:54,042 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:21:54,042 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#43 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_43) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:21:54,062 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:21:54,062 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:21:54,064 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:21:54,064 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:21:54,065 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:21:54,066 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:21:54,068 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:21:54,068 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:21:54,070 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:21:54,070 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:21:54,073 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:21:54,073 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:21:54,075 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:21:54,076 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_481fa96b-daa5-4c4b-8172-95744ba9fb40/1bcd814c-9ea4-4553-9e50-cb6d23db47f9', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=b8ffa93b-ca2c-4851-8a0b-3d692d44e397}.
2025-10-08 15:21:54,095 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_481fa96b-daa5-4c4b-8172-95744ba9fb40/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_481fa96b-daa5-4c4b-8172-95744ba9fb40/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:21:54,099 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:21:54,099 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_481fa96b-daa5-4c4b-8172-95744ba9fb40/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_481fa96b-daa5-4c4b-8172-95744ba9fb40/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:21:54,100 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_481fa96b-daa5-4c4b-8172-95744ba9fb40/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_481fa96b-daa5-4c4b-8172-95744ba9fb40/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:21:54,211 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#43 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_43) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_481fa96b-daa5-4c4b-8172-95744ba9fb40/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_481fa96b-daa5-4c4b-8172-95744ba9fb40/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:21:54,214 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#43 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_43).
2025-10-08 15:21:54,216 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#43 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_43.
2025-10-08 15:21:54,231 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#43 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_43).
2025-10-08 15:21:54,231 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#43 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_43) switched from INITIALIZING to CANCELING.
2025-10-08 15:21:54,231 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#43 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_43).
2025-10-08 15:21:54,281 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Using standard YAML parser to load flink configuration file from /opt/flink/conf/config.yaml.
2025-10-08 15:21:54,290 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: blob.server.port, 6124
2025-10-08 15:21:54,290 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.memory.process.size, 1728m
2025-10-08 15:21:54,290 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.bind-host, 0.0.0.0
2025-10-08 15:21:54,290 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.execution.failover-strategy, region
2025-10-08 15:21:54,290 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.address, 30a48f53a5ec
2025-10-08 15:21:54,290 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.incremental, false
2025-10-08 15:21:54,290 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.rocksdb.localdir, /tmp/rocksdb
2025-10-08 15:21:54,290 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.target, remote
2025-10-08 15:21:54,290 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.memory.process.size, 1600m
2025-10-08 15:21:54,290 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.port, 6123
2025-10-08 15:21:54,290 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: query.server.port, 6125
2025-10-08 15:21:54,290 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.bind-address, 0.0.0.0
2025-10-08 15:21:54,290 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.bind-host, 0.0.0.0
2025-10-08 15:21:54,290 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.savepoint-dir, file:///tmp/flink-checkpoints
2025-10-08 15:21:54,291 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.host, 127.0.0.1
2025-10-08 15:21:54,291 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.externalized-checkpoint-retention, RETAIN_ON_CANCELLATION
2025-10-08 15:21:54,291 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: parallelism.default, 1
2025-10-08 15:21:54,291 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.numberOfTaskSlots, 1
2025-10-08 15:21:54,291 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.local-backup.enabled, true
2025-10-08 15:21:54,291 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.address, 127.0.0.1
2025-10-08 15:21:54,291 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.dir, file:///tmp/flink-checkpoints
2025-10-08 15:21:54,291 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: env.java.opts.all, --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.text=ALL-UNNAMED --add-opens=java.base/java.time=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED
2025-10-08 15:21:54,291 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.type, rocksdb
2025-10-08 15:21:54,315 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:21:54,320 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:21:54,381 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#43 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_43) switched from CANCELING to CANCELED.
2025-10-08 15:21:54,381 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#43 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_43).
2025-10-08 15:21:54,382 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#43 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_43.
2025-10-08 15:22:54,234 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 5dca860da127f9de667805ffd89c48a8.
2025-10-08 15:22:54,235 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#44 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_44), deploy into slot with allocation id 5dca860da127f9de667805ffd89c48a8.
2025-10-08 15:22:54,236 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 5dca860da127f9de667805ffd89c48a8.
2025-10-08 15:22:54,236 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#44 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_44) switched from CREATED to DEPLOYING.
2025-10-08 15:22:54,236 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#44 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_44) [DEPLOYING].
2025-10-08 15:22:54,237 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#44 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_44), deploy into slot with allocation id 5dca860da127f9de667805ffd89c48a8.
2025-10-08 15:22:54,237 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:22:54,237 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:22:54,238 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:22:54,238 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:22:54,238 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#44 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_44) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:22:54,239 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#44 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_44) switched from CREATED to DEPLOYING.
2025-10-08 15:22:54,240 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#44 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_44) [DEPLOYING].
2025-10-08 15:22:54,240 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:22:54,241 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:22:54,242 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:22:54,242 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:22:54,242 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#44 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_44) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:22:54,242 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:22:54,242 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:22:54,243 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:22:54,243 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:22:54,244 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:22:54,244 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:22:54,245 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:22:54,245 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:22:54,249 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:22:54,249 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:22:54,250 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:22:54,251 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:22:54,253 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:22:54,257 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:22:54,257 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:22:54,258 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:22:54,264 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:22:54,264 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_2bd1440c-4940-44d7-a1a9-4f847fbf9241/69f3d9fd-95ca-4d67-b1c2-4ead9ee923e9', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=09c845b2-0261-43f2-89ac-d2ee2105f588}.
2025-10-08 15:22:54,284 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_2bd1440c-4940-44d7-a1a9-4f847fbf9241/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_2bd1440c-4940-44d7-a1a9-4f847fbf9241/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:22:54,285 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:22:54,285 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_2bd1440c-4940-44d7-a1a9-4f847fbf9241/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_2bd1440c-4940-44d7-a1a9-4f847fbf9241/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:22:54,286 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_2bd1440c-4940-44d7-a1a9-4f847fbf9241/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_2bd1440c-4940-44d7-a1a9-4f847fbf9241/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:22:54,288 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#44 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_44) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_2bd1440c-4940-44d7-a1a9-4f847fbf9241/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_2bd1440c-4940-44d7-a1a9-4f847fbf9241/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:22:54,288 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#44 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_44).
2025-10-08 15:22:54,289 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#44 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_44.
2025-10-08 15:22:54,309 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#44 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_44).
2025-10-08 15:22:54,310 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#44 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_44) switched from INITIALIZING to CANCELING.
2025-10-08 15:22:54,310 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#44 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_44).
2025-10-08 15:22:54,788 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#44 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_44) switched from CANCELING to CANCELED.
2025-10-08 15:22:54,788 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#44 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_44).
2025-10-08 15:22:54,790 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#44 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_44.
2025-10-08 15:23:54,310 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 5dca860da127f9de667805ffd89c48a8.
2025-10-08 15:23:54,311 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#45 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_45), deploy into slot with allocation id 5dca860da127f9de667805ffd89c48a8.
2025-10-08 15:23:54,311 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#45 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_45) switched from CREATED to DEPLOYING.
2025-10-08 15:23:54,312 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 5dca860da127f9de667805ffd89c48a8.
2025-10-08 15:23:54,313 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#45 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_45) [DEPLOYING].
2025-10-08 15:23:54,313 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#45 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_45), deploy into slot with allocation id 5dca860da127f9de667805ffd89c48a8.
2025-10-08 15:23:54,313 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#45 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_45) switched from CREATED to DEPLOYING.
2025-10-08 15:23:54,314 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#45 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_45) [DEPLOYING].
2025-10-08 15:23:54,314 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:23:54,314 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:23:54,314 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:23:54,314 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:23:54,315 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:23:54,315 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:23:54,315 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:23:54,315 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#45 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_45) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:23:54,316 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:23:54,316 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#45 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_45) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:23:54,318 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:23:54,318 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:23:54,319 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:23:54,319 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:23:54,322 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:23:54,322 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:23:54,323 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:23:54,323 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:23:54,324 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:23:54,324 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:23:54,324 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:23:54,324 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:23:54,326 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:23:54,326 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:23:54,326 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:23:54,327 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:23:54,329 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:23:54,329 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_30bf6c5d-1805-4853-b4b1-a2270d051258/6caa69f3-50f8-4a30-9608-5e22985e565c', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=75590b57-1585-4751-904c-f2d594fb307e}.
2025-10-08 15:23:54,348 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_30bf6c5d-1805-4853-b4b1-a2270d051258/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_30bf6c5d-1805-4853-b4b1-a2270d051258/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:23:54,564 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:23:54,567 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:23:54,568 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_30bf6c5d-1805-4853-b4b1-a2270d051258/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_30bf6c5d-1805-4853-b4b1-a2270d051258/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:23:54,568 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_30bf6c5d-1805-4853-b4b1-a2270d051258/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_30bf6c5d-1805-4853-b4b1-a2270d051258/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:23:54,571 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#45 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_45) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_30bf6c5d-1805-4853-b4b1-a2270d051258/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_30bf6c5d-1805-4853-b4b1-a2270d051258/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:23:54,571 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#45 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_45).
2025-10-08 15:23:54,572 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#45 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_45.
2025-10-08 15:23:54,580 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#45 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_45).
2025-10-08 15:23:54,581 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#45 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_45) switched from INITIALIZING to CANCELING.
2025-10-08 15:23:54,581 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#45 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_45).
2025-10-08 15:23:54,765 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 1-1 still running. Killing.
2025-10-08 15:23:54,772 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@402bc8f2, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@6a5bf5db, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@5740040a, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@466a0f30, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@58982357, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@6d58f0b2}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:23:54,780 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#45 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_45) switched from CANCELING to CANCELED.
2025-10-08 15:23:54,780 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#45 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_45).
2025-10-08 15:23:54,780 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#45 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_45.
2025-10-08 15:24:54,586 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 5dca860da127f9de667805ffd89c48a8.
2025-10-08 15:24:54,587 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#46 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_46), deploy into slot with allocation id 5dca860da127f9de667805ffd89c48a8.
2025-10-08 15:24:54,588 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#46 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_46) switched from CREATED to DEPLOYING.
2025-10-08 15:24:54,589 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#46 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_46) [DEPLOYING].
2025-10-08 15:24:54,590 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 5dca860da127f9de667805ffd89c48a8.
2025-10-08 15:24:54,590 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:24:54,591 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:24:54,591 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:24:54,592 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:24:54,592 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#46 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_46) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:24:54,593 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#46 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_46), deploy into slot with allocation id 5dca860da127f9de667805ffd89c48a8.
2025-10-08 15:24:54,594 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#46 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_46) switched from CREATED to DEPLOYING.
2025-10-08 15:24:54,595 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#46 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_46) [DEPLOYING].
2025-10-08 15:24:54,595 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:24:54,595 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:24:54,596 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:24:54,597 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:24:54,598 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#46 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_46) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:24:54,598 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:24:54,598 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:24:54,598 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:24:54,600 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:24:54,600 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:24:54,601 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:24:54,601 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:24:54,601 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:24:54,602 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:24:54,602 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:24:54,603 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:24:54,603 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:24:54,604 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:24:54,604 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:24:54,604 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:24:54,605 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:24:54,608 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:24:54,609 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_df858050-f711-43cb-921f-f1c14fa81916/09702e0d-779e-41ea-8185-36f3b6febcf7', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=7183c111-4f0d-41ff-af3d-b4302ffdcb46}.
2025-10-08 15:24:54,627 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_df858050-f711-43cb-921f-f1c14fa81916/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_df858050-f711-43cb-921f-f1c14fa81916/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:24:54,736 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:24:54,736 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:24:54,737 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_df858050-f711-43cb-921f-f1c14fa81916/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_df858050-f711-43cb-921f-f1c14fa81916/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:24:54,737 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_df858050-f711-43cb-921f-f1c14fa81916/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_df858050-f711-43cb-921f-f1c14fa81916/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:24:54,738 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#46 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_46) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_df858050-f711-43cb-921f-f1c14fa81916/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_df858050-f711-43cb-921f-f1c14fa81916/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:24:54,738 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#46 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_46).
2025-10-08 15:24:54,739 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#46 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_46.
2025-10-08 15:24:54,748 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#46 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_46).
2025-10-08 15:24:54,748 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#46 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_46) switched from INITIALIZING to CANCELING.
2025-10-08 15:24:54,748 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#46 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_46).
2025-10-08 15:24:54,753 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 2-1 still running. Killing.
2025-10-08 15:24:54,754 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@75de269b, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@542a1520, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@4f18acd4, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@123bb369, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@16d5b54b, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@125231a4}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:24:54,757 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#46 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_46) switched from CANCELING to CANCELED.
2025-10-08 15:24:54,757 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#46 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_46).
2025-10-08 15:24:54,757 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#46 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_46.
2025-10-08 15:25:54,752 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 5dca860da127f9de667805ffd89c48a8.
2025-10-08 15:25:54,753 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#47 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_47), deploy into slot with allocation id 5dca860da127f9de667805ffd89c48a8.
2025-10-08 15:25:54,753 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 5dca860da127f9de667805ffd89c48a8.
2025-10-08 15:25:54,754 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#47 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_47), deploy into slot with allocation id 5dca860da127f9de667805ffd89c48a8.
2025-10-08 15:25:54,755 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#47 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_47) switched from CREATED to DEPLOYING.
2025-10-08 15:25:54,756 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#47 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_47) switched from CREATED to DEPLOYING.
2025-10-08 15:25:54,756 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#47 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_47) [DEPLOYING].
2025-10-08 15:25:54,757 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:25:54,757 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:25:54,757 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:25:54,757 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:25:54,757 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#47 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_47) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:25:54,758 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#47 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_47) [DEPLOYING].
2025-10-08 15:25:54,760 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:25:54,760 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:25:54,760 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:25:54,760 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:25:54,760 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#47 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_47) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:25:54,764 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:25:54,764 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:25:54,764 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:25:54,764 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:25:54,766 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:25:54,767 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:25:54,767 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:25:54,767 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:25:54,768 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:25:54,768 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:25:54,768 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:25:54,769 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:25:54,771 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:25:54,771 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:25:54,771 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:25:54,771 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:25:54,774 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:25:54,774 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6ca2df97-0f18-4a33-b2f0-31085d70e34f/a0136864-fe87-4ad7-989f-67c2f73e784e', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=806d1dfe-4944-457c-ba48-3eeb55ded994}.
2025-10-08 15:25:54,783 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6ca2df97-0f18-4a33-b2f0-31085d70e34f/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6ca2df97-0f18-4a33-b2f0-31085d70e34f/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:25:54,888 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:25:54,888 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:25:54,889 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6ca2df97-0f18-4a33-b2f0-31085d70e34f/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6ca2df97-0f18-4a33-b2f0-31085d70e34f/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:25:54,890 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6ca2df97-0f18-4a33-b2f0-31085d70e34f/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6ca2df97-0f18-4a33-b2f0-31085d70e34f/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:25:54,894 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#47 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_47) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6ca2df97-0f18-4a33-b2f0-31085d70e34f/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6ca2df97-0f18-4a33-b2f0-31085d70e34f/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:25:54,894 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#47 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_47).
2025-10-08 15:25:54,896 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#47 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_47.
2025-10-08 15:25:54,903 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#47 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_47).
2025-10-08 15:25:54,903 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#47 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_47) switched from INITIALIZING to CANCELING.
2025-10-08 15:25:54,903 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#47 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_47).
2025-10-08 15:25:54,907 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 3-1 still running. Killing.
2025-10-08 15:25:54,908 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@2ffa604b, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@6b42132e, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@30cc5590, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@44dd7cb7, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@38d9b45f, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@43f91b09}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:25:54,911 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#47 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_47) switched from CANCELING to CANCELED.
2025-10-08 15:25:54,911 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#47 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_47).
2025-10-08 15:25:54,911 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#47 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_47.
2025-10-08 15:26:48,634 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Free slot TaskSlot(index:8, state:ACTIVE, resource profile: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}, allocationId: 5dca860da127f9de667805ffd89c48a8, jobId: d1f164921ad7c2fe36d4e92a16bdba98).
2025-10-08 15:26:48,635 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Remove job d1f164921ad7c2fe36d4e92a16bdba98 from job leader monitoring.
2025-10-08 15:26:48,635 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Close JobManager connection for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:26:54,990 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Receive slot request f3a96c530f6ea47a289c7320ec40b2f8 for job d1f164921ad7c2fe36d4e92a16bdba98 from resource manager with leader id 00000000000000000000000000000000.
2025-10-08 15:26:54,990 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Allocated slot for f3a96c530f6ea47a289c7320ec40b2f8 with resources ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 15:26:54,990 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Add job d1f164921ad7c2fe36d4e92a16bdba98 for job leader monitoring.
2025-10-08 15:26:54,990 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Try to register at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 with leader id 00000000-0000-0000-0000-000000000000.
2025-10-08 15:26:54,995 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Resolved JobManager address, beginning registration
2025-10-08 15:26:54,999 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Successful registration at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:26:54,999 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Establish JobManager connection for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:26:54,999 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Offer reserved slots to the leader of job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:26:55,003 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot f3a96c530f6ea47a289c7320ec40b2f8.
2025-10-08 15:26:55,004 INFO  org.apache.flink.runtime.state.changelog.StateChangelogStorageLoader [] - Creating a changelog storage with name 'memory'.
2025-10-08 15:26:55,004 INFO  org.apache.flink.runtime.state.TaskExecutorChannelStateExecutorFactoryManager [] - Creating the channel state executor factory for job id d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:26:55,004 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#48 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_48), deploy into slot with allocation id f3a96c530f6ea47a289c7320ec40b2f8.
2025-10-08 15:26:55,005 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot f3a96c530f6ea47a289c7320ec40b2f8.
2025-10-08 15:26:55,005 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot f3a96c530f6ea47a289c7320ec40b2f8.
2025-10-08 15:26:55,005 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#48 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_48) switched from CREATED to DEPLOYING.
2025-10-08 15:26:55,006 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#48 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_48) [DEPLOYING].
2025-10-08 15:26:55,006 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#48 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_48), deploy into slot with allocation id f3a96c530f6ea47a289c7320ec40b2f8.
2025-10-08 15:26:55,006 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#48 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_48) switched from CREATED to DEPLOYING.
2025-10-08 15:26:55,006 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#48 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_48) [DEPLOYING].
2025-10-08 15:26:55,007 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:26:55,007 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:26:55,009 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:26:55,009 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:26:55,009 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#48 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_48) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:26:55,015 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:26:55,015 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:26:55,016 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:26:55,016 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:26:55,016 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#48 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_48) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:26:55,026 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:26:55,026 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:26:55,027 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:26:55,027 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:26:55,028 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:26:55,028 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:26:55,029 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:26:55,029 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:26:55,029 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:26:55,030 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:26:55,033 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:26:55,033 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6a2479c8-0f0d-4bf7-bfcf-9f6bf40d525e/78678524-a936-459b-88b2-b5b24bae5218', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=e0ec03f5-670a-49e8-b9bb-da3ae3278039}.
2025-10-08 15:26:55,038 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:26:55,038 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:26:55,048 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6a2479c8-0f0d-4bf7-bfcf-9f6bf40d525e/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6a2479c8-0f0d-4bf7-bfcf-9f6bf40d525e/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:26:55,049 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:26:55,050 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6a2479c8-0f0d-4bf7-bfcf-9f6bf40d525e/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6a2479c8-0f0d-4bf7-bfcf-9f6bf40d525e/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:26:55,050 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6a2479c8-0f0d-4bf7-bfcf-9f6bf40d525e/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6a2479c8-0f0d-4bf7-bfcf-9f6bf40d525e/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:26:55,166 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#48 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_48) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6a2479c8-0f0d-4bf7-bfcf-9f6bf40d525e/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6a2479c8-0f0d-4bf7-bfcf-9f6bf40d525e/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:26:55,166 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#48 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_48).
2025-10-08 15:26:55,167 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#48 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_48.
2025-10-08 15:26:55,185 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#48 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_48).
2025-10-08 15:26:55,185 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#48 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_48) switched from INITIALIZING to CANCELING.
2025-10-08 15:26:55,185 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#48 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_48).
2025-10-08 15:26:55,200 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Using standard YAML parser to load flink configuration file from /opt/flink/conf/config.yaml.
2025-10-08 15:26:55,201 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: blob.server.port, 6124
2025-10-08 15:26:55,201 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.memory.process.size, 1728m
2025-10-08 15:26:55,201 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.bind-host, 0.0.0.0
2025-10-08 15:26:55,201 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.execution.failover-strategy, region
2025-10-08 15:26:55,201 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.address, 30a48f53a5ec
2025-10-08 15:26:55,201 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.incremental, false
2025-10-08 15:26:55,201 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.rocksdb.localdir, /tmp/rocksdb
2025-10-08 15:26:55,201 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.target, remote
2025-10-08 15:26:55,201 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.memory.process.size, 1600m
2025-10-08 15:26:55,201 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.port, 6123
2025-10-08 15:26:55,201 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: query.server.port, 6125
2025-10-08 15:26:55,201 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.bind-address, 0.0.0.0
2025-10-08 15:26:55,201 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.bind-host, 0.0.0.0
2025-10-08 15:26:55,201 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.savepoint-dir, file:///tmp/flink-checkpoints
2025-10-08 15:26:55,201 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.host, 127.0.0.1
2025-10-08 15:26:55,201 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.externalized-checkpoint-retention, RETAIN_ON_CANCELLATION
2025-10-08 15:26:55,201 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: parallelism.default, 1
2025-10-08 15:26:55,201 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.numberOfTaskSlots, 1
2025-10-08 15:26:55,201 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.local-backup.enabled, true
2025-10-08 15:26:55,201 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.address, 127.0.0.1
2025-10-08 15:26:55,201 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.dir, file:///tmp/flink-checkpoints
2025-10-08 15:26:55,201 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: env.java.opts.all, --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.text=ALL-UNNAMED --add-opens=java.base/java.time=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED
2025-10-08 15:26:55,201 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.type, rocksdb
2025-10-08 15:26:55,207 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:26:55,207 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:26:55,243 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#48 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_48) switched from CANCELING to CANCELED.
2025-10-08 15:26:55,243 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#48 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_48).
2025-10-08 15:26:55,244 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#48 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_48.
2025-10-08 15:27:55,191 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot f3a96c530f6ea47a289c7320ec40b2f8.
2025-10-08 15:27:55,192 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#49 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_49), deploy into slot with allocation id f3a96c530f6ea47a289c7320ec40b2f8.
2025-10-08 15:27:55,193 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot f3a96c530f6ea47a289c7320ec40b2f8.
2025-10-08 15:27:55,193 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#49 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_49) switched from CREATED to DEPLOYING.
2025-10-08 15:27:55,194 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#49 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_49) [DEPLOYING].
2025-10-08 15:27:55,194 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#49 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_49), deploy into slot with allocation id f3a96c530f6ea47a289c7320ec40b2f8.
2025-10-08 15:27:55,196 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:27:55,196 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:27:55,196 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:27:55,197 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:27:55,196 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#49 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_49) switched from CREATED to DEPLOYING.
2025-10-08 15:27:55,197 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#49 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_49) [DEPLOYING].
2025-10-08 15:27:55,197 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#49 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_49) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:27:55,198 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:27:55,198 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:27:55,199 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:27:55,199 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:27:55,199 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#49 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_49) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:27:55,200 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:27:55,201 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:27:55,201 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:27:55,201 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:27:55,202 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:27:55,202 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:27:55,203 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:27:55,203 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:27:55,207 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:27:55,208 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:27:55,208 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:27:55,208 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:27:55,209 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:27:55,209 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:27:55,210 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:27:55,211 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:27:55,216 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:27:55,217 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_8b085aa5-6f24-4cfb-b03f-b6cfdde11d91/0a518c9c-4a0f-4cb6-b0be-b899319e2cfc', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=83f9df4a-1ead-43d7-a827-be37cba12b18}.
2025-10-08 15:27:55,229 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_8b085aa5-6f24-4cfb-b03f-b6cfdde11d91/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_8b085aa5-6f24-4cfb-b03f-b6cfdde11d91/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:27:55,230 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:27:55,230 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_8b085aa5-6f24-4cfb-b03f-b6cfdde11d91/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_8b085aa5-6f24-4cfb-b03f-b6cfdde11d91/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:27:55,231 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_8b085aa5-6f24-4cfb-b03f-b6cfdde11d91/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_8b085aa5-6f24-4cfb-b03f-b6cfdde11d91/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:27:55,231 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#49 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_49) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_8b085aa5-6f24-4cfb-b03f-b6cfdde11d91/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_8b085aa5-6f24-4cfb-b03f-b6cfdde11d91/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:27:55,231 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#49 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_49).
2025-10-08 15:27:55,233 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#49 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_49.
2025-10-08 15:27:55,244 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#49 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_49).
2025-10-08 15:27:55,244 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#49 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_49) switched from INITIALIZING to CANCELING.
2025-10-08 15:27:55,244 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#49 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_49).
2025-10-08 15:27:55,716 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#49 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_49) switched from CANCELING to CANCELED.
2025-10-08 15:27:55,716 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#49 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_49).
2025-10-08 15:27:55,717 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#49 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_49.
2025-10-08 15:28:55,252 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot f3a96c530f6ea47a289c7320ec40b2f8.
2025-10-08 15:28:55,253 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#50 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_50), deploy into slot with allocation id f3a96c530f6ea47a289c7320ec40b2f8.
2025-10-08 15:28:55,255 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#50 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_50) switched from CREATED to DEPLOYING.
2025-10-08 15:28:55,255 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#50 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_50) [DEPLOYING].
2025-10-08 15:28:55,256 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot f3a96c530f6ea47a289c7320ec40b2f8.
2025-10-08 15:28:55,257 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#50 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_50), deploy into slot with allocation id f3a96c530f6ea47a289c7320ec40b2f8.
2025-10-08 15:28:55,257 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:28:55,257 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:28:55,258 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:28:55,258 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:28:55,258 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#50 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_50) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:28:55,257 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#50 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_50) switched from CREATED to DEPLOYING.
2025-10-08 15:28:55,259 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#50 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_50) [DEPLOYING].
2025-10-08 15:28:55,260 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:28:55,260 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:28:55,260 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:28:55,260 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:28:55,260 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#50 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_50) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:28:55,263 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:28:55,263 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:28:55,264 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:28:55,264 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:28:55,264 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:28:55,264 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:28:55,264 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:28:55,264 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:28:55,265 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:28:55,265 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:28:55,265 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:28:55,265 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:28:55,265 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:28:55,265 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:28:55,266 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:28:55,266 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:28:55,269 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:28:55,269 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_94193ca4-6fee-43da-a150-eed8a977e2bf/49af6025-5714-4aec-95e9-6530c255183d', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=c84475b6-d7e6-42fc-a3e6-2a576bef4a11}.
2025-10-08 15:28:55,278 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_94193ca4-6fee-43da-a150-eed8a977e2bf/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_94193ca4-6fee-43da-a150-eed8a977e2bf/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:28:55,488 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:28:55,489 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:28:55,490 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_94193ca4-6fee-43da-a150-eed8a977e2bf/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_94193ca4-6fee-43da-a150-eed8a977e2bf/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:28:55,491 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_94193ca4-6fee-43da-a150-eed8a977e2bf/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_94193ca4-6fee-43da-a150-eed8a977e2bf/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:28:55,493 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#50 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_50) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_94193ca4-6fee-43da-a150-eed8a977e2bf/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_94193ca4-6fee-43da-a150-eed8a977e2bf/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:28:55,493 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#50 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_50).
2025-10-08 15:28:55,499 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#50 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_50.
2025-10-08 15:28:55,514 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#50 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_50).
2025-10-08 15:28:55,514 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#50 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_50) switched from INITIALIZING to CANCELING.
2025-10-08 15:28:55,514 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#50 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_50).
2025-10-08 15:28:55,697 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 1-1 still running. Killing.
2025-10-08 15:28:55,701 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@6d3e7422, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@6dfaf4b0, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@44fe9925, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@2f39a7b, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@1cf27163, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@26175939}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:28:55,705 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#50 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_50) switched from CANCELING to CANCELED.
2025-10-08 15:28:55,706 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#50 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_50).
2025-10-08 15:28:55,706 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#50 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_50.
2025-10-08 15:29:55,521 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot f3a96c530f6ea47a289c7320ec40b2f8.
2025-10-08 15:29:55,523 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#51 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_51), deploy into slot with allocation id f3a96c530f6ea47a289c7320ec40b2f8.
2025-10-08 15:29:55,523 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#51 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_51) switched from CREATED to DEPLOYING.
2025-10-08 15:29:55,524 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot f3a96c530f6ea47a289c7320ec40b2f8.
2025-10-08 15:29:55,525 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#51 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_51) [DEPLOYING].
2025-10-08 15:29:55,528 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#51 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_51), deploy into slot with allocation id f3a96c530f6ea47a289c7320ec40b2f8.
2025-10-08 15:29:55,529 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#51 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_51) switched from CREATED to DEPLOYING.
2025-10-08 15:29:55,530 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#51 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_51) [DEPLOYING].
2025-10-08 15:29:55,530 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:29:55,530 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:29:55,532 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:29:55,532 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:29:55,532 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#51 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_51) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:29:55,533 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:29:55,533 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:29:55,533 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:29:55,533 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:29:55,533 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#51 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_51) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:29:55,542 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:29:55,542 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:29:55,544 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:29:55,545 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:29:55,546 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:29:55,546 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:29:55,547 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:29:55,547 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:29:55,549 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:29:55,549 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:29:55,549 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:29:55,549 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:29:55,551 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:29:55,552 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:29:55,553 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:29:55,553 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:29:55,558 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:29:55,558 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_95035847-d4bc-4aa3-92be-406f7bb8e1f4/1ecbe85c-865a-4573-9b6e-c31fadc00371', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=c96210f2-91ae-4f3f-ae95-6b04711873d8}.
2025-10-08 15:29:55,586 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_95035847-d4bc-4aa3-92be-406f7bb8e1f4/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_95035847-d4bc-4aa3-92be-406f7bb8e1f4/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:29:55,761 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:29:55,761 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:29:55,762 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_95035847-d4bc-4aa3-92be-406f7bb8e1f4/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_95035847-d4bc-4aa3-92be-406f7bb8e1f4/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:29:55,762 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_95035847-d4bc-4aa3-92be-406f7bb8e1f4/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_95035847-d4bc-4aa3-92be-406f7bb8e1f4/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:29:55,763 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#51 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_51) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_95035847-d4bc-4aa3-92be-406f7bb8e1f4/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_95035847-d4bc-4aa3-92be-406f7bb8e1f4/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:29:55,764 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#51 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_51).
2025-10-08 15:29:55,764 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#51 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_51.
2025-10-08 15:29:55,783 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#51 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_51).
2025-10-08 15:29:55,783 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#51 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_51) switched from INITIALIZING to CANCELING.
2025-10-08 15:29:55,783 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#51 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_51).
2025-10-08 15:29:55,793 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 2-1 still running. Killing.
2025-10-08 15:29:55,794 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@706e0771, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@28d87a6c, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@1e00d47b, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@2cd9fe61, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@2c8c2104, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@47ec35e3}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:29:55,797 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#51 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_51) switched from CANCELING to CANCELED.
2025-10-08 15:29:55,797 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#51 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_51).
2025-10-08 15:29:55,797 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#51 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_51.
2025-10-08 15:30:55,786 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot f3a96c530f6ea47a289c7320ec40b2f8.
2025-10-08 15:30:55,787 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#52 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_52), deploy into slot with allocation id f3a96c530f6ea47a289c7320ec40b2f8.
2025-10-08 15:30:55,788 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot f3a96c530f6ea47a289c7320ec40b2f8.
2025-10-08 15:30:55,788 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#52 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_52) switched from CREATED to DEPLOYING.
2025-10-08 15:30:55,789 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#52 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_52), deploy into slot with allocation id f3a96c530f6ea47a289c7320ec40b2f8.
2025-10-08 15:30:55,789 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#52 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_52) [DEPLOYING].
2025-10-08 15:30:55,790 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#52 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_52) switched from CREATED to DEPLOYING.
2025-10-08 15:30:55,790 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#52 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_52) [DEPLOYING].
2025-10-08 15:30:55,791 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:30:55,791 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:30:55,791 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:30:55,792 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:30:55,792 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:30:55,792 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#52 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_52) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:30:55,792 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:30:55,793 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:30:55,793 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:30:55,794 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#52 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_52) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:30:55,795 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:30:55,795 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:30:55,796 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:30:55,796 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:30:55,797 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:30:55,797 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:30:55,798 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:30:55,798 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:30:55,798 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:30:55,798 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:30:55,799 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:30:55,799 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:30:55,799 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:30:55,799 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:30:55,800 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:30:55,800 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:30:55,806 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:30:55,807 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e167fbb5-be82-461e-bf67-0a406166e1b8/9dae9810-2dec-4d39-a37a-c8d5fec27799', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=d2c9c3e8-71de-4b8a-8d34-b29b167514c3}.
2025-10-08 15:30:55,823 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e167fbb5-be82-461e-bf67-0a406166e1b8/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e167fbb5-be82-461e-bf67-0a406166e1b8/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:30:55,915 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:30:55,915 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:30:55,916 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e167fbb5-be82-461e-bf67-0a406166e1b8/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e167fbb5-be82-461e-bf67-0a406166e1b8/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:30:55,918 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e167fbb5-be82-461e-bf67-0a406166e1b8/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e167fbb5-be82-461e-bf67-0a406166e1b8/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:30:55,919 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#52 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_52) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e167fbb5-be82-461e-bf67-0a406166e1b8/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e167fbb5-be82-461e-bf67-0a406166e1b8/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:30:55,920 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#52 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_52).
2025-10-08 15:30:55,922 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#52 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_52.
2025-10-08 15:30:55,933 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#52 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_52).
2025-10-08 15:30:55,933 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#52 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_52) switched from INITIALIZING to CANCELING.
2025-10-08 15:30:55,933 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#52 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_52).
2025-10-08 15:30:55,944 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 3-1 still running. Killing.
2025-10-08 15:30:55,946 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@3a2b7d67, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@5e7f9f95, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@6169b4f5, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@649a84f3, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@5bb0d42, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@271aa957}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:30:55,951 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#52 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_52) switched from CANCELING to CANCELED.
2025-10-08 15:30:55,951 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#52 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_52).
2025-10-08 15:30:55,952 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#52 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_52.
2025-10-08 15:31:48,636 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Free slot TaskSlot(index:9, state:ACTIVE, resource profile: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}, allocationId: f3a96c530f6ea47a289c7320ec40b2f8, jobId: d1f164921ad7c2fe36d4e92a16bdba98).
2025-10-08 15:31:48,636 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Remove job d1f164921ad7c2fe36d4e92a16bdba98 from job leader monitoring.
2025-10-08 15:31:48,636 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Close JobManager connection for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:31:56,029 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Receive slot request 7c1ad1c9b5882922485caf7750915095 for job d1f164921ad7c2fe36d4e92a16bdba98 from resource manager with leader id 00000000000000000000000000000000.
2025-10-08 15:31:56,030 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Allocated slot for 7c1ad1c9b5882922485caf7750915095 with resources ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 15:31:56,030 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Add job d1f164921ad7c2fe36d4e92a16bdba98 for job leader monitoring.
2025-10-08 15:31:56,030 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Try to register at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 with leader id 00000000-0000-0000-0000-000000000000.
2025-10-08 15:31:56,034 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Resolved JobManager address, beginning registration
2025-10-08 15:31:56,037 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Successful registration at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:31:56,037 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Establish JobManager connection for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:31:56,037 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Offer reserved slots to the leader of job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:31:56,042 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 7c1ad1c9b5882922485caf7750915095.
2025-10-08 15:31:56,043 INFO  org.apache.flink.runtime.state.changelog.StateChangelogStorageLoader [] - Creating a changelog storage with name 'memory'.
2025-10-08 15:31:56,043 INFO  org.apache.flink.runtime.state.TaskExecutorChannelStateExecutorFactoryManager [] - Creating the channel state executor factory for job id d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:31:56,044 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#53 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_53), deploy into slot with allocation id 7c1ad1c9b5882922485caf7750915095.
2025-10-08 15:31:56,044 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 7c1ad1c9b5882922485caf7750915095.
2025-10-08 15:31:56,044 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 7c1ad1c9b5882922485caf7750915095.
2025-10-08 15:31:56,044 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#53 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_53) switched from CREATED to DEPLOYING.
2025-10-08 15:31:56,046 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#53 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_53) [DEPLOYING].
2025-10-08 15:31:56,048 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#53 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_53), deploy into slot with allocation id 7c1ad1c9b5882922485caf7750915095.
2025-10-08 15:31:56,049 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#53 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_53) switched from CREATED to DEPLOYING.
2025-10-08 15:31:56,050 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#53 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_53) [DEPLOYING].
2025-10-08 15:31:56,050 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:31:56,050 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:31:56,051 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:31:56,051 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:31:56,053 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#53 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_53) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:31:56,053 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:31:56,054 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:31:56,054 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:31:56,054 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:31:56,054 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#53 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_53) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:31:56,072 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:31:56,072 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:31:56,075 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:31:56,075 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:31:56,077 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:31:56,078 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:31:56,078 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:31:56,078 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:31:56,079 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:31:56,081 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:31:56,082 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:31:56,082 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:31:56,085 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:31:56,085 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c6a6d7b2-5b73-40eb-9397-527f87d7e83b/182f4bf8-1e46-4b81-8eba-5ccb95204738', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=bd263aa2-7685-4937-af44-5e0b2a2796e5}.
2025-10-08 15:31:56,099 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c6a6d7b2-5b73-40eb-9397-527f87d7e83b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c6a6d7b2-5b73-40eb-9397-527f87d7e83b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:31:56,100 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:31:56,100 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c6a6d7b2-5b73-40eb-9397-527f87d7e83b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c6a6d7b2-5b73-40eb-9397-527f87d7e83b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:31:56,101 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c6a6d7b2-5b73-40eb-9397-527f87d7e83b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c6a6d7b2-5b73-40eb-9397-527f87d7e83b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:31:56,199 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#53 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_53) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c6a6d7b2-5b73-40eb-9397-527f87d7e83b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c6a6d7b2-5b73-40eb-9397-527f87d7e83b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:31:56,199 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#53 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_53).
2025-10-08 15:31:56,200 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#53 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_53.
2025-10-08 15:31:56,211 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#53 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_53).
2025-10-08 15:31:56,213 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#53 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_53) switched from INITIALIZING to CANCELING.
2025-10-08 15:31:56,213 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#53 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_53).
2025-10-08 15:31:56,225 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Using standard YAML parser to load flink configuration file from /opt/flink/conf/config.yaml.
2025-10-08 15:31:56,226 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: blob.server.port, 6124
2025-10-08 15:31:56,226 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.memory.process.size, 1728m
2025-10-08 15:31:56,226 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.bind-host, 0.0.0.0
2025-10-08 15:31:56,226 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.execution.failover-strategy, region
2025-10-08 15:31:56,226 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.address, 30a48f53a5ec
2025-10-08 15:31:56,226 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.incremental, false
2025-10-08 15:31:56,226 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.rocksdb.localdir, /tmp/rocksdb
2025-10-08 15:31:56,226 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.target, remote
2025-10-08 15:31:56,226 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.memory.process.size, 1600m
2025-10-08 15:31:56,226 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.port, 6123
2025-10-08 15:31:56,226 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: query.server.port, 6125
2025-10-08 15:31:56,226 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.bind-address, 0.0.0.0
2025-10-08 15:31:56,226 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.bind-host, 0.0.0.0
2025-10-08 15:31:56,226 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.savepoint-dir, file:///tmp/flink-checkpoints
2025-10-08 15:31:56,226 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.host, 127.0.0.1
2025-10-08 15:31:56,226 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.externalized-checkpoint-retention, RETAIN_ON_CANCELLATION
2025-10-08 15:31:56,226 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: parallelism.default, 1
2025-10-08 15:31:56,226 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.numberOfTaskSlots, 1
2025-10-08 15:31:56,226 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.local-backup.enabled, true
2025-10-08 15:31:56,226 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.address, 127.0.0.1
2025-10-08 15:31:56,226 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.dir, file:///tmp/flink-checkpoints
2025-10-08 15:31:56,226 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: env.java.opts.all, --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.text=ALL-UNNAMED --add-opens=java.base/java.time=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED
2025-10-08 15:31:56,226 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.type, rocksdb
2025-10-08 15:31:56,231 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:31:56,231 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:31:56,255 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#53 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_53) switched from CANCELING to CANCELED.
2025-10-08 15:31:56,255 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#53 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_53).
2025-10-08 15:31:56,256 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#53 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_53.
2025-10-08 15:32:56,214 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 7c1ad1c9b5882922485caf7750915095.
2025-10-08 15:32:56,216 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#54 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_54), deploy into slot with allocation id 7c1ad1c9b5882922485caf7750915095.
2025-10-08 15:32:56,216 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 7c1ad1c9b5882922485caf7750915095.
2025-10-08 15:32:56,216 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#54 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_54) switched from CREATED to DEPLOYING.
2025-10-08 15:32:56,217 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#54 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_54) [DEPLOYING].
2025-10-08 15:32:56,217 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#54 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_54), deploy into slot with allocation id 7c1ad1c9b5882922485caf7750915095.
2025-10-08 15:32:56,218 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#54 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_54) switched from CREATED to DEPLOYING.
2025-10-08 15:32:56,218 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#54 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_54) [DEPLOYING].
2025-10-08 15:32:56,219 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:32:56,219 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:32:56,219 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:32:56,219 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:32:56,219 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:32:56,219 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:32:56,219 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:32:56,219 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:32:56,219 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#54 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_54) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:32:56,219 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#54 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_54) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:32:56,222 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:32:56,222 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:32:56,222 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:32:56,223 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:32:56,223 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:32:56,223 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:32:56,224 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:32:56,224 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:32:56,227 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:32:56,227 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_80a572db-2053-4378-bfef-7f7e7adda0ab/f53a3020-0ae9-422d-bd22-74cccc1cd2e6', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=72cd0663-0823-4141-9863-7aa5fcdfe650}.
2025-10-08 15:32:56,227 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:32:56,227 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:32:56,228 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:32:56,228 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:32:56,229 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:32:56,230 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:32:56,235 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:32:56,235 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:32:56,240 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_80a572db-2053-4378-bfef-7f7e7adda0ab/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_80a572db-2053-4378-bfef-7f7e7adda0ab/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:32:56,241 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:32:56,242 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_80a572db-2053-4378-bfef-7f7e7adda0ab/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_80a572db-2053-4378-bfef-7f7e7adda0ab/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:32:56,242 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_80a572db-2053-4378-bfef-7f7e7adda0ab/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_80a572db-2053-4378-bfef-7f7e7adda0ab/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:32:56,242 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#54 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_54) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_80a572db-2053-4378-bfef-7f7e7adda0ab/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_80a572db-2053-4378-bfef-7f7e7adda0ab/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:32:56,243 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#54 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_54).
2025-10-08 15:32:56,244 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#54 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_54.
2025-10-08 15:32:56,260 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#54 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_54).
2025-10-08 15:32:56,260 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#54 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_54) switched from INITIALIZING to CANCELING.
2025-10-08 15:32:56,260 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#54 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_54).
2025-10-08 15:32:56,827 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#54 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_54) switched from CANCELING to CANCELED.
2025-10-08 15:32:56,827 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#54 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_54).
2025-10-08 15:32:56,827 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#54 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_54.
2025-10-08 15:33:56,264 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 7c1ad1c9b5882922485caf7750915095.
2025-10-08 15:33:56,265 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#55 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_55), deploy into slot with allocation id 7c1ad1c9b5882922485caf7750915095.
2025-10-08 15:33:56,265 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 7c1ad1c9b5882922485caf7750915095.
2025-10-08 15:33:56,265 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#55 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_55) switched from CREATED to DEPLOYING.
2025-10-08 15:33:56,266 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#55 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_55) [DEPLOYING].
2025-10-08 15:33:56,266 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#55 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_55), deploy into slot with allocation id 7c1ad1c9b5882922485caf7750915095.
2025-10-08 15:33:56,267 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#55 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_55) switched from CREATED to DEPLOYING.
2025-10-08 15:33:56,267 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#55 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_55) [DEPLOYING].
2025-10-08 15:33:56,268 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:33:56,268 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:33:56,268 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:33:56,269 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:33:56,270 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:33:56,270 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:33:56,270 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:33:56,270 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#55 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_55) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:33:56,270 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:33:56,270 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#55 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_55) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:33:56,274 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:33:56,276 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:33:56,276 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:33:56,276 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:33:56,274 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:33:56,277 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:33:56,277 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:33:56,277 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:33:56,278 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:33:56,278 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:33:56,278 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:33:56,279 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:33:56,279 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:33:56,279 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:33:56,279 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:33:56,280 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:33:56,284 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:33:56,284 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6afb77d7-7c5c-4b9c-98ae-532c0e0412e5/6563c969-979a-426d-9235-66ed10aa2e76', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=2bf2e018-e760-4f80-9c29-75ab4d0d8f58}.
2025-10-08 15:33:56,306 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6afb77d7-7c5c-4b9c-98ae-532c0e0412e5/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6afb77d7-7c5c-4b9c-98ae-532c0e0412e5/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:33:56,507 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:33:56,509 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:33:56,510 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6afb77d7-7c5c-4b9c-98ae-532c0e0412e5/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6afb77d7-7c5c-4b9c-98ae-532c0e0412e5/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:33:56,510 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6afb77d7-7c5c-4b9c-98ae-532c0e0412e5/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6afb77d7-7c5c-4b9c-98ae-532c0e0412e5/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:33:56,512 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#55 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_55) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6afb77d7-7c5c-4b9c-98ae-532c0e0412e5/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6afb77d7-7c5c-4b9c-98ae-532c0e0412e5/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:33:56,513 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#55 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_55).
2025-10-08 15:33:56,514 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#55 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_55.
2025-10-08 15:33:56,523 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#55 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_55).
2025-10-08 15:33:56,523 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#55 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_55) switched from INITIALIZING to CANCELING.
2025-10-08 15:33:56,523 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#55 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_55).
2025-10-08 15:33:56,690 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 1-1 still running. Killing.
2025-10-08 15:33:56,696 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@37cb0eb7, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@4addf11b, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@15c8faf3, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@43b9e03a, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@2ce8e04c, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@99889e3}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:33:56,700 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#55 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_55) switched from CANCELING to CANCELED.
2025-10-08 15:33:56,700 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#55 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_55).
2025-10-08 15:33:56,700 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#55 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_55.
2025-10-08 15:34:56,527 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 7c1ad1c9b5882922485caf7750915095.
2025-10-08 15:34:56,528 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#56 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_56), deploy into slot with allocation id 7c1ad1c9b5882922485caf7750915095.
2025-10-08 15:34:56,528 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 7c1ad1c9b5882922485caf7750915095.
2025-10-08 15:34:56,528 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#56 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_56) switched from CREATED to DEPLOYING.
2025-10-08 15:34:56,529 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#56 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_56) [DEPLOYING].
2025-10-08 15:34:56,529 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#56 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_56), deploy into slot with allocation id 7c1ad1c9b5882922485caf7750915095.
2025-10-08 15:34:56,530 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#56 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_56) switched from CREATED to DEPLOYING.
2025-10-08 15:34:56,530 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:34:56,530 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:34:56,530 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#56 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_56) [DEPLOYING].
2025-10-08 15:34:56,531 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:34:56,531 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:34:56,531 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:34:56,531 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:34:56,531 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#56 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_56) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:34:56,532 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:34:56,532 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:34:56,532 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#56 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_56) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:34:56,537 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:34:56,537 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:34:56,538 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:34:56,538 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:34:56,538 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:34:56,538 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:34:56,539 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:34:56,539 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:34:56,540 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:34:56,540 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:34:56,540 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:34:56,541 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:34:56,542 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:34:56,543 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:34:56,544 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:34:56,544 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:34:56,549 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:34:56,549 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_05ede0bb-8088-42c0-ac6f-534f9381f3e4/22ca0b2e-24ae-4719-99f5-891d56aff53a', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=c2b08a65-6767-4355-929d-5f921c82ac30}.
2025-10-08 15:34:56,569 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_05ede0bb-8088-42c0-ac6f-534f9381f3e4/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_05ede0bb-8088-42c0-ac6f-534f9381f3e4/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:34:56,675 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:34:56,675 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:34:56,676 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_05ede0bb-8088-42c0-ac6f-534f9381f3e4/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_05ede0bb-8088-42c0-ac6f-534f9381f3e4/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:34:56,678 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_05ede0bb-8088-42c0-ac6f-534f9381f3e4/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_05ede0bb-8088-42c0-ac6f-534f9381f3e4/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:34:56,678 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#56 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_56) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_05ede0bb-8088-42c0-ac6f-534f9381f3e4/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_05ede0bb-8088-42c0-ac6f-534f9381f3e4/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:34:56,680 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#56 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_56).
2025-10-08 15:34:56,680 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#56 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_56.
2025-10-08 15:34:56,688 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#56 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_56).
2025-10-08 15:34:56,688 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#56 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_56) switched from INITIALIZING to CANCELING.
2025-10-08 15:34:56,688 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#56 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_56).
2025-10-08 15:34:56,693 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 2-1 still running. Killing.
2025-10-08 15:34:56,695 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@694f909b, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@4b1f58ad, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@2dd5a415, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@32d8b9ae, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@27063c26, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@166dd25b}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:34:56,697 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#56 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_56) switched from CANCELING to CANCELED.
2025-10-08 15:34:56,698 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#56 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_56).
2025-10-08 15:34:56,698 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#56 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_56.
2025-10-08 15:35:56,692 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 7c1ad1c9b5882922485caf7750915095.
2025-10-08 15:35:56,693 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#57 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_57), deploy into slot with allocation id 7c1ad1c9b5882922485caf7750915095.
2025-10-08 15:35:56,693 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 7c1ad1c9b5882922485caf7750915095.
2025-10-08 15:35:56,693 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#57 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_57) switched from CREATED to DEPLOYING.
2025-10-08 15:35:56,694 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#57 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_57) [DEPLOYING].
2025-10-08 15:35:56,694 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#57 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_57), deploy into slot with allocation id 7c1ad1c9b5882922485caf7750915095.
2025-10-08 15:35:56,695 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#57 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_57) switched from CREATED to DEPLOYING.
2025-10-08 15:35:56,695 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#57 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_57) [DEPLOYING].
2025-10-08 15:35:56,696 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:35:56,696 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:35:56,696 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:35:56,696 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:35:56,696 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:35:56,697 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:35:56,697 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:35:56,697 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:35:56,697 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#57 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_57) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:35:56,697 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#57 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_57) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:35:56,702 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:35:56,702 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:35:56,703 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:35:56,703 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:35:56,703 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:35:56,703 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:35:56,703 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:35:56,703 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:35:56,703 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:35:56,704 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:35:56,704 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:35:56,704 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:35:56,704 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:35:56,705 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:35:56,705 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:35:56,705 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:35:56,707 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:35:56,707 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5f6cc2e7-7435-4131-8744-9a2394864c4a/8d94017b-6bf6-4315-9129-43c87b277582', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=f1173a17-6b2b-49e4-82e3-88baa63918bc}.
2025-10-08 15:35:56,716 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5f6cc2e7-7435-4131-8744-9a2394864c4a/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5f6cc2e7-7435-4131-8744-9a2394864c4a/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:35:56,816 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:35:56,816 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:35:56,817 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5f6cc2e7-7435-4131-8744-9a2394864c4a/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5f6cc2e7-7435-4131-8744-9a2394864c4a/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:35:56,818 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5f6cc2e7-7435-4131-8744-9a2394864c4a/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5f6cc2e7-7435-4131-8744-9a2394864c4a/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:35:56,818 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#57 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_57) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5f6cc2e7-7435-4131-8744-9a2394864c4a/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5f6cc2e7-7435-4131-8744-9a2394864c4a/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:35:56,819 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#57 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_57).
2025-10-08 15:35:56,820 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#57 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_57.
2025-10-08 15:35:56,832 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#57 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_57).
2025-10-08 15:35:56,832 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#57 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_57) switched from INITIALIZING to CANCELING.
2025-10-08 15:35:56,832 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#57 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_57).
2025-10-08 15:35:56,834 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 3-1 still running. Killing.
2025-10-08 15:35:56,835 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@7bed0041, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@30e6a1b0, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@67c2cbe, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@5f5d5936, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@4ca1b594, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@49cf7691}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:35:56,838 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#57 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_57) switched from CANCELING to CANCELED.
2025-10-08 15:35:56,838 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#57 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_57).
2025-10-08 15:35:56,839 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#57 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_57.
2025-10-08 15:36:48,639 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Free slot TaskSlot(index:10, state:ACTIVE, resource profile: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}, allocationId: 7c1ad1c9b5882922485caf7750915095, jobId: d1f164921ad7c2fe36d4e92a16bdba98).
2025-10-08 15:36:48,639 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Remove job d1f164921ad7c2fe36d4e92a16bdba98 from job leader monitoring.
2025-10-08 15:36:48,639 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Close JobManager connection for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:36:56,919 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Receive slot request f25ae18569e6e6be2f8b279066bb4778 for job d1f164921ad7c2fe36d4e92a16bdba98 from resource manager with leader id 00000000000000000000000000000000.
2025-10-08 15:36:56,920 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Allocated slot for f25ae18569e6e6be2f8b279066bb4778 with resources ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 15:36:56,920 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Add job d1f164921ad7c2fe36d4e92a16bdba98 for job leader monitoring.
2025-10-08 15:36:56,920 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Try to register at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 with leader id 00000000-0000-0000-0000-000000000000.
2025-10-08 15:36:56,924 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Resolved JobManager address, beginning registration
2025-10-08 15:36:56,927 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Successful registration at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:36:56,927 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Establish JobManager connection for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:36:56,927 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Offer reserved slots to the leader of job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:36:56,932 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot f25ae18569e6e6be2f8b279066bb4778.
2025-10-08 15:36:56,933 INFO  org.apache.flink.runtime.state.changelog.StateChangelogStorageLoader [] - Creating a changelog storage with name 'memory'.
2025-10-08 15:36:56,933 INFO  org.apache.flink.runtime.state.TaskExecutorChannelStateExecutorFactoryManager [] - Creating the channel state executor factory for job id d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:36:56,933 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#58 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_58), deploy into slot with allocation id f25ae18569e6e6be2f8b279066bb4778.
2025-10-08 15:36:56,934 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot f25ae18569e6e6be2f8b279066bb4778.
2025-10-08 15:36:56,934 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#58 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_58) switched from CREATED to DEPLOYING.
2025-10-08 15:36:56,934 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot f25ae18569e6e6be2f8b279066bb4778.
2025-10-08 15:36:56,935 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#58 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_58) [DEPLOYING].
2025-10-08 15:36:56,936 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#58 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_58), deploy into slot with allocation id f25ae18569e6e6be2f8b279066bb4778.
2025-10-08 15:36:56,942 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#58 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_58) switched from CREATED to DEPLOYING.
2025-10-08 15:36:56,942 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#58 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_58) [DEPLOYING].
2025-10-08 15:36:56,943 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:36:56,943 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:36:56,943 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:36:56,943 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:36:56,944 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:36:56,944 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:36:56,944 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#58 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_58) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:36:56,944 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:36:56,949 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:36:56,949 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#58 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_58) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:36:56,975 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:36:56,976 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:36:56,976 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:36:56,977 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:36:56,978 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:36:56,978 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:36:56,979 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:36:56,979 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:36:56,980 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:36:56,980 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:36:56,982 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:36:56,982 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_1bab9df2-6395-4ec6-aaa1-03aa2d7b091c/25f59c20-40d5-460c-bfd2-d6384481200a', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=f23648cd-5292-4623-96e4-5345da109d16}.
2025-10-08 15:36:56,983 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:36:56,983 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:36:56,992 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_1bab9df2-6395-4ec6-aaa1-03aa2d7b091c/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_1bab9df2-6395-4ec6-aaa1-03aa2d7b091c/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:36:56,992 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:36:56,993 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_1bab9df2-6395-4ec6-aaa1-03aa2d7b091c/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_1bab9df2-6395-4ec6-aaa1-03aa2d7b091c/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:36:56,993 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_1bab9df2-6395-4ec6-aaa1-03aa2d7b091c/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_1bab9df2-6395-4ec6-aaa1-03aa2d7b091c/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:36:56,995 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#58 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_58) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_1bab9df2-6395-4ec6-aaa1-03aa2d7b091c/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_1bab9df2-6395-4ec6-aaa1-03aa2d7b091c/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:36:57,009 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#58 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_58).
2025-10-08 15:36:57,012 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#58 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_58.
2025-10-08 15:36:57,024 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#58 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_58).
2025-10-08 15:36:57,024 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#58 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_58) switched from INITIALIZING to CANCELING.
2025-10-08 15:36:57,024 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#58 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_58).
2025-10-08 15:36:57,037 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Using standard YAML parser to load flink configuration file from /opt/flink/conf/config.yaml.
2025-10-08 15:36:57,039 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: blob.server.port, 6124
2025-10-08 15:36:57,039 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.memory.process.size, 1728m
2025-10-08 15:36:57,039 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.bind-host, 0.0.0.0
2025-10-08 15:36:57,039 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.execution.failover-strategy, region
2025-10-08 15:36:57,039 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.address, 30a48f53a5ec
2025-10-08 15:36:57,039 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.incremental, false
2025-10-08 15:36:57,039 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.rocksdb.localdir, /tmp/rocksdb
2025-10-08 15:36:57,039 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.target, remote
2025-10-08 15:36:57,039 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.memory.process.size, 1600m
2025-10-08 15:36:57,039 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.port, 6123
2025-10-08 15:36:57,039 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: query.server.port, 6125
2025-10-08 15:36:57,039 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.bind-address, 0.0.0.0
2025-10-08 15:36:57,039 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.bind-host, 0.0.0.0
2025-10-08 15:36:57,039 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.savepoint-dir, file:///tmp/flink-checkpoints
2025-10-08 15:36:57,039 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.host, 127.0.0.1
2025-10-08 15:36:57,039 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.externalized-checkpoint-retention, RETAIN_ON_CANCELLATION
2025-10-08 15:36:57,039 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: parallelism.default, 1
2025-10-08 15:36:57,039 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.numberOfTaskSlots, 1
2025-10-08 15:36:57,039 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.local-backup.enabled, true
2025-10-08 15:36:57,039 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.address, 127.0.0.1
2025-10-08 15:36:57,039 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.dir, file:///tmp/flink-checkpoints
2025-10-08 15:36:57,039 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: env.java.opts.all, --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.text=ALL-UNNAMED --add-opens=java.base/java.time=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED
2025-10-08 15:36:57,039 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.type, rocksdb
2025-10-08 15:36:57,046 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:36:57,046 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:36:57,098 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#58 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_58) switched from CANCELING to CANCELED.
2025-10-08 15:36:57,099 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#58 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_58).
2025-10-08 15:36:57,099 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#58 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_58.
2025-10-08 15:37:57,035 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot f25ae18569e6e6be2f8b279066bb4778.
2025-10-08 15:37:57,037 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#59 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_59), deploy into slot with allocation id f25ae18569e6e6be2f8b279066bb4778.
2025-10-08 15:37:57,037 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot f25ae18569e6e6be2f8b279066bb4778.
2025-10-08 15:37:57,038 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#59 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_59), deploy into slot with allocation id f25ae18569e6e6be2f8b279066bb4778.
2025-10-08 15:37:57,039 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#59 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_59) switched from CREATED to DEPLOYING.
2025-10-08 15:37:57,041 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#59 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_59) switched from CREATED to DEPLOYING.
2025-10-08 15:37:57,042 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#59 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_59) [DEPLOYING].
2025-10-08 15:37:57,042 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#59 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_59) [DEPLOYING].
2025-10-08 15:37:57,042 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:37:57,042 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:37:57,043 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:37:57,043 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:37:57,043 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#59 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_59) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:37:57,045 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:37:57,045 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:37:57,046 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:37:57,046 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:37:57,047 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:37:57,047 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:37:57,047 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#59 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_59) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:37:57,047 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:37:57,047 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:37:57,048 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:37:57,048 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:37:57,049 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:37:57,049 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:37:57,053 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:37:57,053 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:37:57,053 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:37:57,053 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_61af7ffb-e04c-4b9a-aa20-60049d7cbd24/eceb5444-4677-49af-8bb6-9065bb4a7b25', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=4b9bd406-245d-41f8-bd91-82161d898bad}.
2025-10-08 15:37:57,053 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:37:57,053 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:37:57,056 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:37:57,057 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:37:57,058 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:37:57,058 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:37:57,068 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_61af7ffb-e04c-4b9a-aa20-60049d7cbd24/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_61af7ffb-e04c-4b9a-aa20-60049d7cbd24/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:37:57,069 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:37:57,070 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_61af7ffb-e04c-4b9a-aa20-60049d7cbd24/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_61af7ffb-e04c-4b9a-aa20-60049d7cbd24/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:37:57,070 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_61af7ffb-e04c-4b9a-aa20-60049d7cbd24/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_61af7ffb-e04c-4b9a-aa20-60049d7cbd24/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:37:57,073 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#59 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_59) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_61af7ffb-e04c-4b9a-aa20-60049d7cbd24/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_61af7ffb-e04c-4b9a-aa20-60049d7cbd24/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:37:57,073 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#59 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_59).
2025-10-08 15:37:57,074 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#59 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_59.
2025-10-08 15:37:57,085 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#59 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_59).
2025-10-08 15:37:57,085 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#59 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_59) switched from INITIALIZING to CANCELING.
2025-10-08 15:37:57,085 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#59 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_59).
2025-10-08 15:37:57,550 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#59 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_59) switched from CANCELING to CANCELED.
2025-10-08 15:37:57,550 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#59 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_59).
2025-10-08 15:37:57,550 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#59 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_59.
2025-10-08 15:38:57,089 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot f25ae18569e6e6be2f8b279066bb4778.
2025-10-08 15:38:57,091 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#60 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_60), deploy into slot with allocation id f25ae18569e6e6be2f8b279066bb4778.
2025-10-08 15:38:57,091 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot f25ae18569e6e6be2f8b279066bb4778.
2025-10-08 15:38:57,091 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#60 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_60) switched from CREATED to DEPLOYING.
2025-10-08 15:38:57,092 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#60 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_60) [DEPLOYING].
2025-10-08 15:38:57,092 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#60 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_60), deploy into slot with allocation id f25ae18569e6e6be2f8b279066bb4778.
2025-10-08 15:38:57,093 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:38:57,093 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:38:57,093 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:38:57,093 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:38:57,093 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#60 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_60) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:38:57,094 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#60 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_60) switched from CREATED to DEPLOYING.
2025-10-08 15:38:57,094 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#60 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_60) [DEPLOYING].
2025-10-08 15:38:57,094 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:38:57,094 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:38:57,095 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:38:57,095 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:38:57,095 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#60 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_60) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:38:57,097 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:38:57,097 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:38:57,098 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:38:57,098 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:38:57,098 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:38:57,099 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:38:57,099 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:38:57,099 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:38:57,099 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:38:57,099 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:38:57,099 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:38:57,099 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:38:57,100 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:38:57,100 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:38:57,102 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:38:57,103 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:38:57,106 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:38:57,107 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_2ead57e4-c422-4de8-9753-55d881c32301/b1c78fdf-4fd8-482c-88f5-6bf3874f240c', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=e3b8c13a-0f89-4b83-8475-3f3f749220c0}.
2025-10-08 15:38:57,123 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_2ead57e4-c422-4de8-9753-55d881c32301/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_2ead57e4-c422-4de8-9753-55d881c32301/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:38:57,339 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:38:57,339 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:38:57,340 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_2ead57e4-c422-4de8-9753-55d881c32301/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_2ead57e4-c422-4de8-9753-55d881c32301/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:38:57,340 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_2ead57e4-c422-4de8-9753-55d881c32301/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_2ead57e4-c422-4de8-9753-55d881c32301/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:38:57,341 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#60 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_60) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_2ead57e4-c422-4de8-9753-55d881c32301/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_2ead57e4-c422-4de8-9753-55d881c32301/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:38:57,341 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#60 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_60).
2025-10-08 15:38:57,342 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#60 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_60.
2025-10-08 15:38:57,351 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#60 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_60).
2025-10-08 15:38:57,351 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#60 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_60) switched from INITIALIZING to CANCELING.
2025-10-08 15:38:57,351 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#60 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_60).
2025-10-08 15:38:57,523 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 1-1 still running. Killing.
2025-10-08 15:38:57,526 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@30f93539, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@76897d83, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@735dc689, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@3cb72c51, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@459e8603, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@78468e56}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:38:57,532 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#60 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_60) switched from CANCELING to CANCELED.
2025-10-08 15:38:57,532 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#60 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_60).
2025-10-08 15:38:57,532 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#60 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_60.
2025-10-08 15:39:57,355 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot f25ae18569e6e6be2f8b279066bb4778.
2025-10-08 15:39:57,356 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#61 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_61), deploy into slot with allocation id f25ae18569e6e6be2f8b279066bb4778.
2025-10-08 15:39:57,357 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#61 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_61) switched from CREATED to DEPLOYING.
2025-10-08 15:39:57,357 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot f25ae18569e6e6be2f8b279066bb4778.
2025-10-08 15:39:57,357 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#61 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_61) [DEPLOYING].
2025-10-08 15:39:57,358 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#61 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_61), deploy into slot with allocation id f25ae18569e6e6be2f8b279066bb4778.
2025-10-08 15:39:57,358 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:39:57,358 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:39:57,359 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:39:57,359 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:39:57,359 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#61 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_61) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:39:57,359 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#61 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_61) switched from CREATED to DEPLOYING.
2025-10-08 15:39:57,359 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#61 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_61) [DEPLOYING].
2025-10-08 15:39:57,360 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:39:57,360 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:39:57,360 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:39:57,360 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:39:57,360 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#61 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_61) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:39:57,364 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:39:57,364 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:39:57,364 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:39:57,364 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:39:57,364 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:39:57,364 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:39:57,365 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:39:57,365 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:39:57,366 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:39:57,366 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:39:57,366 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:39:57,367 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:39:57,367 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:39:57,368 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:39:57,368 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:39:57,368 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:39:57,374 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:39:57,375 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_cb403174-0b29-47f9-b517-bea9d809fc6b/7a27beda-b46b-483f-b39a-5b10f48f1eb2', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=2b5d292a-6c2f-4f03-b74b-af9189d2f9f9}.
2025-10-08 15:39:57,386 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_cb403174-0b29-47f9-b517-bea9d809fc6b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_cb403174-0b29-47f9-b517-bea9d809fc6b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:39:57,472 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:39:57,473 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:39:57,475 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_cb403174-0b29-47f9-b517-bea9d809fc6b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_cb403174-0b29-47f9-b517-bea9d809fc6b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:39:57,476 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_cb403174-0b29-47f9-b517-bea9d809fc6b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_cb403174-0b29-47f9-b517-bea9d809fc6b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:39:57,478 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#61 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_61) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_cb403174-0b29-47f9-b517-bea9d809fc6b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_cb403174-0b29-47f9-b517-bea9d809fc6b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:39:57,478 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#61 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_61).
2025-10-08 15:39:57,479 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#61 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_61.
2025-10-08 15:39:57,490 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#61 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_61).
2025-10-08 15:39:57,490 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#61 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_61) switched from INITIALIZING to CANCELING.
2025-10-08 15:39:57,490 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#61 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_61).
2025-10-08 15:39:57,491 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 2-1 still running. Killing.
2025-10-08 15:39:57,495 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@59fcc2d3, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@2cd062f4, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@b9d72f9, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@2786f2ce, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@18d356b7, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@373b509b}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:39:57,498 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#61 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_61) switched from CANCELING to CANCELED.
2025-10-08 15:39:57,498 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#61 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_61).
2025-10-08 15:39:57,498 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#61 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_61.
2025-10-08 15:40:57,494 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot f25ae18569e6e6be2f8b279066bb4778.
2025-10-08 15:40:57,496 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#62 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_62), deploy into slot with allocation id f25ae18569e6e6be2f8b279066bb4778.
2025-10-08 15:40:57,497 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot f25ae18569e6e6be2f8b279066bb4778.
2025-10-08 15:40:57,497 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#62 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_62) switched from CREATED to DEPLOYING.
2025-10-08 15:40:57,499 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#62 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_62) [DEPLOYING].
2025-10-08 15:40:57,500 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#62 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_62), deploy into slot with allocation id f25ae18569e6e6be2f8b279066bb4778.
2025-10-08 15:40:57,500 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:40:57,500 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:40:57,501 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:40:57,501 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:40:57,501 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#62 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_62) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:40:57,502 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#62 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_62) switched from CREATED to DEPLOYING.
2025-10-08 15:40:57,503 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#62 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_62) [DEPLOYING].
2025-10-08 15:40:57,504 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:40:57,504 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:40:57,505 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:40:57,506 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:40:57,507 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:40:57,507 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:40:57,506 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:40:57,507 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:40:57,507 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#62 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_62) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:40:57,508 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:40:57,508 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:40:57,509 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:40:57,509 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:40:57,515 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:40:57,515 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:40:57,516 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:40:57,516 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:40:57,518 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:40:57,623 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:40:57,623 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:40:57,624 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:40:57,624 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:40:57,627 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:40:57,627 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a4442418-c1b9-4d5b-8dfb-8c1675c4a3dd/ec6726cb-c056-4917-8a42-6a796bcdc476', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=fd2b0bd2-bfe7-48f2-ab37-5912d46323bb}.
2025-10-08 15:40:57,644 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a4442418-c1b9-4d5b-8dfb-8c1675c4a3dd/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a4442418-c1b9-4d5b-8dfb-8c1675c4a3dd/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:40:57,645 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:40:57,646 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a4442418-c1b9-4d5b-8dfb-8c1675c4a3dd/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a4442418-c1b9-4d5b-8dfb-8c1675c4a3dd/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:40:57,646 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a4442418-c1b9-4d5b-8dfb-8c1675c4a3dd/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a4442418-c1b9-4d5b-8dfb-8c1675c4a3dd/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:40:57,648 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#62 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_62) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a4442418-c1b9-4d5b-8dfb-8c1675c4a3dd/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a4442418-c1b9-4d5b-8dfb-8c1675c4a3dd/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:40:57,649 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#62 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_62).
2025-10-08 15:40:57,651 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#62 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_62.
2025-10-08 15:40:57,665 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#62 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_62).
2025-10-08 15:40:57,665 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#62 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_62) switched from INITIALIZING to CANCELING.
2025-10-08 15:40:57,665 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#62 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_62).
2025-10-08 15:40:57,667 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 3-1 still running. Killing.
2025-10-08 15:40:57,673 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@16b88700, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@12816c6, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@190857a1, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@353ee544, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@67ece464, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@26b35079}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:40:57,679 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#62 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_62) switched from CANCELING to CANCELED.
2025-10-08 15:40:57,679 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#62 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_62).
2025-10-08 15:40:57,680 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#62 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_62.
2025-10-08 15:41:48,640 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Free slot TaskSlot(index:11, state:ACTIVE, resource profile: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}, allocationId: f25ae18569e6e6be2f8b279066bb4778, jobId: d1f164921ad7c2fe36d4e92a16bdba98).
2025-10-08 15:41:48,640 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Remove job d1f164921ad7c2fe36d4e92a16bdba98 from job leader monitoring.
2025-10-08 15:41:48,640 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Close JobManager connection for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:41:57,759 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Receive slot request 89ead1b64d221a4620718fac4e1799b6 for job d1f164921ad7c2fe36d4e92a16bdba98 from resource manager with leader id 00000000000000000000000000000000.
2025-10-08 15:41:57,760 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Allocated slot for 89ead1b64d221a4620718fac4e1799b6 with resources ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 15:41:57,760 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Add job d1f164921ad7c2fe36d4e92a16bdba98 for job leader monitoring.
2025-10-08 15:41:57,760 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Try to register at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 with leader id 00000000-0000-0000-0000-000000000000.
2025-10-08 15:41:57,763 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Resolved JobManager address, beginning registration
2025-10-08 15:41:57,767 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Successful registration at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:41:57,767 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Establish JobManager connection for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:41:57,767 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Offer reserved slots to the leader of job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:41:57,770 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 89ead1b64d221a4620718fac4e1799b6.
2025-10-08 15:41:57,771 INFO  org.apache.flink.runtime.state.changelog.StateChangelogStorageLoader [] - Creating a changelog storage with name 'memory'.
2025-10-08 15:41:57,771 INFO  org.apache.flink.runtime.state.TaskExecutorChannelStateExecutorFactoryManager [] - Creating the channel state executor factory for job id d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:41:57,772 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#63 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_63), deploy into slot with allocation id 89ead1b64d221a4620718fac4e1799b6.
2025-10-08 15:41:57,772 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#63 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_63) switched from CREATED to DEPLOYING.
2025-10-08 15:41:57,772 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#63 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_63) [DEPLOYING].
2025-10-08 15:41:57,774 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 89ead1b64d221a4620718fac4e1799b6.
2025-10-08 15:41:57,775 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 89ead1b64d221a4620718fac4e1799b6.
2025-10-08 15:41:57,776 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#63 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_63), deploy into slot with allocation id 89ead1b64d221a4620718fac4e1799b6.
2025-10-08 15:41:57,776 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#63 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_63) switched from CREATED to DEPLOYING.
2025-10-08 15:41:57,777 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#63 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_63) [DEPLOYING].
2025-10-08 15:41:57,777 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:41:57,777 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:41:57,777 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:41:57,778 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:41:57,778 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#63 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_63) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:41:57,783 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:41:57,783 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:41:57,783 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:41:57,783 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:41:57,783 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#63 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_63) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:41:57,796 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:41:57,796 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:41:57,797 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:41:57,797 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:41:57,798 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:41:57,798 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:41:57,799 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:41:57,799 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:41:57,799 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:41:57,799 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:41:57,803 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:41:57,803 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_cb9c9802-0d54-40e0-bda5-20641e857713/df8aa0e2-d880-4047-89c0-1b28154736c2', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=cf0515fa-1d44-479d-857f-28cd428893e2}.
2025-10-08 15:41:57,811 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:41:57,811 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:41:57,819 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_cb9c9802-0d54-40e0-bda5-20641e857713/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_cb9c9802-0d54-40e0-bda5-20641e857713/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:41:57,820 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:41:57,820 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_cb9c9802-0d54-40e0-bda5-20641e857713/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_cb9c9802-0d54-40e0-bda5-20641e857713/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:41:57,821 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_cb9c9802-0d54-40e0-bda5-20641e857713/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_cb9c9802-0d54-40e0-bda5-20641e857713/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:41:57,935 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#63 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_63) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_cb9c9802-0d54-40e0-bda5-20641e857713/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_cb9c9802-0d54-40e0-bda5-20641e857713/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:41:57,945 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#63 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_63).
2025-10-08 15:41:57,948 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#63 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_63.
2025-10-08 15:41:57,962 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#63 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_63).
2025-10-08 15:41:57,962 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#63 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_63) switched from INITIALIZING to CANCELING.
2025-10-08 15:41:57,962 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#63 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_63).
2025-10-08 15:41:57,980 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Using standard YAML parser to load flink configuration file from /opt/flink/conf/config.yaml.
2025-10-08 15:41:57,981 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: blob.server.port, 6124
2025-10-08 15:41:57,981 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.memory.process.size, 1728m
2025-10-08 15:41:57,981 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.bind-host, 0.0.0.0
2025-10-08 15:41:57,981 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.execution.failover-strategy, region
2025-10-08 15:41:57,981 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.address, 30a48f53a5ec
2025-10-08 15:41:57,981 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.incremental, false
2025-10-08 15:41:57,981 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.rocksdb.localdir, /tmp/rocksdb
2025-10-08 15:41:57,981 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.target, remote
2025-10-08 15:41:57,981 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.memory.process.size, 1600m
2025-10-08 15:41:57,981 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.port, 6123
2025-10-08 15:41:57,981 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: query.server.port, 6125
2025-10-08 15:41:57,981 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.bind-address, 0.0.0.0
2025-10-08 15:41:57,981 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.bind-host, 0.0.0.0
2025-10-08 15:41:57,981 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.savepoint-dir, file:///tmp/flink-checkpoints
2025-10-08 15:41:57,981 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.host, 127.0.0.1
2025-10-08 15:41:57,981 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.externalized-checkpoint-retention, RETAIN_ON_CANCELLATION
2025-10-08 15:41:57,981 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: parallelism.default, 1
2025-10-08 15:41:57,981 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.numberOfTaskSlots, 1
2025-10-08 15:41:57,981 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.local-backup.enabled, true
2025-10-08 15:41:57,981 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.address, 127.0.0.1
2025-10-08 15:41:57,981 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.dir, file:///tmp/flink-checkpoints
2025-10-08 15:41:57,981 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: env.java.opts.all, --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.text=ALL-UNNAMED --add-opens=java.base/java.time=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED
2025-10-08 15:41:57,981 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.type, rocksdb
2025-10-08 15:41:57,986 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:41:57,986 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:41:58,010 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#63 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_63) switched from CANCELING to CANCELED.
2025-10-08 15:41:58,010 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#63 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_63).
2025-10-08 15:41:58,011 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#63 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_63.
2025-10-08 15:42:57,969 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 89ead1b64d221a4620718fac4e1799b6.
2025-10-08 15:42:57,970 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#64 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_64), deploy into slot with allocation id 89ead1b64d221a4620718fac4e1799b6.
2025-10-08 15:42:57,971 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 89ead1b64d221a4620718fac4e1799b6.
2025-10-08 15:42:57,971 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#64 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_64) switched from CREATED to DEPLOYING.
2025-10-08 15:42:57,972 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#64 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_64) [DEPLOYING].
2025-10-08 15:42:57,972 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#64 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_64), deploy into slot with allocation id 89ead1b64d221a4620718fac4e1799b6.
2025-10-08 15:42:57,973 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:42:57,973 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:42:57,973 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#64 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_64) switched from CREATED to DEPLOYING.
2025-10-08 15:42:57,973 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#64 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_64) [DEPLOYING].
2025-10-08 15:42:57,973 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:42:57,974 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:42:57,974 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:42:57,974 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:42:57,974 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#64 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_64) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:42:57,975 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:42:57,975 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:42:57,975 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#64 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_64) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:42:57,977 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:42:57,977 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:42:57,977 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:42:57,977 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:42:57,978 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:42:57,978 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:42:57,978 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:42:57,978 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:42:57,979 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:42:57,979 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:42:57,981 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:42:57,981 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:42:57,981 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:42:57,982 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:42:57,982 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:42:57,984 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:42:57,987 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:42:57,987 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_984f0180-fc3d-4b19-a3d6-1d39470ce96b/6b42cc27-9e61-42bc-a168-2cc6ea551530', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=207dee74-d5d2-4604-82e2-93aa7c3e3b48}.
2025-10-08 15:42:58,001 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_984f0180-fc3d-4b19-a3d6-1d39470ce96b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_984f0180-fc3d-4b19-a3d6-1d39470ce96b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:42:58,001 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:42:58,002 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_984f0180-fc3d-4b19-a3d6-1d39470ce96b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_984f0180-fc3d-4b19-a3d6-1d39470ce96b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:42:58,002 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_984f0180-fc3d-4b19-a3d6-1d39470ce96b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_984f0180-fc3d-4b19-a3d6-1d39470ce96b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:42:58,003 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#64 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_64) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_984f0180-fc3d-4b19-a3d6-1d39470ce96b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_984f0180-fc3d-4b19-a3d6-1d39470ce96b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:42:58,003 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#64 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_64).
2025-10-08 15:42:58,004 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#64 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_64.
2025-10-08 15:42:58,010 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#64 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_64).
2025-10-08 15:42:58,010 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#64 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_64) switched from INITIALIZING to CANCELING.
2025-10-08 15:42:58,010 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#64 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_64).
2025-10-08 15:42:58,484 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#64 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_64) switched from CANCELING to CANCELED.
2025-10-08 15:42:58,484 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#64 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_64).
2025-10-08 15:42:58,484 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#64 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_64.
2025-10-08 15:43:58,016 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 89ead1b64d221a4620718fac4e1799b6.
2025-10-08 15:43:58,017 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#65 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_65), deploy into slot with allocation id 89ead1b64d221a4620718fac4e1799b6.
2025-10-08 15:43:58,017 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 89ead1b64d221a4620718fac4e1799b6.
2025-10-08 15:43:58,017 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#65 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_65) switched from CREATED to DEPLOYING.
2025-10-08 15:43:58,018 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#65 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_65) [DEPLOYING].
2025-10-08 15:43:58,019 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#65 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_65), deploy into slot with allocation id 89ead1b64d221a4620718fac4e1799b6.
2025-10-08 15:43:58,019 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#65 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_65) switched from CREATED to DEPLOYING.
2025-10-08 15:43:58,019 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#65 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_65) [DEPLOYING].
2025-10-08 15:43:58,019 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:43:58,020 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:43:58,020 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:43:58,020 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:43:58,019 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:43:58,021 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:43:58,021 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:43:58,021 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:43:58,021 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#65 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_65) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:43:58,022 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#65 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_65) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:43:58,024 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:43:58,025 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:43:58,025 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:43:58,026 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:43:58,026 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:43:58,026 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:43:58,026 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:43:58,026 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:43:58,026 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:43:58,026 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:43:58,027 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:43:58,027 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:43:58,027 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:43:58,027 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:43:58,030 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:43:58,030 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:43:58,035 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:43:58,035 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_73a7818d-2141-447c-b71e-032b1646bba6/c90cdc68-36f9-42b9-ab08-167ac1e96ed3', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=b2ba6313-0c69-43c7-ad2a-948fb0edde14}.
2025-10-08 15:43:58,047 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_73a7818d-2141-447c-b71e-032b1646bba6/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_73a7818d-2141-447c-b71e-032b1646bba6/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:43:58,258 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:43:58,259 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:43:58,262 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_73a7818d-2141-447c-b71e-032b1646bba6/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_73a7818d-2141-447c-b71e-032b1646bba6/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:43:58,263 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_73a7818d-2141-447c-b71e-032b1646bba6/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_73a7818d-2141-447c-b71e-032b1646bba6/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:43:58,265 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#65 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_65) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_73a7818d-2141-447c-b71e-032b1646bba6/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_73a7818d-2141-447c-b71e-032b1646bba6/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:43:58,267 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#65 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_65).
2025-10-08 15:43:58,269 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#65 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_65.
2025-10-08 15:43:58,278 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#65 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_65).
2025-10-08 15:43:58,279 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#65 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_65) switched from INITIALIZING to CANCELING.
2025-10-08 15:43:58,279 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#65 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_65).
2025-10-08 15:43:58,452 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 1-1 still running. Killing.
2025-10-08 15:43:58,457 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@84ca18f, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@6f4968fc, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@41bd3a26, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@704eaecf, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@1de32990, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@3949ac58}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:43:58,459 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#65 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_65) switched from CANCELING to CANCELED.
2025-10-08 15:43:58,460 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#65 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_65).
2025-10-08 15:43:58,460 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#65 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_65.
2025-10-08 15:44:58,286 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 89ead1b64d221a4620718fac4e1799b6.
2025-10-08 15:44:58,287 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#66 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_66), deploy into slot with allocation id 89ead1b64d221a4620718fac4e1799b6.
2025-10-08 15:44:58,288 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 89ead1b64d221a4620718fac4e1799b6.
2025-10-08 15:44:58,288 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#66 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_66) switched from CREATED to DEPLOYING.
2025-10-08 15:44:58,290 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#66 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_66), deploy into slot with allocation id 89ead1b64d221a4620718fac4e1799b6.
2025-10-08 15:44:58,291 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#66 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_66) [DEPLOYING].
2025-10-08 15:44:58,292 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#66 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_66) switched from CREATED to DEPLOYING.
2025-10-08 15:44:58,292 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#66 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_66) [DEPLOYING].
2025-10-08 15:44:58,292 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:44:58,293 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:44:58,293 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:44:58,293 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:44:58,294 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:44:58,294 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#66 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_66) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:44:58,294 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:44:58,294 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:44:58,294 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:44:58,294 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#66 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_66) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:44:58,298 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:44:58,298 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:44:58,299 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:44:58,299 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:44:58,300 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:44:58,300 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:44:58,301 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:44:58,302 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:44:58,302 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:44:58,302 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:44:58,302 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:44:58,302 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:44:58,302 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:44:58,303 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:44:58,303 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:44:58,303 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:44:58,310 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:44:58,311 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e04e8e23-a2ce-421d-a758-38e0269e751e/99ccd2f8-d2e3-40dd-86c1-feae43f4207f', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=e9a248ff-ae80-467a-aef7-502fb7c34c8e}.
2025-10-08 15:44:58,335 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e04e8e23-a2ce-421d-a758-38e0269e751e/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e04e8e23-a2ce-421d-a758-38e0269e751e/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:44:58,417 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:44:58,417 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:44:58,418 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e04e8e23-a2ce-421d-a758-38e0269e751e/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e04e8e23-a2ce-421d-a758-38e0269e751e/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:44:58,418 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e04e8e23-a2ce-421d-a758-38e0269e751e/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e04e8e23-a2ce-421d-a758-38e0269e751e/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:44:58,419 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#66 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_66) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e04e8e23-a2ce-421d-a758-38e0269e751e/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e04e8e23-a2ce-421d-a758-38e0269e751e/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:44:58,419 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#66 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_66).
2025-10-08 15:44:58,421 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#66 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_66.
2025-10-08 15:44:58,433 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#66 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_66).
2025-10-08 15:44:58,433 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#66 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_66) switched from INITIALIZING to CANCELING.
2025-10-08 15:44:58,433 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#66 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_66).
2025-10-08 15:44:58,434 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 2-1 still running. Killing.
2025-10-08 15:44:58,436 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@783e277e, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@e41e8ce, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@431e454e, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@15d85fb6, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@1c549fa4, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@1dd20378}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:44:58,438 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#66 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_66) switched from CANCELING to CANCELED.
2025-10-08 15:44:58,438 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#66 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_66).
2025-10-08 15:44:58,438 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#66 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_66.
2025-10-08 15:45:58,437 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 89ead1b64d221a4620718fac4e1799b6.
2025-10-08 15:45:58,438 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#67 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_67), deploy into slot with allocation id 89ead1b64d221a4620718fac4e1799b6.
2025-10-08 15:45:58,439 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 89ead1b64d221a4620718fac4e1799b6.
2025-10-08 15:45:58,438 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#67 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_67) switched from CREATED to DEPLOYING.
2025-10-08 15:45:58,439 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#67 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_67) [DEPLOYING].
2025-10-08 15:45:58,440 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#67 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_67), deploy into slot with allocation id 89ead1b64d221a4620718fac4e1799b6.
2025-10-08 15:45:58,440 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#67 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_67) switched from CREATED to DEPLOYING.
2025-10-08 15:45:58,440 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#67 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_67) [DEPLOYING].
2025-10-08 15:45:58,441 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:45:58,441 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:45:58,441 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:45:58,441 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:45:58,441 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:45:58,441 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:45:58,441 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:45:58,441 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:45:58,441 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#67 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_67) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:45:58,441 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#67 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_67) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:45:58,445 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:45:58,445 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:45:58,445 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:45:58,445 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:45:58,446 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:45:58,446 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:45:58,446 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:45:58,446 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:45:58,447 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:45:58,447 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:45:58,447 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:45:58,447 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:45:58,448 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:45:58,448 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:45:58,449 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:45:58,449 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:45:58,450 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:45:58,450 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0f65af17-f67f-4f54-901c-76f2a330313d/eaaae32a-a7e0-4711-9b1f-a0c89dab9106', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=d5876984-8588-4114-86d0-24e4424d5fbf}.
2025-10-08 15:45:58,467 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0f65af17-f67f-4f54-901c-76f2a330313d/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0f65af17-f67f-4f54-901c-76f2a330313d/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:45:58,572 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:45:58,572 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:45:58,575 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0f65af17-f67f-4f54-901c-76f2a330313d/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0f65af17-f67f-4f54-901c-76f2a330313d/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:45:58,576 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0f65af17-f67f-4f54-901c-76f2a330313d/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0f65af17-f67f-4f54-901c-76f2a330313d/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:45:58,577 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#67 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_67) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0f65af17-f67f-4f54-901c-76f2a330313d/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0f65af17-f67f-4f54-901c-76f2a330313d/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:45:58,577 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#67 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_67).
2025-10-08 15:45:58,578 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#67 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_67.
2025-10-08 15:45:58,588 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#67 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_67).
2025-10-08 15:45:58,588 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#67 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_67) switched from INITIALIZING to CANCELING.
2025-10-08 15:45:58,588 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#67 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_67).
2025-10-08 15:45:58,589 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 3-1 still running. Killing.
2025-10-08 15:45:58,591 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@6580d309, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@762e5278, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@1345dcf, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@616d386d, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@216b7d2, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@62f987a}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:45:58,593 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#67 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_67) switched from CANCELING to CANCELED.
2025-10-08 15:45:58,593 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#67 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_67).
2025-10-08 15:45:58,594 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#67 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_67.
2025-10-08 15:46:48,643 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Free slot TaskSlot(index:12, state:ACTIVE, resource profile: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}, allocationId: 89ead1b64d221a4620718fac4e1799b6, jobId: d1f164921ad7c2fe36d4e92a16bdba98).
2025-10-08 15:46:48,643 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Remove job d1f164921ad7c2fe36d4e92a16bdba98 from job leader monitoring.
2025-10-08 15:46:48,643 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Close JobManager connection for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:46:58,679 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Receive slot request 5744d892f5f368deda31f6736880300f for job d1f164921ad7c2fe36d4e92a16bdba98 from resource manager with leader id 00000000000000000000000000000000.
2025-10-08 15:46:58,680 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Allocated slot for 5744d892f5f368deda31f6736880300f with resources ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 15:46:58,680 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Add job d1f164921ad7c2fe36d4e92a16bdba98 for job leader monitoring.
2025-10-08 15:46:58,680 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Try to register at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 with leader id 00000000-0000-0000-0000-000000000000.
2025-10-08 15:46:58,684 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Resolved JobManager address, beginning registration
2025-10-08 15:46:58,687 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Successful registration at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:46:58,687 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Establish JobManager connection for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:46:58,687 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Offer reserved slots to the leader of job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:46:58,692 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 5744d892f5f368deda31f6736880300f.
2025-10-08 15:46:58,693 INFO  org.apache.flink.runtime.state.changelog.StateChangelogStorageLoader [] - Creating a changelog storage with name 'memory'.
2025-10-08 15:46:58,693 INFO  org.apache.flink.runtime.state.TaskExecutorChannelStateExecutorFactoryManager [] - Creating the channel state executor factory for job id d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:46:58,693 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#68 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_68), deploy into slot with allocation id 5744d892f5f368deda31f6736880300f.
2025-10-08 15:46:58,694 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 5744d892f5f368deda31f6736880300f.
2025-10-08 15:46:58,693 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#68 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_68) switched from CREATED to DEPLOYING.
2025-10-08 15:46:58,694 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#68 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_68) [DEPLOYING].
2025-10-08 15:46:58,695 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#68 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_68), deploy into slot with allocation id 5744d892f5f368deda31f6736880300f.
2025-10-08 15:46:58,695 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 5744d892f5f368deda31f6736880300f.
2025-10-08 15:46:58,695 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#68 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_68) switched from CREATED to DEPLOYING.
2025-10-08 15:46:58,696 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#68 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_68) [DEPLOYING].
2025-10-08 15:46:58,696 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:46:58,696 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:46:58,697 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:46:58,697 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:46:58,697 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#68 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_68) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:46:58,701 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:46:58,701 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:46:58,702 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:46:58,702 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:46:58,702 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#68 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_68) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:46:58,714 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:46:58,714 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:46:58,717 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:46:58,718 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:46:58,719 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:46:58,719 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:46:58,720 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:46:58,721 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:46:58,721 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:46:58,722 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:46:58,724 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:46:58,724 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:46:58,726 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:46:58,726 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6e34a473-db6c-41e9-8015-f507d6ff2d3e/2e180d48-a8a7-4ce5-a856-daf34582080a', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=41058fc9-7085-41ef-ada1-0fb0f1540f96}.
2025-10-08 15:46:58,743 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6e34a473-db6c-41e9-8015-f507d6ff2d3e/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6e34a473-db6c-41e9-8015-f507d6ff2d3e/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:46:58,745 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:46:58,745 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6e34a473-db6c-41e9-8015-f507d6ff2d3e/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6e34a473-db6c-41e9-8015-f507d6ff2d3e/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:46:58,746 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6e34a473-db6c-41e9-8015-f507d6ff2d3e/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6e34a473-db6c-41e9-8015-f507d6ff2d3e/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:46:58,863 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#68 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_68) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6e34a473-db6c-41e9-8015-f507d6ff2d3e/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6e34a473-db6c-41e9-8015-f507d6ff2d3e/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:46:58,865 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#68 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_68).
2025-10-08 15:46:58,866 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#68 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_68.
2025-10-08 15:46:58,878 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#68 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_68).
2025-10-08 15:46:58,878 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#68 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_68) switched from INITIALIZING to CANCELING.
2025-10-08 15:46:58,878 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#68 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_68).
2025-10-08 15:46:58,891 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Using standard YAML parser to load flink configuration file from /opt/flink/conf/config.yaml.
2025-10-08 15:46:58,893 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: blob.server.port, 6124
2025-10-08 15:46:58,893 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.memory.process.size, 1728m
2025-10-08 15:46:58,893 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.bind-host, 0.0.0.0
2025-10-08 15:46:58,893 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.execution.failover-strategy, region
2025-10-08 15:46:58,893 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.address, 30a48f53a5ec
2025-10-08 15:46:58,893 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.incremental, false
2025-10-08 15:46:58,893 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.rocksdb.localdir, /tmp/rocksdb
2025-10-08 15:46:58,893 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.target, remote
2025-10-08 15:46:58,893 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.memory.process.size, 1600m
2025-10-08 15:46:58,893 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.port, 6123
2025-10-08 15:46:58,893 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: query.server.port, 6125
2025-10-08 15:46:58,893 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.bind-address, 0.0.0.0
2025-10-08 15:46:58,893 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.bind-host, 0.0.0.0
2025-10-08 15:46:58,893 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.savepoint-dir, file:///tmp/flink-checkpoints
2025-10-08 15:46:58,893 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.host, 127.0.0.1
2025-10-08 15:46:58,893 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.externalized-checkpoint-retention, RETAIN_ON_CANCELLATION
2025-10-08 15:46:58,893 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: parallelism.default, 1
2025-10-08 15:46:58,893 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.numberOfTaskSlots, 1
2025-10-08 15:46:58,893 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.local-backup.enabled, true
2025-10-08 15:46:58,893 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.address, 127.0.0.1
2025-10-08 15:46:58,893 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.dir, file:///tmp/flink-checkpoints
2025-10-08 15:46:58,893 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: env.java.opts.all, --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.text=ALL-UNNAMED --add-opens=java.base/java.time=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED
2025-10-08 15:46:58,893 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.type, rocksdb
2025-10-08 15:46:58,898 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:46:58,898 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:46:58,929 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#68 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_68) switched from CANCELING to CANCELED.
2025-10-08 15:46:58,929 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#68 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_68).
2025-10-08 15:46:58,929 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#68 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_68.
2025-10-08 15:47:58,884 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 5744d892f5f368deda31f6736880300f.
2025-10-08 15:47:58,885 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#69 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_69), deploy into slot with allocation id 5744d892f5f368deda31f6736880300f.
2025-10-08 15:47:58,885 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 5744d892f5f368deda31f6736880300f.
2025-10-08 15:47:58,885 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#69 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_69) switched from CREATED to DEPLOYING.
2025-10-08 15:47:58,886 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#69 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_69), deploy into slot with allocation id 5744d892f5f368deda31f6736880300f.
2025-10-08 15:47:58,887 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#69 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_69) [DEPLOYING].
2025-10-08 15:47:58,887 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#69 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_69) switched from CREATED to DEPLOYING.
2025-10-08 15:47:58,888 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#69 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_69) [DEPLOYING].
2025-10-08 15:47:58,888 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:47:58,888 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:47:58,888 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:47:58,888 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:47:58,888 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:47:58,889 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:47:58,889 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:47:58,889 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:47:58,889 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#69 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_69) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:47:58,889 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#69 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_69) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:47:58,892 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:47:58,892 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:47:58,892 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:47:58,892 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:47:58,893 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:47:58,893 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:47:58,894 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:47:58,894 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:47:58,895 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:47:58,895 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:47:58,895 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:47:58,895 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:47:58,896 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:47:58,896 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:47:58,897 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:47:58,897 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:47:58,899 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:47:58,899 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7420377d-19b0-49fb-bd0b-60cd48895d1b/4f4f0e9b-282d-48a5-8f88-32ff0c2b5687', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0304eaf6-3e3f-47fc-b265-a4ea5687f139}.
2025-10-08 15:47:58,915 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7420377d-19b0-49fb-bd0b-60cd48895d1b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7420377d-19b0-49fb-bd0b-60cd48895d1b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:47:58,916 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:47:58,918 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7420377d-19b0-49fb-bd0b-60cd48895d1b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7420377d-19b0-49fb-bd0b-60cd48895d1b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:47:58,918 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7420377d-19b0-49fb-bd0b-60cd48895d1b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7420377d-19b0-49fb-bd0b-60cd48895d1b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:47:58,919 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#69 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_69) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7420377d-19b0-49fb-bd0b-60cd48895d1b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7420377d-19b0-49fb-bd0b-60cd48895d1b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:47:58,920 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#69 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_69).
2025-10-08 15:47:58,921 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#69 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_69.
2025-10-08 15:47:58,933 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#69 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_69).
2025-10-08 15:47:58,933 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#69 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_69) switched from INITIALIZING to CANCELING.
2025-10-08 15:47:58,933 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#69 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_69).
2025-10-08 15:47:59,383 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#69 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_69) switched from CANCELING to CANCELED.
2025-10-08 15:47:59,384 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#69 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_69).
2025-10-08 15:47:59,385 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#69 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_69.
2025-10-08 15:48:58,937 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 5744d892f5f368deda31f6736880300f.
2025-10-08 15:48:58,938 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#70 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_70), deploy into slot with allocation id 5744d892f5f368deda31f6736880300f.
2025-10-08 15:48:58,938 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 5744d892f5f368deda31f6736880300f.
2025-10-08 15:48:58,938 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#70 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_70) switched from CREATED to DEPLOYING.
2025-10-08 15:48:58,939 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#70 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_70) [DEPLOYING].
2025-10-08 15:48:58,939 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#70 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_70), deploy into slot with allocation id 5744d892f5f368deda31f6736880300f.
2025-10-08 15:48:58,940 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:48:58,940 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:48:58,940 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#70 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_70) switched from CREATED to DEPLOYING.
2025-10-08 15:48:58,940 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#70 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_70) [DEPLOYING].
2025-10-08 15:48:58,940 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:48:58,941 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:48:58,941 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:48:58,941 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:48:58,941 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:48:58,941 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#70 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_70) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:48:58,941 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:48:58,941 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#70 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_70) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:48:58,944 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:48:58,944 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:48:58,945 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:48:58,945 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:48:58,945 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:48:58,945 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:48:58,945 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:48:58,945 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:48:58,946 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:48:58,946 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:48:58,946 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:48:58,946 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:48:58,947 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:48:58,947 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:48:58,947 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:48:58,947 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:48:58,952 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:48:58,952 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_59b6e101-8a0a-43d1-8982-861bb016acd6/c281f105-6bb0-41fc-b8a6-d8a667ddf3dd', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=c73c47c2-b7d2-47f2-ba7f-7d7b7cee443e}.
2025-10-08 15:48:58,970 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_59b6e101-8a0a-43d1-8982-861bb016acd6/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_59b6e101-8a0a-43d1-8982-861bb016acd6/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:48:59,167 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:48:59,169 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:48:59,170 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_59b6e101-8a0a-43d1-8982-861bb016acd6/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_59b6e101-8a0a-43d1-8982-861bb016acd6/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:48:59,171 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_59b6e101-8a0a-43d1-8982-861bb016acd6/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_59b6e101-8a0a-43d1-8982-861bb016acd6/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:48:59,172 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#70 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_70) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_59b6e101-8a0a-43d1-8982-861bb016acd6/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_59b6e101-8a0a-43d1-8982-861bb016acd6/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:48:59,173 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#70 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_70).
2025-10-08 15:48:59,176 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#70 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_70.
2025-10-08 15:48:59,196 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#70 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_70).
2025-10-08 15:48:59,196 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#70 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_70) switched from INITIALIZING to CANCELING.
2025-10-08 15:48:59,196 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#70 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_70).
2025-10-08 15:48:59,455 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 1-1 still running. Killing.
2025-10-08 15:48:59,462 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@2d40bbc6, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@3d530cca, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@2fd4fe57, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@3a59ab01, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@126fb907, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@377fc2dc}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:48:59,470 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#70 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_70) switched from CANCELING to CANCELED.
2025-10-08 15:48:59,470 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#70 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_70).
2025-10-08 15:48:59,470 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#70 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_70.
2025-10-08 15:49:59,200 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 5744d892f5f368deda31f6736880300f.
2025-10-08 15:49:59,200 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#71 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_71), deploy into slot with allocation id 5744d892f5f368deda31f6736880300f.
2025-10-08 15:49:59,201 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 5744d892f5f368deda31f6736880300f.
2025-10-08 15:49:59,201 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#71 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_71) switched from CREATED to DEPLOYING.
2025-10-08 15:49:59,201 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#71 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_71) [DEPLOYING].
2025-10-08 15:49:59,202 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#71 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_71), deploy into slot with allocation id 5744d892f5f368deda31f6736880300f.
2025-10-08 15:49:59,202 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:49:59,202 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:49:59,203 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:49:59,203 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:49:59,203 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#71 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_71) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:49:59,205 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#71 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_71) switched from CREATED to DEPLOYING.
2025-10-08 15:49:59,205 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#71 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_71) [DEPLOYING].
2025-10-08 15:49:59,205 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:49:59,205 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:49:59,206 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:49:59,206 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:49:59,206 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#71 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_71) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:49:59,207 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:49:59,208 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:49:59,208 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:49:59,208 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:49:59,209 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:49:59,209 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:49:59,209 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:49:59,209 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:49:59,214 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:49:59,214 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:49:59,214 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:49:59,215 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:49:59,216 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:49:59,319 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:49:59,320 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:49:59,321 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:49:59,322 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:49:59,324 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:49:59,324 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_21a91ce6-0cb5-45d2-bbf8-67a12e7c09d0/c69e7fac-1cee-4f01-ae08-57610462180a', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=84573904-7806-4dee-8fdf-62a0e52a2c76}.
2025-10-08 15:49:59,336 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_21a91ce6-0cb5-45d2-bbf8-67a12e7c09d0/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_21a91ce6-0cb5-45d2-bbf8-67a12e7c09d0/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:49:59,336 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:49:59,337 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_21a91ce6-0cb5-45d2-bbf8-67a12e7c09d0/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_21a91ce6-0cb5-45d2-bbf8-67a12e7c09d0/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:49:59,337 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_21a91ce6-0cb5-45d2-bbf8-67a12e7c09d0/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_21a91ce6-0cb5-45d2-bbf8-67a12e7c09d0/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:49:59,338 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#71 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_71) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_21a91ce6-0cb5-45d2-bbf8-67a12e7c09d0/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_21a91ce6-0cb5-45d2-bbf8-67a12e7c09d0/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:49:59,338 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#71 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_71).
2025-10-08 15:49:59,341 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#71 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_71.
2025-10-08 15:49:59,355 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#71 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_71).
2025-10-08 15:49:59,356 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#71 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_71) switched from INITIALIZING to CANCELING.
2025-10-08 15:49:59,356 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#71 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_71).
2025-10-08 15:49:59,357 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 2-1 still running. Killing.
2025-10-08 15:49:59,363 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@317cd1ed, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@6befb7d1, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@544b2501, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@22b55eff, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@759100fd, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@63d660a1}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:49:59,367 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#71 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_71) switched from CANCELING to CANCELED.
2025-10-08 15:49:59,367 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#71 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_71).
2025-10-08 15:49:59,367 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#71 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_71.
2025-10-08 15:50:58,644 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Free slot TaskSlot(index:13, state:ACTIVE, resource profile: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}, allocationId: 5744d892f5f368deda31f6736880300f, jobId: d1f164921ad7c2fe36d4e92a16bdba98).
2025-10-08 15:50:58,645 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Remove job d1f164921ad7c2fe36d4e92a16bdba98 from job leader monitoring.
2025-10-08 15:50:58,645 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Close JobManager connection for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:50:59,438 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Receive slot request 943f996f923e9b9dabe37d6f667c56d8 for job d1f164921ad7c2fe36d4e92a16bdba98 from resource manager with leader id 00000000000000000000000000000000.
2025-10-08 15:50:59,439 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Allocated slot for 943f996f923e9b9dabe37d6f667c56d8 with resources ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 15:50:59,439 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Add job d1f164921ad7c2fe36d4e92a16bdba98 for job leader monitoring.
2025-10-08 15:50:59,439 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Try to register at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 with leader id 00000000-0000-0000-0000-000000000000.
2025-10-08 15:50:59,443 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Resolved JobManager address, beginning registration
2025-10-08 15:50:59,447 INFO  org.apache.flink.runtime.taskexecutor.DefaultJobLeaderService [] - Successful registration at job manager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:50:59,447 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Establish JobManager connection for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:50:59,447 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Offer reserved slots to the leader of job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:50:59,451 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 943f996f923e9b9dabe37d6f667c56d8.
2025-10-08 15:50:59,452 INFO  org.apache.flink.runtime.state.changelog.StateChangelogStorageLoader [] - Creating a changelog storage with name 'memory'.
2025-10-08 15:50:59,452 INFO  org.apache.flink.runtime.state.TaskExecutorChannelStateExecutorFactoryManager [] - Creating the channel state executor factory for job id d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:50:59,453 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#72 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_72), deploy into slot with allocation id 943f996f923e9b9dabe37d6f667c56d8.
2025-10-08 15:50:59,453 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#72 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_72) switched from CREATED to DEPLOYING.
2025-10-08 15:50:59,453 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#72 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_72) [DEPLOYING].
2025-10-08 15:50:59,455 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 943f996f923e9b9dabe37d6f667c56d8.
2025-10-08 15:50:59,455 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 943f996f923e9b9dabe37d6f667c56d8.
2025-10-08 15:50:59,457 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#72 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_72), deploy into slot with allocation id 943f996f923e9b9dabe37d6f667c56d8.
2025-10-08 15:50:59,458 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#72 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_72) switched from CREATED to DEPLOYING.
2025-10-08 15:50:59,458 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#72 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_72) [DEPLOYING].
2025-10-08 15:50:59,458 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:50:59,458 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:50:59,459 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:50:59,459 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:50:59,459 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#72 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_72) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:50:59,464 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:50:59,464 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:50:59,464 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:50:59,464 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:50:59,464 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#72 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_72) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:50:59,474 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:50:59,475 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:50:59,475 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:50:59,475 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:50:59,476 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:50:59,476 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:50:59,476 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:50:59,477 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:50:59,477 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:50:59,478 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:50:59,480 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:50:59,480 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_044bcab5-018f-48d9-a0be-7aa2e8f6879c/641a7e77-d170-4467-a928-1af173680ca9', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=445057a6-d0c2-485a-bc65-595ad878d357}.
2025-10-08 15:50:59,480 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:50:59,480 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:50:59,491 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_044bcab5-018f-48d9-a0be-7aa2e8f6879c/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_044bcab5-018f-48d9-a0be-7aa2e8f6879c/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:50:59,491 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:50:59,492 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_044bcab5-018f-48d9-a0be-7aa2e8f6879c/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_044bcab5-018f-48d9-a0be-7aa2e8f6879c/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:50:59,492 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_044bcab5-018f-48d9-a0be-7aa2e8f6879c/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_044bcab5-018f-48d9-a0be-7aa2e8f6879c/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:50:59,592 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#72 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_72) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_044bcab5-018f-48d9-a0be-7aa2e8f6879c/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_044bcab5-018f-48d9-a0be-7aa2e8f6879c/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:50:59,592 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#72 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_72).
2025-10-08 15:50:59,593 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#72 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_72.
2025-10-08 15:50:59,607 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#72 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_72).
2025-10-08 15:50:59,607 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#72 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_72) switched from INITIALIZING to CANCELING.
2025-10-08 15:50:59,607 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#72 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_72).
2025-10-08 15:50:59,616 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Using standard YAML parser to load flink configuration file from /opt/flink/conf/config.yaml.
2025-10-08 15:50:59,617 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: blob.server.port, 6124
2025-10-08 15:50:59,617 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.memory.process.size, 1728m
2025-10-08 15:50:59,617 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.bind-host, 0.0.0.0
2025-10-08 15:50:59,617 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.execution.failover-strategy, region
2025-10-08 15:50:59,617 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.address, 30a48f53a5ec
2025-10-08 15:50:59,617 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.incremental, false
2025-10-08 15:50:59,617 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.rocksdb.localdir, /tmp/rocksdb
2025-10-08 15:50:59,617 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.target, remote
2025-10-08 15:50:59,617 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.memory.process.size, 1600m
2025-10-08 15:50:59,617 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.port, 6123
2025-10-08 15:50:59,617 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: query.server.port, 6125
2025-10-08 15:50:59,617 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.bind-address, 0.0.0.0
2025-10-08 15:50:59,617 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.bind-host, 0.0.0.0
2025-10-08 15:50:59,617 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.savepoint-dir, file:///tmp/flink-checkpoints
2025-10-08 15:50:59,617 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.host, 127.0.0.1
2025-10-08 15:50:59,617 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.externalized-checkpoint-retention, RETAIN_ON_CANCELLATION
2025-10-08 15:50:59,617 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: parallelism.default, 1
2025-10-08 15:50:59,617 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.numberOfTaskSlots, 1
2025-10-08 15:50:59,617 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.local-backup.enabled, true
2025-10-08 15:50:59,617 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.address, 127.0.0.1
2025-10-08 15:50:59,617 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.dir, file:///tmp/flink-checkpoints
2025-10-08 15:50:59,617 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: env.java.opts.all, --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.text=ALL-UNNAMED --add-opens=java.base/java.time=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED
2025-10-08 15:50:59,617 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.type, rocksdb
2025-10-08 15:50:59,622 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:50:59,622 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:50:59,648 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#72 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_72) switched from CANCELING to CANCELED.
2025-10-08 15:50:59,648 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#72 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_72).
2025-10-08 15:50:59,648 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#72 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_72.
2025-10-08 15:51:59,612 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 943f996f923e9b9dabe37d6f667c56d8.
2025-10-08 15:51:59,613 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#73 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_73), deploy into slot with allocation id 943f996f923e9b9dabe37d6f667c56d8.
2025-10-08 15:51:59,613 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 943f996f923e9b9dabe37d6f667c56d8.
2025-10-08 15:51:59,614 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#73 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_73), deploy into slot with allocation id 943f996f923e9b9dabe37d6f667c56d8.
2025-10-08 15:51:59,614 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#73 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_73) switched from CREATED to DEPLOYING.
2025-10-08 15:51:59,615 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#73 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_73) switched from CREATED to DEPLOYING.
2025-10-08 15:51:59,615 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#73 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_73) [DEPLOYING].
2025-10-08 15:51:59,616 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:51:59,616 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:51:59,616 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:51:59,616 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:51:59,617 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#73 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_73) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:51:59,617 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#73 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_73) [DEPLOYING].
2025-10-08 15:51:59,619 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:51:59,620 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:51:59,620 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:51:59,620 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:51:59,620 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#73 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_73) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:51:59,620 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:51:59,621 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:51:59,622 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:51:59,622 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:51:59,625 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:51:59,625 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:51:59,626 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:51:59,626 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:51:59,627 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:51:59,627 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:51:59,629 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:51:59,629 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:51:59,633 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:51:59,633 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_d6c9ad12-ecda-416d-b13e-e1c1ee5d4f74/2e0c0bd2-9807-4c63-9345-d86aae6bd061', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=c7641b8a-6559-49fb-86ff-22a156f83a13}.
2025-10-08 15:51:59,634 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:51:59,634 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:51:59,638 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:51:59,638 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:51:59,657 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_d6c9ad12-ecda-416d-b13e-e1c1ee5d4f74/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_d6c9ad12-ecda-416d-b13e-e1c1ee5d4f74/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:51:59,658 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:51:59,658 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_d6c9ad12-ecda-416d-b13e-e1c1ee5d4f74/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_d6c9ad12-ecda-416d-b13e-e1c1ee5d4f74/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:51:59,659 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_d6c9ad12-ecda-416d-b13e-e1c1ee5d4f74/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_d6c9ad12-ecda-416d-b13e-e1c1ee5d4f74/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:51:59,661 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#73 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_73) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_d6c9ad12-ecda-416d-b13e-e1c1ee5d4f74/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_d6c9ad12-ecda-416d-b13e-e1c1ee5d4f74/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:51:59,661 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#73 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_73).
2025-10-08 15:51:59,663 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#73 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_73.
2025-10-08 15:51:59,677 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#73 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_73).
2025-10-08 15:51:59,677 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#73 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_73) switched from INITIALIZING to CANCELING.
2025-10-08 15:51:59,677 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#73 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_73).
2025-10-08 15:52:00,310 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#73 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_73) switched from CANCELING to CANCELED.
2025-10-08 15:52:00,310 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#73 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_73).
2025-10-08 15:52:00,311 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#73 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_73.
2025-10-08 15:52:59,682 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 943f996f923e9b9dabe37d6f667c56d8.
2025-10-08 15:52:59,684 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#74 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_74), deploy into slot with allocation id 943f996f923e9b9dabe37d6f667c56d8.
2025-10-08 15:52:59,684 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 943f996f923e9b9dabe37d6f667c56d8.
2025-10-08 15:52:59,685 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#74 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_74) switched from CREATED to DEPLOYING.
2025-10-08 15:52:59,686 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#74 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_74), deploy into slot with allocation id 943f996f923e9b9dabe37d6f667c56d8.
2025-10-08 15:52:59,687 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#74 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_74) [DEPLOYING].
2025-10-08 15:52:59,691 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:52:59,692 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:52:59,693 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:52:59,693 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#74 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_74) switched from CREATED to DEPLOYING.
2025-10-08 15:52:59,693 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#74 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_74) [DEPLOYING].
2025-10-08 15:52:59,693 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:52:59,694 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#74 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_74) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:52:59,694 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:52:59,694 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:52:59,696 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:52:59,696 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:52:59,696 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#74 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_74) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:52:59,700 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:52:59,700 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:52:59,700 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:52:59,700 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:52:59,701 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:52:59,701 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:52:59,701 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:52:59,702 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:52:59,702 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:52:59,702 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:52:59,703 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:52:59,703 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:52:59,703 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:52:59,704 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:52:59,704 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:52:59,704 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:52:59,706 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:52:59,707 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_31baca94-3bf9-42a4-b9fd-fdb7f8fa84f8/bd76d80e-26d0-43c7-a252-db955fe5b362', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=3ed916aa-9d90-449a-b3b7-94203e043237}.
2025-10-08 15:52:59,724 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_31baca94-3bf9-42a4-b9fd-fdb7f8fa84f8/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_31baca94-3bf9-42a4-b9fd-fdb7f8fa84f8/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:52:59,928 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:52:59,928 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:52:59,930 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_31baca94-3bf9-42a4-b9fd-fdb7f8fa84f8/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_31baca94-3bf9-42a4-b9fd-fdb7f8fa84f8/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:52:59,931 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_31baca94-3bf9-42a4-b9fd-fdb7f8fa84f8/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_31baca94-3bf9-42a4-b9fd-fdb7f8fa84f8/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:52:59,933 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#74 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_74) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_31baca94-3bf9-42a4-b9fd-fdb7f8fa84f8/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_31baca94-3bf9-42a4-b9fd-fdb7f8fa84f8/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:52:59,933 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#74 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_74).
2025-10-08 15:52:59,934 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#74 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_74.
2025-10-08 15:52:59,945 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#74 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_74).
2025-10-08 15:52:59,945 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#74 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_74) switched from INITIALIZING to CANCELING.
2025-10-08 15:52:59,945 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#74 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_74).
2025-10-08 15:53:00,116 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 1-1 still running. Killing.
2025-10-08 15:53:00,120 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@1913c166, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@6906b1d, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@2b4d3a8f, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@620b3f11, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@6514cac7, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@60d99dfb}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:53:00,124 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#74 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_74) switched from CANCELING to CANCELED.
2025-10-08 15:53:00,124 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#74 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_74).
2025-10-08 15:53:00,124 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#74 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_74.
2025-10-08 15:53:59,948 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 943f996f923e9b9dabe37d6f667c56d8.
2025-10-08 15:53:59,949 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task Source: Collection Source -> _stream_key_by_map_operator (1/1)#75 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_75), deploy into slot with allocation id 943f996f923e9b9dabe37d6f667c56d8.
2025-10-08 15:53:59,949 INFO  org.apache.flink.runtime.taskexecutor.slot.TaskSlotTableImpl [] - Activate slot 943f996f923e9b9dabe37d6f667c56d8.
2025-10-08 15:53:59,949 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#75 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_75) switched from CREATED to DEPLOYING.
2025-10-08 15:53:59,950 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#75 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_75) [DEPLOYING].
2025-10-08 15:53:59,950 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Received task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#75 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_75), deploy into slot with allocation id 943f996f923e9b9dabe37d6f667c56d8.
2025-10-08 15:53:59,951 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:53:59,951 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:53:59,951 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#75 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_75) switched from CREATED to DEPLOYING.
2025-10-08 15:53:59,951 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Loading JAR files for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#75 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_75) [DEPLOYING].
2025-10-08 15:53:59,951 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:53:59,952 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:53:59,952 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:53:59,952 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#75 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_75) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:53:59,952 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:53:59,952 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 15:53:59,952 INFO  org.apache.flink.streaming.runtime.tasks.StreamTask          [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 15:53:59,952 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#75 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_75) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:53:59,956 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:53:59,956 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:53:59,956 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:53:59,956 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:53:59,957 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Getting shared memory for RocksDB: shareScope=SLOT, managed=false
2025-10-08 15:53:59,957 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Obtained shared RocksDB cache of size 375809644 bytes
2025-10-08 15:53:59,958 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting RocksDB incremental recovery in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) target key-group range [0, 127]. Use IngestDB=false, Use AsyncCompaction=false, State Handles=[IncrementalRemoteKeyedStateHandle{privateState=[HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/a6717c6a-31e6-4b3d-a432-8ac18c1cedc4', dataBytes=640}, localPath='MANIFEST-000005'}, HandleAndLocalPath{handle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/e0f7a243-b502-4648-ae11-0ac53f59199f', dataBytes=16}, localPath='CURRENT'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/d2f3be11-6d96-47a1-b820-3ba1a09130e1, d2f3be11-6d96-47a1-b820-3ba1a09130e1 [21296 bytes], localPath='OPTIONS-000013'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/8e79a020-cf34-4684-b545-09909d0cf64c, 8e79a020-cf34-4684-b545-09909d0cf64c [40370 bytes], localPath='000015.sst'}, HandleAndLocalPath{handle=RelativeFileStateHandle State: file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/bc45405f-6af6-4e07-a0bf-20fc354742f0, bc45405f-6af6-4e07-a0bf-20fc354742f0 [137068 bytes], localPath='000014.sst'}], persistedSizeOfThisCheckpoint=200987, registered=false} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=0cf732d9-c890-439d-a0f5-8c776ff22ef6}]
2025-10-08 15:53:59,958 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Start downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:53:59,960 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:53:59,960 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:53:59,961 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Finished downloading remote state to local directory in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) for target key-group range [0, 127].
2025-10-08 15:53:59,961 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle size is configured to 1000.
2025-10-08 15:53:59,961 INFO  org.apache.flink.streaming.api.operators.AbstractStreamOperator [] - The maximum bundle time is configured to 1000 milliseconds.
2025-10-08 15:53:59,961 INFO  org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation [] - Starting opening base RocksDB instance in operator ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) with target key-group range [0, 127] from state handle IncrementalLocalKeyedStateHandle{directoryStateHandle=DirectoryStateHandle{directory='/tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_abd1dd43-1fca-49c4-8dae-f6f03a305524/4d7b1b30-117e-4499-b2a0-7be80f695ca3', directorySize=200987}} AbstractIncrementalStateHandle{checkpointId=2, backendIdentifier=c15a4101-4d99-443e-b66a-430794528ae1, keyGroupRange=KeyGroupRange{startKeyGroup=0, endKeyGroup=127}, sharedState=[], metaStateHandle=ByteStreamStateHandle{handleName='file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02/4b1b95ef-f3f1-4424-9a44-f148c27d1135', dataBytes=1597}, stateHandleId=a6b8768e-aad6-44cb-aba2-1cb5ca2bb0e3}.
2025-10-08 15:53:59,961 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 15:53:59,962 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 15:53:59,962 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - PYTHONPATH of python worker: null
2025-10-08 15:53:59,962 INFO  org.apache.flink.python.env.AbstractPythonEnvironmentManager [] - Python interpreter path: /app/.venv/bin/python
2025-10-08 15:53:59,974 WARN  org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Failed to build RocksDB state backend
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_abd1dd43-1fca-49c4-8dae-f6f03a305524/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_abd1dd43-1fca-49c4-8dae-f6f03a305524/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:54:00,095 INFO  org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner [] - Obtained shared Python process of size 161061276 bytes
2025-10-08 15:54:00,095 INFO  org.apache.flink.state.rocksdb.RocksDBResourceContainer      [] - Cleaning up relocated RocksDB logs: /opt/flink/log.
2025-10-08 15:54:00,098 ERROR org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder [] - Caught unexpected exception.
java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_abd1dd43-1fca-49c4-8dae-f6f03a305524/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_abd1dd43-1fca-49c4-8dae-f6f03a305524/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	... 28 more
2025-10-08 15:54:00,098 WARN  org.apache.flink.streaming.api.operators.BackendRestorerProcedure [] - Exception while restoring keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from alternative (1/1), will retry while more alternatives are available.
org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_abd1dd43-1fca-49c4-8dae-f6f03a305524/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_abd1dd43-1fca-49c4-8dae-f6f03a305524/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	... 19 more
2025-10-08 15:54:00,099 WARN  org.apache.flink.runtime.taskmanager.Task                    [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1)#75 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_75) switched from INITIALIZING to FAILED with failure cause:
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_abd1dd43-1fca-49c4-8dae-f6f03a305524/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_abd1dd43-1fca-49c4-8dae-f6f03a305524/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:54:00,099 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for KEYED PROCESS -> Sink: Print to Std. Out (1/1)#75 (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_75).
2025-10-08 15:54:00,100 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state FAILED to JobManager for task KEYED PROCESS -> Sink: Print to Std. Out (1/1)#75 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_75.
2025-10-08 15:54:00,108 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Attempting to cancel task Source: Collection Source -> _stream_key_by_map_operator (1/1)#75 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_75).
2025-10-08 15:54:00,108 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#75 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_75) switched from INITIALIZING to CANCELING.
2025-10-08 15:54:00,108 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Triggering cancellation of task code Source: Collection Source -> _stream_key_by_map_operator (1/1)#75 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_75).
2025-10-08 15:54:00,114 INFO  org.apache.beam.runners.fnexecution.environment.ProcessManager [] - Process for worker 2-1 still running. Killing.
2025-10-08 15:54:00,117 WARN  org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory [] - Error cleaning up servers ServerInfo{controlServer=org.apache.beam.sdk.fn.server.GrpcFnServer@164d4f0, loggingServer=org.apache.beam.sdk.fn.server.GrpcFnServer@6c5d46c9, retrievalServer=org.apache.beam.sdk.fn.server.GrpcFnServer@7968aad4, provisioningServer=org.apache.beam.sdk.fn.server.GrpcFnServer@75252a24, dataServer=org.apache.beam.sdk.fn.server.GrpcFnServer@52c1b324, stateServer=org.apache.beam.sdk.fn.server.GrpcFnServer@542cdcbb}
java.lang.InterruptedException: null
	at java.base/java.lang.Object.wait(Native Method) ~[?:?]
	at java.base/java.lang.Object.wait(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.TimeUnit.timedWait(Unknown Source) ~[?:?]
	at org.apache.beam.vendor.grpc.v1p60p1.io.grpc.internal.ServerImpl.awaitTermination(ServerImpl.java:312) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.sdk.fn.server.GrpcFnServer.close(GrpcFnServer.java:157) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.close(DefaultJobBundleFactory.java:257) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:289) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$1.load(DefaultJobBundleFactory.java:241) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3571) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2313) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2190) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2080) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.get(LocalCache.java:4012) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4035) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5013) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.vendor.guava.v32_1_2_jre.com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5020) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory.<init>(DefaultJobBundleFactory.java:499) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory.forStage(DefaultJobBundleFactory.java:343) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.createStageBundleFactory(BeamPythonFunctionRunner.java:675) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.open(BeamPythonFunctionRunner.java:290) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.open(AbstractExternalPythonFunctionOperator.java:57) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalDataStreamPythonFunctionOperator.open(AbstractExternalDataStreamPythonFunctionOperator.java:85) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalOneInputPythonFunctionOperator.open(AbstractExternalOneInputPythonFunctionOperator.java:117) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.api.operators.python.process.ExternalPythonProcessOperator.open(ExternalPythonProcessOperator.java:64) ~[blob_p-eb2d28ac31e2c97dd63a6894758ee2d5f438b095-d0e35ce8efec4684446371bd468e58a6:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:107) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$SynchronizedStreamTaskActionExecutor.call(StreamTaskActionExecutor.java:100) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) [flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) [flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
2025-10-08 15:54:00,120 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Source: Collection Source -> _stream_key_by_map_operator (1/1)#75 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_75) switched from CANCELING to CANCELED.
2025-10-08 15:54:00,120 INFO  org.apache.flink.runtime.taskmanager.Task                    [] - Freeing task resources for Source: Collection Source -> _stream_key_by_map_operator (1/1)#75 (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_75).
2025-10-08 15:54:00,120 INFO  org.apache.flink.runtime.taskexecutor.TaskExecutor           [] - Un-registering task and sending final execution state CANCELED to JobManager for task Source: Collection Source -> _stream_key_by_map_operator (1/1)#75 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_75.
