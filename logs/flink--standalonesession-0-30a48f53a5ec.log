2025-10-08 14:45:39,010 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] - --------------------------------------------------------------------------------
2025-10-08 14:45:39,017 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -  Preconfiguration: 
2025-10-08 14:45:39,017 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] - 


RESOURCE_PARAMS extraction logs:
jvm_params: -Xmx1073741824 -Xms1073741824 -XX:MaxMetaspaceSize=268435456
dynamic_configs: -D jobmanager.memory.off-heap.size=134217728b -D jobmanager.memory.jvm-overhead.min=201326592b -D jobmanager.memory.jvm-metaspace.size=268435456b -D jobmanager.memory.heap.size=1073741824b -D jobmanager.memory.jvm-overhead.max=201326592b
logs: INFO  [] - Using standard YAML parser to load flink configuration file from /opt/flink/conf/config.yaml.
INFO  [] - Loading configuration property: blob.server.port, 6124
INFO  [] - Loading configuration property: taskmanager.memory.process.size, 1728m
INFO  [] - Loading configuration property: taskmanager.bind-host, 0.0.0.0
INFO  [] - Loading configuration property: jobmanager.execution.failover-strategy, region
INFO  [] - Loading configuration property: jobmanager.rpc.address, 30a48f53a5ec
INFO  [] - Loading configuration property: execution.checkpointing.incremental, false
INFO  [] - Loading configuration property: state.backend.rocksdb.localdir, /tmp/rocksdb
INFO  [] - Loading configuration property: execution.target, remote
INFO  [] - Loading configuration property: jobmanager.memory.process.size, 1600m
INFO  [] - Loading configuration property: jobmanager.rpc.port, 6123
INFO  [] - Loading configuration property: query.server.port, 6125
INFO  [] - Loading configuration property: rest.bind-address, 0.0.0.0
INFO  [] - Loading configuration property: jobmanager.bind-host, 0.0.0.0
INFO  [] - Loading configuration property: execution.checkpointing.savepoint-dir, file:///tmp/flink-checkpoints
INFO  [] - Loading configuration property: taskmanager.host, 127.0.0.1
INFO  [] - Loading configuration property: execution.checkpointing.externalized-checkpoint-retention, RETAIN_ON_CANCELLATION
INFO  [] - Loading configuration property: parallelism.default, 1
INFO  [] - Loading configuration property: taskmanager.numberOfTaskSlots, 1
INFO  [] - Loading configuration property: execution.checkpointing.local-backup.enabled, true
INFO  [] - Loading configuration property: rest.address, 127.0.0.1
INFO  [] - Loading configuration property: execution.checkpointing.dir, file:///tmp/flink-checkpoints
INFO  [] - Loading configuration property: env.java.opts.all, --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.text=ALL-UNNAMED --add-opens=java.base/java.time=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED
INFO  [] - Loading configuration property: state.backend.type, rocksdb
INFO  [] - The derived from fraction jvm overhead memory (160.000mb (167772162 bytes)) is less than its min value 192.000mb (201326592 bytes), min value will be used instead
INFO  [] - Final Master Memory configuration:
INFO  [] -   Total Process Memory: 1.563gb (1677721600 bytes)
INFO  [] -     Total Flink Memory: 1.125gb (1207959552 bytes)
INFO  [] -       JVM Heap:         1024.000mb (1073741824 bytes)
INFO  [] -       Off-heap:         128.000mb (134217728 bytes)
INFO  [] -     JVM Metaspace:      256.000mb (268435456 bytes)
INFO  [] -     JVM Overhead:       192.000mb (201326592 bytes)

2025-10-08 14:45:39,017 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] - --------------------------------------------------------------------------------
2025-10-08 14:45:39,027 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -  Starting StandaloneSessionClusterEntrypoint (Version: 2.1.0, Scala: 2.12, Rev:4cb6bd3, Date:2025-07-21T13:23:51+02:00)
2025-10-08 14:45:39,028 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -  OS current user: flink
2025-10-08 14:45:39,028 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -  Current Hadoop/Kerberos user: <no hadoop dependency found>
2025-10-08 14:45:39,029 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -  JVM: OpenJDK 64-Bit Server VM - Eclipse Adoptium - 17/17.0.16+8
2025-10-08 14:45:39,029 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -  Arch: amd64
2025-10-08 14:45:39,032 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -  Maximum heap size: 1024 MiBytes
2025-10-08 14:45:39,032 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -  JAVA_HOME: /opt/java/openjdk
2025-10-08 14:45:39,032 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -  No Hadoop Dependency available
2025-10-08 14:45:39,032 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -  JVM Options:
2025-10-08 14:45:39,033 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     -Xmx1073741824
2025-10-08 14:45:39,033 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     -Xms1073741824
2025-10-08 14:45:39,033 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     -XX:MaxMetaspaceSize=268435456
2025-10-08 14:45:39,033 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     -XX:+IgnoreUnrecognizedVMOptions
2025-10-08 14:45:39,033 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED
2025-10-08 14:45:39,033 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED
2025-10-08 14:45:39,033 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-opens=java.base/java.lang=ALL-UNNAMED
2025-10-08 14:45:39,033 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-opens=java.base/java.net=ALL-UNNAMED
2025-10-08 14:45:39,033 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-opens=java.base/java.io=ALL-UNNAMED
2025-10-08 14:45:39,033 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-opens=java.base/java.nio=ALL-UNNAMED
2025-10-08 14:45:39,034 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-opens=java.base/sun.nio.ch=ALL-UNNAMED
2025-10-08 14:45:39,034 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-opens=java.base/java.lang.reflect=ALL-UNNAMED
2025-10-08 14:45:39,034 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-opens=java.base/java.text=ALL-UNNAMED
2025-10-08 14:45:39,034 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-opens=java.base/java.time=ALL-UNNAMED
2025-10-08 14:45:39,034 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-opens=java.base/java.util=ALL-UNNAMED
2025-10-08 14:45:39,034 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-opens=java.base/java.util.concurrent=ALL-UNNAMED
2025-10-08 14:45:39,034 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED
2025-10-08 14:45:39,034 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED
2025-10-08 14:45:39,034 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     -Dlog.file=/opt/flink/log/flink--standalonesession-0-30a48f53a5ec.log
2025-10-08 14:45:39,034 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     -Dlog4j.configuration=file:/opt/flink/conf/log4j.properties
2025-10-08 14:45:39,037 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     -Dlog4j.configurationFile=file:/opt/flink/conf/log4j.properties
2025-10-08 14:45:39,039 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     -Dlogback.configurationFile=file:/opt/flink/conf/logback.xml
2025-10-08 14:45:39,039 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -  Program Arguments:
2025-10-08 14:45:39,041 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     -D
2025-10-08 14:45:39,041 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     jobmanager.memory.off-heap.size=134217728b
2025-10-08 14:45:39,041 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     -D
2025-10-08 14:45:39,041 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     jobmanager.memory.jvm-overhead.min=201326592b
2025-10-08 14:45:39,041 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     -D
2025-10-08 14:45:39,042 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     jobmanager.memory.jvm-metaspace.size=268435456b
2025-10-08 14:45:39,042 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     -D
2025-10-08 14:45:39,042 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     jobmanager.memory.heap.size=1073741824b
2025-10-08 14:45:39,042 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     -D
2025-10-08 14:45:39,042 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     jobmanager.memory.jvm-overhead.max=201326592b
2025-10-08 14:45:39,043 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     --configDir
2025-10-08 14:45:39,043 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -     /opt/flink/conf
2025-10-08 14:45:39,043 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] -  Classpath: /opt/flink/lib/flink-cep-2.1.0.jar:/opt/flink/lib/flink-connector-files-2.1.0.jar:/opt/flink/lib/flink-csv-2.1.0.jar:/opt/flink/lib/flink-json-2.1.0.jar:/opt/flink/lib/flink-scala_2.12-2.1.0.jar:/opt/flink/lib/flink-table-api-java-uber-2.1.0.jar:/opt/flink/lib/flink-table-planner-loader-2.1.0.jar:/opt/flink/lib/flink-table-runtime-2.1.0.jar:/opt/flink/lib/log4j-1.2-api-2.24.3.jar:/opt/flink/lib/log4j-api-2.24.3.jar:/opt/flink/lib/log4j-core-2.24.3.jar:/opt/flink/lib/log4j-layout-template-json-2.24.3.jar:/opt/flink/lib/log4j-slf4j-impl-2.24.3.jar:/opt/flink/lib/flink-dist-2.1.0.jar::::
2025-10-08 14:45:39,043 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] - --------------------------------------------------------------------------------
2025-10-08 14:45:39,049 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] - Registered UNIX signal handlers for [TERM, HUP, INT]
2025-10-08 14:45:39,074 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Using standard YAML parser to load flink configuration file from /opt/flink/conf/config.yaml.
2025-10-08 14:45:39,200 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: blob.server.port, 6124
2025-10-08 14:45:39,201 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.memory.process.size, 1728m
2025-10-08 14:45:39,201 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.bind-host, 0.0.0.0
2025-10-08 14:45:39,202 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.execution.failover-strategy, region
2025-10-08 14:45:39,206 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.address, 30a48f53a5ec
2025-10-08 14:45:39,207 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.incremental, false
2025-10-08 14:45:39,208 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.rocksdb.localdir, /tmp/rocksdb
2025-10-08 14:45:39,208 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.target, remote
2025-10-08 14:45:39,209 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.memory.process.size, 1600m
2025-10-08 14:45:39,210 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.rpc.port, 6123
2025-10-08 14:45:39,210 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: query.server.port, 6125
2025-10-08 14:45:39,210 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.bind-address, 0.0.0.0
2025-10-08 14:45:39,211 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: jobmanager.bind-host, 0.0.0.0
2025-10-08 14:45:39,212 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.savepoint-dir, file:///tmp/flink-checkpoints
2025-10-08 14:45:39,212 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.host, 127.0.0.1
2025-10-08 14:45:39,212 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.externalized-checkpoint-retention, RETAIN_ON_CANCELLATION
2025-10-08 14:45:39,213 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: parallelism.default, 1
2025-10-08 14:45:39,213 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: taskmanager.numberOfTaskSlots, 1
2025-10-08 14:45:39,215 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.local-backup.enabled, true
2025-10-08 14:45:39,215 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: rest.address, 127.0.0.1
2025-10-08 14:45:39,215 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: execution.checkpointing.dir, file:///tmp/flink-checkpoints
2025-10-08 14:45:39,215 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: env.java.opts.all, --add-exports=java.rmi/sun.rmi.registry=ALL-UNNAMED --add-exports=java.security.jgss/sun.security.krb5=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.text=ALL-UNNAMED --add-opens=java.base/java.time=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED
2025-10-08 14:45:39,215 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading configuration property: state.backend.type, rocksdb
2025-10-08 14:45:39,216 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading dynamic configuration property: jobmanager.memory.off-heap.size, 134217728b
2025-10-08 14:45:39,217 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading dynamic configuration property: jobmanager.memory.jvm-overhead.min, 201326592b
2025-10-08 14:45:39,218 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading dynamic configuration property: jobmanager.memory.jvm-metaspace.size, 268435456b
2025-10-08 14:45:39,218 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading dynamic configuration property: jobmanager.memory.heap.size, 1073741824b
2025-10-08 14:45:39,218 INFO  org.apache.flink.configuration.GlobalConfiguration           [] - Loading dynamic configuration property: jobmanager.memory.jvm-overhead.max, 201326592b
2025-10-08 14:45:39,307 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] - Starting StandaloneSessionClusterEntrypoint.
2025-10-08 14:45:39,383 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] - Install default filesystem.
2025-10-08 14:45:39,391 INFO  org.apache.flink.core.fs.FileSystem                          [] - Hadoop is not in the classpath/dependencies. The extended set of supported File Systems via Hadoop is not available.
2025-10-08 14:45:39,428 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-statsd
2025-10-08 14:45:39,433 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-jmx
2025-10-08 14:45:39,433 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-prometheus
2025-10-08 14:45:39,434 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-influx
2025-10-08 14:45:39,434 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-slf4j
2025-10-08 14:45:39,434 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-otel
2025-10-08 14:45:39,434 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-datadog
2025-10-08 14:45:39,434 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: metrics-graphite
2025-10-08 14:45:39,434 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID not found, creating it: external-resource-gpu
2025-10-08 14:45:39,538 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] - Install security context.
2025-10-08 14:45:39,580 INFO  org.apache.flink.runtime.security.modules.HadoopModuleFactory [] - Cannot create Hadoop Security Module because Hadoop cannot be found in the Classpath.
2025-10-08 14:45:39,599 INFO  org.apache.flink.runtime.security.modules.JaasModule         [] - Jaas file will be created as /tmp/jaas-2741315108922303663.conf.
2025-10-08 14:45:39,613 INFO  org.apache.flink.runtime.security.contexts.HadoopSecurityContextFactory [] - Cannot install HadoopSecurityContext because Hadoop cannot be found in the Classpath.
2025-10-08 14:45:39,626 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] - Initializing cluster services.
2025-10-08 14:45:39,641 INFO  org.apache.flink.runtime.entrypoint.ClusterEntrypoint        [] - Using working directory: WorkingDirectory(/tmp/jm_34d627a4f5e60a5465c17b3ab9053ff5).
2025-10-08 14:45:40,392 INFO  org.apache.flink.runtime.rpc.pekko.PekkoRpcServiceUtils      [] - Trying to start actor system, external address 30a48f53a5ec:6123, bind address 0.0.0.0:6123.
2025-10-08 14:45:41,472 INFO  org.apache.pekko.event.slf4j.Slf4jLogger                     [] - Slf4jLogger started
2025-10-08 14:45:41,576 INFO  org.apache.pekko.remote.RemoteActorRefProvider               [] - Pekko Cluster not in use - enabling unsafe features anyway because `pekko.remote.use-unsafe-remote-features-outside-cluster` has been enabled.
2025-10-08 14:45:41,584 INFO  org.apache.pekko.remote.Remoting                             [] - Starting remoting
2025-10-08 14:45:42,308 INFO  org.apache.pekko.remote.Remoting                             [] - Remoting started; listening on addresses :[pekko.tcp://flink@30a48f53a5ec:6123]
2025-10-08 14:45:42,497 INFO  org.apache.flink.runtime.rpc.pekko.PekkoRpcServiceUtils      [] - Actor system started at pekko.tcp://flink@30a48f53a5ec:6123
2025-10-08 14:45:42,548 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager [] - Loading delegation token providers
2025-10-08 14:45:42,554 INFO  org.apache.flink.runtime.security.token.hadoop.HadoopFSDelegationTokenProvider [] - Hadoop FS is not available (not packaged with this application): NoClassDefFoundError : "org/apache/hadoop/conf/Configuration".
2025-10-08 14:45:42,554 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager [] - Delegation token provider hadoopfs loaded and initialized
2025-10-08 14:45:42,558 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager [] - Delegation token provider hbase loaded and initialized
2025-10-08 14:45:42,559 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-statsd
2025-10-08 14:45:42,559 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-jmx
2025-10-08 14:45:42,560 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-prometheus
2025-10-08 14:45:42,560 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-influx
2025-10-08 14:45:42,563 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-slf4j
2025-10-08 14:45:42,563 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-otel
2025-10-08 14:45:42,563 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-datadog
2025-10-08 14:45:42,563 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-graphite
2025-10-08 14:45:42,563 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: external-resource-gpu
2025-10-08 14:45:42,564 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager [] - Delegation token providers loaded successfully
2025-10-08 14:45:42,565 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository [] - Loading delegation token receivers
2025-10-08 14:45:42,569 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository [] - Delegation token receiver hadoopfs loaded and initialized
2025-10-08 14:45:42,570 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository [] - Delegation token receiver hbase loaded and initialized
2025-10-08 14:45:42,572 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-statsd
2025-10-08 14:45:42,572 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-jmx
2025-10-08 14:45:42,573 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-prometheus
2025-10-08 14:45:42,573 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-influx
2025-10-08 14:45:42,573 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-slf4j
2025-10-08 14:45:42,573 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-otel
2025-10-08 14:45:42,573 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-datadog
2025-10-08 14:45:42,575 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: metrics-graphite
2025-10-08 14:45:42,575 INFO  org.apache.flink.core.plugin.DefaultPluginManager            [] - Plugin loader with ID found, reusing it: external-resource-gpu
2025-10-08 14:45:42,576 INFO  org.apache.flink.runtime.security.token.DelegationTokenReceiverRepository [] - Delegation token receivers loaded successfully
2025-10-08 14:45:42,578 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager [] - Checking provider and receiver instances consistency
2025-10-08 14:45:42,578 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager [] - Provider and receiver instances are consistent
2025-10-08 14:45:42,579 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager [] - Obtaining delegation tokens
2025-10-08 14:45:42,583 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager [] - Delegation tokens obtained successfully
2025-10-08 14:45:42,585 WARN  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager [] - No tokens obtained so skipping notifications
2025-10-08 14:45:42,628 INFO  org.apache.flink.runtime.blob.BlobServer                     [] - Created BLOB server storage directory /tmp/jm_34d627a4f5e60a5465c17b3ab9053ff5/blobStorage
2025-10-08 14:45:42,642 INFO  org.apache.flink.runtime.blob.BlobServer                     [] - Started BLOB server at 0.0.0.0:6124 - max concurrent requests: 50 - max backlog: 1000
2025-10-08 14:45:42,708 INFO  org.apache.flink.runtime.metrics.MetricRegistryImpl          [] - No metrics reporter configured, no metrics will be exposed/reported.
2025-10-08 14:45:42,709 INFO  org.apache.flink.runtime.metrics.MetricRegistryImpl          [] - No trace reporter configured, no traces will be exposed/reported.
2025-10-08 14:45:42,710 INFO  org.apache.flink.runtime.metrics.MetricRegistryImpl          [] - No event reporter configured, no events will be exposed/reported.
2025-10-08 14:45:42,721 INFO  org.apache.flink.runtime.rpc.pekko.PekkoRpcServiceUtils      [] - Trying to start actor system, external address 30a48f53a5ec:0, bind address 0.0.0.0:0.
2025-10-08 14:45:42,765 INFO  org.apache.pekko.event.slf4j.Slf4jLogger                     [] - Slf4jLogger started
2025-10-08 14:45:42,781 INFO  org.apache.pekko.remote.RemoteActorRefProvider               [] - Pekko Cluster not in use - enabling unsafe features anyway because `pekko.remote.use-unsafe-remote-features-outside-cluster` has been enabled.
2025-10-08 14:45:42,781 INFO  org.apache.pekko.remote.Remoting                             [] - Starting remoting
2025-10-08 14:45:42,798 INFO  org.apache.pekko.remote.Remoting                             [] - Remoting started; listening on addresses :[pekko.tcp://flink-metrics@30a48f53a5ec:40131]
2025-10-08 14:45:42,815 INFO  org.apache.flink.runtime.rpc.pekko.PekkoRpcServiceUtils      [] - Actor system started at pekko.tcp://flink-metrics@30a48f53a5ec:40131
2025-10-08 14:45:42,841 INFO  org.apache.flink.runtime.rpc.pekko.PekkoRpcService           [] - Starting RPC endpoint for org.apache.flink.runtime.metrics.dump.MetricQueryService at pekko://flink-metrics/user/rpc/MetricQueryService .
2025-10-08 14:45:43,133 INFO  org.apache.flink.runtime.dispatcher.FileExecutionGraphInfoStore [] - Initializing FileExecutionGraphInfoStore: Storage directory /tmp/executionGraphStore-7206d8c1-d8e6-4043-8b19-da7b3c202473, expiration time 3600000, maximum cache size 52428800 bytes.
2025-10-08 14:45:43,306 INFO  org.apache.flink.runtime.dispatcher.DispatcherRestEndpoint   [] - Upload directory /tmp/flink-web-2cf4f517-cc34-494a-8891-f7c77989a0f3/flink-web-upload does not exist. 
2025-10-08 14:45:43,309 INFO  org.apache.flink.runtime.dispatcher.DispatcherRestEndpoint   [] - Created directory /tmp/flink-web-2cf4f517-cc34-494a-8891-f7c77989a0f3/flink-web-upload for file uploads.
2025-10-08 14:45:43,312 INFO  org.apache.flink.runtime.dispatcher.DispatcherRestEndpoint   [] - Starting rest endpoint.
2025-10-08 14:45:44,138 INFO  org.apache.flink.runtime.webmonitor.WebMonitorUtils          [] - Determined location of main cluster component log file: /opt/flink/log/flink--standalonesession-0-30a48f53a5ec.log
2025-10-08 14:45:44,139 INFO  org.apache.flink.runtime.webmonitor.WebMonitorUtils          [] - Determined location of main cluster component stdout file: /opt/flink/log/flink--standalonesession-0-30a48f53a5ec.out
2025-10-08 14:45:44,201 INFO  org.apache.flink.runtime.dispatcher.DispatcherRestEndpoint   [] - Rest endpoint listening at 127.0.0.1:8081
2025-10-08 14:45:44,205 INFO  org.apache.flink.runtime.dispatcher.DispatcherRestEndpoint   [] - http://127.0.0.1:8081 was granted leadership with leaderSessionID=00000000-0000-0000-0000-000000000000
2025-10-08 14:45:44,206 INFO  org.apache.flink.runtime.dispatcher.DispatcherRestEndpoint   [] - Web frontend listening at http://127.0.0.1:8081.
2025-10-08 14:45:44,292 INFO  org.apache.flink.runtime.dispatcher.runner.DefaultDispatcherRunner [] - DefaultDispatcherRunner was granted leadership with leader id 00000000-0000-0000-0000-000000000000. Creating new DispatcherLeaderProcess.
2025-10-08 14:45:44,325 INFO  org.apache.flink.runtime.dispatcher.runner.SessionDispatcherLeaderProcess [] - Start SessionDispatcherLeaderProcess.
2025-10-08 14:45:44,332 INFO  org.apache.flink.runtime.resourcemanager.ResourceManagerServiceImpl [] - Starting resource manager service.
2025-10-08 14:45:44,350 INFO  org.apache.flink.runtime.resourcemanager.ResourceManagerServiceImpl [] - Resource manager service is granted leadership with session id 00000000-0000-0000-0000-000000000000.
2025-10-08 14:45:44,362 INFO  org.apache.flink.runtime.dispatcher.runner.SessionDispatcherLeaderProcess [] - Recover all persisted job graphs that are not finished, yet.
2025-10-08 14:45:44,363 INFO  org.apache.flink.runtime.dispatcher.runner.SessionDispatcherLeaderProcess [] - Successfully recovered 0 persisted job graphs.
2025-10-08 14:45:44,458 INFO  org.apache.flink.runtime.rpc.pekko.PekkoRpcService           [] - Starting RPC endpoint for org.apache.flink.runtime.dispatcher.StandaloneDispatcher at pekko://flink/user/rpc/dispatcher_0 .
2025-10-08 14:45:44,472 INFO  org.apache.flink.runtime.rpc.pekko.PekkoRpcService           [] - Starting RPC endpoint for org.apache.flink.runtime.resourcemanager.StandaloneResourceManager at pekko://flink/user/rpc/resourcemanager_1 .
2025-10-08 14:45:44,553 INFO  org.apache.flink.runtime.resourcemanager.StandaloneResourceManager [] - Starting the resource manager.
2025-10-08 14:45:44,563 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Starting the slot manager.
2025-10-08 14:45:44,567 INFO  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager [] - Starting tokens update task
2025-10-08 14:45:44,567 WARN  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager [] - No tokens obtained so skipping notifications
2025-10-08 14:45:44,568 WARN  org.apache.flink.runtime.security.token.DefaultDelegationTokenManager [] - Tokens update task not started because either no tokens obtained or none of the tokens specified its renewal date
2025-10-08 14:45:47,267 INFO  org.apache.flink.runtime.resourcemanager.StandaloneResourceManager [] - Registering TaskManager with ResourceID 127.0.0.1:40677-478ca6 (pekko.tcp://flink@127.0.0.1:40677/user/rpc/taskmanager_0) at ResourceManager
2025-10-08 14:45:47,301 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Registering task executor 127.0.0.1:40677-478ca6 under 666a079c3472ae0ea499041ede13f731 at the slot manager.
2025-10-08 14:45:57,059 INFO  org.apache.flink.runtime.dispatcher.StandaloneDispatcher     [] - Received job submission 'Word Counter' (2b5fabbad444862e5918f0332145adc7).
2025-10-08 14:45:57,060 INFO  org.apache.flink.runtime.dispatcher.StandaloneDispatcher     [] - Submitting job 'Word Counter' (2b5fabbad444862e5918f0332145adc7).
2025-10-08 14:45:57,243 INFO  org.apache.flink.runtime.jobmaster.JobMasterServiceLeadershipRunner [] - JobMasterServiceLeadershipRunner for job 2b5fabbad444862e5918f0332145adc7 was granted leadership with leader id 00000000-0000-0000-0000-000000000000. Creating new JobMasterServiceProcess.
2025-10-08 14:45:57,270 INFO  org.apache.flink.runtime.rpc.pekko.PekkoRpcService           [] - Starting RPC endpoint for org.apache.flink.runtime.jobmaster.JobMaster at pekko://flink/user/rpc/jobmanager_2 .
2025-10-08 14:45:57,298 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Initializing job 'Word Counter' (2b5fabbad444862e5918f0332145adc7).
2025-10-08 14:45:57,502 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Using restart back off time strategy ExponentialDelayRestartBackoffTimeStrategy(initialBackoffMS=1000, maxBackoffMS=60000, backoffMultiplier=1.5, resetBackoffThresholdMS=3600000, jitterFactor=0.1, attemptsBeforeResetBackoff=2147483647, currentRestartAttempt=0, nextRestartTimestamp=-2147483648) for Word Counter (2b5fabbad444862e5918f0332145adc7).
2025-10-08 14:45:57,669 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Created execution graph 32912868e26d743ffbf07beb6b9227e8 for job 2b5fabbad444862e5918f0332145adc7.
2025-10-08 14:45:57,687 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Running initialization on master for job Word Counter (2b5fabbad444862e5918f0332145adc7).
2025-10-08 14:45:57,691 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Successfully ran initialization on master in 3 ms.
2025-10-08 14:45:57,712 INFO  org.apache.flink.runtime.scheduler.adapter.DefaultExecutionTopology [] - Built 1 new pipelined regions in 0 ms, total 1 pipelined regions currently.
2025-10-08 14:45:57,715 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:45:57,757 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:45:57,763 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:45:57,767 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:45:57,781 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No checkpoint found during restore.
2025-10-08 14:45:57,786 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Using failover strategy org.apache.flink.runtime.executiongraph.failover.RestartPipelinedRegionFailoverStrategy@f71a319 for Word Counter (2b5fabbad444862e5918f0332145adc7).
2025-10-08 14:45:57,799 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Starting execution of job 'Word Counter' (2b5fabbad444862e5918f0332145adc7) under job master id 00000000000000000000000000000000.
2025-10-08 14:45:57,803 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Starting scheduling with scheduling strategy [org.apache.flink.runtime.scheduler.strategy.PipelinedRegionSchedulingStrategy]
2025-10-08 14:45:57,803 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (2b5fabbad444862e5918f0332145adc7) switched from state CREATED to RUNNING.
2025-10-08 14:45:57,807 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (32912868e26d743ffbf07beb6b9227e8_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from CREATED to SCHEDULED.
2025-10-08 14:45:57,808 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (32912868e26d743ffbf07beb6b9227e8_90bea66de1c231edf33913ecd54406c1_0_0) switched from CREATED to SCHEDULED.
2025-10-08 14:45:57,825 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Connecting to ResourceManager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/resourcemanager_*(00000000000000000000000000000000)
2025-10-08 14:45:57,831 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Resolved ResourceManager address, beginning registration
2025-10-08 14:45:57,836 INFO  org.apache.flink.runtime.resourcemanager.StandaloneResourceManager [] - Registering job manager 00000000000000000000000000000000@pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_2 for job 2b5fabbad444862e5918f0332145adc7.
2025-10-08 14:45:57,844 INFO  org.apache.flink.runtime.resourcemanager.StandaloneResourceManager [] - Registered job manager 00000000000000000000000000000000@pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_2 for job 2b5fabbad444862e5918f0332145adc7.
2025-10-08 14:45:57,845 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - JobManager successfully registered at ResourceManager, leader id: 00000000000000000000000000000000.
2025-10-08 14:45:57,847 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job 2b5fabbad444862e5918f0332145adc7: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 14:45:57,920 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Matching resource requirements against available resources.
Missing resources:
	 Job 2b5fabbad444862e5918f0332145adc7
		ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}
Current resources:
	TaskManager 127.0.0.1:40677-478ca6
		Available: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
		Total:     ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
2025-10-08 14:45:57,927 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Starting allocation of slot f38a3947ef434081c608ed9fc61997cc from 127.0.0.1:40677-478ca6 for job 2b5fabbad444862e5918f0332145adc7 with resource profile ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 14:45:58,115 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (32912868e26d743ffbf07beb6b9227e8_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:45:58,116 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #0) with attempt id 32912868e26d743ffbf07beb6b9227e8_cbc357ccb763df2852fee8c4fc7d55f2_0_0 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id f38a3947ef434081c608ed9fc61997cc
2025-10-08 14:45:58,127 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (32912868e26d743ffbf07beb6b9227e8_90bea66de1c231edf33913ecd54406c1_0_0) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:45:58,127 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #0) with attempt id 32912868e26d743ffbf07beb6b9227e8_90bea66de1c231edf33913ecd54406c1_0_0 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id f38a3947ef434081c608ed9fc61997cc
2025-10-08 14:45:58,685 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job 2b5fabbad444862e5918f0332145adc7 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job 2b5fabbad444862e5918f0332145adc7 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 14:45:58,857 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (32912868e26d743ffbf07beb6b9227e8_90bea66de1c231edf33913ecd54406c1_0_0) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:45:58,860 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (32912868e26d743ffbf07beb6b9227e8_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:45:59,681 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job 2b5fabbad444862e5918f0332145adc7 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job 2b5fabbad444862e5918f0332145adc7 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 14:46:00,679 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job 2b5fabbad444862e5918f0332145adc7 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job 2b5fabbad444862e5918f0332145adc7 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 14:46:01,672 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job 2b5fabbad444862e5918f0332145adc7 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job 2b5fabbad444862e5918f0332145adc7 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 14:46:02,680 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job 2b5fabbad444862e5918f0332145adc7 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job 2b5fabbad444862e5918f0332145adc7 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 14:46:03,671 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job 2b5fabbad444862e5918f0332145adc7 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job 2b5fabbad444862e5918f0332145adc7 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 14:46:04,669 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job 2b5fabbad444862e5918f0332145adc7 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job 2b5fabbad444862e5918f0332145adc7 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 14:46:05,670 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job 2b5fabbad444862e5918f0332145adc7 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job 2b5fabbad444862e5918f0332145adc7 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 14:46:06,668 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job 2b5fabbad444862e5918f0332145adc7 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job 2b5fabbad444862e5918f0332145adc7 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 14:46:07,668 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job 2b5fabbad444862e5918f0332145adc7 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job 2b5fabbad444862e5918f0332145adc7 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 14:46:08,670 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job 2b5fabbad444862e5918f0332145adc7 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job 2b5fabbad444862e5918f0332145adc7 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 14:46:08,809 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (32912868e26d743ffbf07beb6b9227e8_90bea66de1c231edf33913ecd54406c1_0_0) switched from INITIALIZING to RUNNING.
2025-10-08 14:46:08,815 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (32912868e26d743ffbf07beb6b9227e8_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from INITIALIZING to RUNNING.
2025-10-08 14:46:09,682 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Triggering checkpoint 1 (type=CheckpointType{name='Checkpoint', sharingFilesStrategy=FORWARD_BACKWARD}) @ 1759934769667 for job 2b5fabbad444862e5918f0332145adc7.
2025-10-08 14:46:19,044 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Triggering savepoint for job 2b5fabbad444862e5918f0332145adc7.
2025-10-08 14:46:19,054 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Triggering checkpoint 2 (type=SavepointType{name='Savepoint', postCheckpointAction=NONE, formatType=NATIVE}) @ 1759934779049 for job 2b5fabbad444862e5918f0332145adc7.
2025-10-08 14:46:29,179 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Completed checkpoint 1 for job 2b5fabbad444862e5918f0332145adc7 (160449 bytes, checkpointDuration=19506 ms, finalizationTime=6 ms).
2025-10-08 14:46:32,560 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Completed checkpoint 2 for job 2b5fabbad444862e5918f0332145adc7 (200987 bytes, checkpointDuration=13510 ms, finalizationTime=1 ms).
2025-10-08 14:46:32,563 INFO  org.apache.flink.runtime.checkpoint.CheckpointRequestDecider [] - checkpoint request time in queue: 21896
2025-10-08 14:46:32,565 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Triggering checkpoint 3 (type=CheckpointType{name='Checkpoint', sharingFilesStrategy=FORWARD_BACKWARD}) @ 1759934792563 for job 2b5fabbad444862e5918f0332145adc7.
2025-10-08 14:46:47,908 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Triggering a manual checkpoint for job 2b5fabbad444862e5918f0332145adc7.
2025-10-08 14:46:48,051 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Completed checkpoint 3 for job 2b5fabbad444862e5918f0332145adc7 (296648 bytes, checkpointDuration=15470 ms, finalizationTime=18 ms).
2025-10-08 14:46:48,061 INFO  org.apache.flink.runtime.checkpoint.CheckpointRequestDecider [] - checkpoint request time in queue: 150
2025-10-08 14:46:48,078 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Triggering checkpoint 4 (type=CheckpointType{name='Checkpoint', sharingFilesStrategy=FORWARD_BACKWARD}) @ 1759934808061 for job 2b5fabbad444862e5918f0332145adc7.
2025-10-08 14:46:48,231 INFO  org.apache.flink.runtime.dispatcher.StandaloneDispatcher     [] - Received job submission 'Word Counter' (d1f164921ad7c2fe36d4e92a16bdba98).
2025-10-08 14:46:48,231 INFO  org.apache.flink.runtime.dispatcher.StandaloneDispatcher     [] - Submitting job 'Word Counter' (d1f164921ad7c2fe36d4e92a16bdba98).
2025-10-08 14:46:48,313 INFO  org.apache.flink.runtime.jobmaster.JobMasterServiceLeadershipRunner [] - JobMasterServiceLeadershipRunner for job d1f164921ad7c2fe36d4e92a16bdba98 was granted leadership with leader id 00000000-0000-0000-0000-000000000000. Creating new JobMasterServiceProcess.
2025-10-08 14:46:48,319 INFO  org.apache.flink.runtime.rpc.pekko.PekkoRpcService           [] - Starting RPC endpoint for org.apache.flink.runtime.jobmaster.JobMaster at pekko://flink/user/rpc/jobmanager_3 .
2025-10-08 14:46:48,323 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Initializing job 'Word Counter' (d1f164921ad7c2fe36d4e92a16bdba98).
2025-10-08 14:46:48,354 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Using restart back off time strategy ExponentialDelayRestartBackoffTimeStrategy(initialBackoffMS=1000, maxBackoffMS=60000, backoffMultiplier=1.5, resetBackoffThresholdMS=3600000, jitterFactor=0.1, attemptsBeforeResetBackoff=2147483647, currentRestartAttempt=0, nextRestartTimestamp=-2147483648) for Word Counter (d1f164921ad7c2fe36d4e92a16bdba98).
2025-10-08 14:46:48,355 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Created execution graph 4f6c95e62390c2fe92d0908a466c687a for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 14:46:48,357 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Running initialization on master for job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98).
2025-10-08 14:46:48,360 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Successfully ran initialization on master in 3 ms.
2025-10-08 14:46:48,364 INFO  org.apache.flink.runtime.scheduler.adapter.DefaultExecutionTopology [] - Built 1 new pipelined regions in 0 ms, total 1 pipelined regions currently.
2025-10-08 14:46:48,365 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Loading state backend via factory org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackendFactory
2025-10-08 14:46:48,365 INFO  org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend   [] - Using predefined options: DEFAULT.
2025-10-08 14:46:48,366 INFO  org.apache.flink.runtime.state.StateBackendLoader            [] - State backend loader loads the state backend as EmbeddedRocksDBStateBackend
2025-10-08 14:46:48,366 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Checkpoint storage is set to 'filesystem': (checkpoints "file:/tmp/flink-checkpoints")
2025-10-08 14:46:48,449 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No checkpoint found during restore.
2025-10-08 14:46:48,449 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Starting job d1f164921ad7c2fe36d4e92a16bdba98 from savepoint /tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02 ()
2025-10-08 14:46:48,500 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (32912868e26d743ffbf07beb6b9227e8_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from RUNNING to FINISHED.
2025-10-08 14:46:48,503 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Reset the checkpoint ID of job d1f164921ad7c2fe36d4e92a16bdba98 to 3.
2025-10-08 14:46:48,514 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 14:46:48,549 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Completed checkpoint 4 for job 2b5fabbad444862e5918f0332145adc7 (296648 bytes, checkpointDuration=486 ms, finalizationTime=2 ms).
2025-10-08 14:46:48,551 INFO  org.apache.flink.runtime.checkpoint.CheckpointRequestDecider [] - checkpoint request time in queue: 36882
2025-10-08 14:46:48,555 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Triggering checkpoint 5 (type=CheckpointType{name='Checkpoint', sharingFilesStrategy=FORWARD_BACKWARD}) @ 1759934808552 for job 2b5fabbad444862e5918f0332145adc7.
2025-10-08 14:46:48,606 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 14:46:48,606 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Using failover strategy org.apache.flink.runtime.executiongraph.failover.RestartPipelinedRegionFailoverStrategy@574738f5 for Word Counter (d1f164921ad7c2fe36d4e92a16bdba98).
2025-10-08 14:46:48,611 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Starting execution of job 'Word Counter' (d1f164921ad7c2fe36d4e92a16bdba98) under job master id 00000000000000000000000000000000.
2025-10-08 14:46:48,615 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Starting scheduling with scheduling strategy [org.apache.flink.runtime.scheduler.strategy.PipelinedRegionSchedulingStrategy]
2025-10-08 14:46:48,616 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state CREATED to RUNNING.
2025-10-08 14:46:48,619 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from CREATED to SCHEDULED.
2025-10-08 14:46:48,621 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_0) switched from CREATED to SCHEDULED.
2025-10-08 14:46:48,626 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Connecting to ResourceManager pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/resourcemanager_*(00000000000000000000000000000000)
2025-10-08 14:46:48,629 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Resolved ResourceManager address, beginning registration
2025-10-08 14:46:48,629 INFO  org.apache.flink.runtime.resourcemanager.StandaloneResourceManager [] - Registering job manager 00000000000000000000000000000000@pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 14:46:48,634 INFO  org.apache.flink.runtime.resourcemanager.StandaloneResourceManager [] - Registered job manager 00000000000000000000000000000000@pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_3 for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 14:46:48,644 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - JobManager successfully registered at ResourceManager, leader id: 00000000000000000000000000000000.
2025-10-08 14:46:48,647 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 14:46:48,783 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Matching resource requirements against available resources.
Missing resources:
	 Job d1f164921ad7c2fe36d4e92a16bdba98
		ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}
Current resources:
	TaskManager 127.0.0.1:40677-478ca6
		Available: ResourceProfile{cpuCores=0, taskHeapMemory=0 bytes, taskOffHeapMemory=0 bytes, managedMemory=0 bytes, networkMemory=0 bytes}
		Total:     ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
2025-10-08 14:46:48,785 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (32912868e26d743ffbf07beb6b9227e8_90bea66de1c231edf33913ecd54406c1_0_0) switched from RUNNING to FINISHED.
2025-10-08 14:46:48,634 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Decline checkpoint 5 by task 32912868e26d743ffbf07beb6b9227e8_90bea66de1c231edf33913ecd54406c1_0_0 of job 2b5fabbad444862e5918f0332145adc7 at 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
org.apache.flink.util.SerializedThrowable: org.apache.flink.runtime.checkpoint.CheckpointException: Task name with subtask : KEYED PROCESS -> Sink: Print to Std. Out (1/1)#0 Failure reason: Checkpoint was declined (task is closing)
	at org.apache.flink.runtime.taskmanager.Task.declineCheckpoint(Task.java:1425) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.declineCheckpoint(Task.java:1418) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.triggerCheckpointBarrier(Task.java:1384) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskexecutor.TaskExecutor.triggerCheckpoint(TaskExecutor.java:1097) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) ~[?:?]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) ~[?:?]
	at java.base/java.lang.reflect.Method.invoke(Unknown Source) ~[?:?]
	at org.apache.flink.runtime.rpc.pekko.PekkoRpcActor.lambda$handleRpcInvocation$1(PekkoRpcActor.java:318) ~[?:?]
	at org.apache.flink.runtime.concurrent.ClassLoadingUtils.runWithContextClassLoader(ClassLoadingUtils.java:83) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.rpc.pekko.PekkoRpcActor.handleRpcInvocation(PekkoRpcActor.java:316) ~[?:?]
	at org.apache.flink.runtime.rpc.pekko.PekkoRpcActor.handleRpcMessage(PekkoRpcActor.java:229) ~[?:?]
	at org.apache.flink.runtime.rpc.pekko.PekkoRpcActor.handleMessage(PekkoRpcActor.java:174) ~[?:?]
	at org.apache.pekko.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:33) ~[?:?]
	at org.apache.pekko.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:29) ~[?:?]
	at scala.PartialFunction.applyOrElse(PartialFunction.scala:127) ~[flink-scala_2.12-2.1.0.jar:2.1.0]
	at scala.PartialFunction.applyOrElse$(PartialFunction.scala:126) ~[flink-scala_2.12-2.1.0.jar:2.1.0]
	at org.apache.pekko.japi.pf.UnitCaseStatement.applyOrElse(CaseStatements.scala:29) ~[?:?]
	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:175) ~[flink-scala_2.12-2.1.0.jar:2.1.0]
	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:176) ~[flink-scala_2.12-2.1.0.jar:2.1.0]
	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:176) ~[flink-scala_2.12-2.1.0.jar:2.1.0]
	at org.apache.pekko.actor.Actor.aroundReceive(Actor.scala:547) ~[?:?]
	at org.apache.pekko.actor.Actor.aroundReceive$(Actor.scala:545) ~[?:?]
	at org.apache.pekko.actor.AbstractActor.aroundReceive(AbstractActor.scala:229) ~[?:?]
	at org.apache.pekko.actor.ActorCell.receiveMessage(ActorCell.scala:590) ~[?:?]
	at org.apache.pekko.actor.ActorCell.invoke(ActorCell.scala:557) ~[?:?]
	at org.apache.pekko.dispatch.Mailbox.processMailbox(Mailbox.scala:272) ~[?:?]
	at org.apache.pekko.dispatch.Mailbox.run(Mailbox.scala:233) ~[?:?]
	at org.apache.pekko.dispatch.Mailbox.exec(Mailbox.scala:245) ~[?:?]
	at java.base/java.util.concurrent.ForkJoinTask.doExec(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.ForkJoinPool.scan(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.ForkJoinPool.runWorker(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.ForkJoinWorkerThread.run(Unknown Source) ~[?:?]
2025-10-08 14:46:48,804 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (2b5fabbad444862e5918f0332145adc7) switched from state RUNNING to FINISHED.
2025-10-08 14:46:48,799 WARN  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger or complete checkpoint 5 for job 2b5fabbad444862e5918f0332145adc7. (0 consecutive failed attempts so far)
org.apache.flink.runtime.checkpoint.CheckpointException: Checkpoint was declined (task is closing)
	at org.apache.flink.runtime.messages.checkpoint.SerializedCheckpointException.unwrap(SerializedCheckpointException.java:51) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.checkpoint.CheckpointCoordinator.receiveDeclineMessage(CheckpointCoordinator.java:1146) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.scheduler.ExecutionGraphHandler.lambda$declineCheckpoint$3(ExecutionGraphHandler.java:123) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.scheduler.ExecutionGraphHandler.lambda$processCheckpointCoordinatorMessage$4(ExecutionGraphHandler.java:139) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.util.MdcUtils.lambda$wrapRunnable$1(MdcUtils.java:70) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) [?:?]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) [?:?]
	at java.base/java.lang.Thread.run(Unknown Source) [?:?]
Caused by: org.apache.flink.util.SerializedThrowable: org.apache.flink.runtime.checkpoint.CheckpointException: Task name with subtask : KEYED PROCESS -> Sink: Print to Std. Out (1/1)#0 Failure reason: Checkpoint was declined (task is closing)
	at org.apache.flink.runtime.taskmanager.Task.declineCheckpoint(Task.java:1425) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.declineCheckpoint(Task.java:1418) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.triggerCheckpointBarrier(Task.java:1384) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskexecutor.TaskExecutor.triggerCheckpoint(TaskExecutor.java:1097) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) ~[?:?]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) ~[?:?]
	at java.base/java.lang.reflect.Method.invoke(Unknown Source) ~[?:?]
	at org.apache.flink.runtime.rpc.pekko.PekkoRpcActor.lambda$handleRpcInvocation$1(PekkoRpcActor.java:318) ~[?:?]
	at org.apache.flink.runtime.concurrent.ClassLoadingUtils.runWithContextClassLoader(ClassLoadingUtils.java:83) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.rpc.pekko.PekkoRpcActor.handleRpcInvocation(PekkoRpcActor.java:316) ~[?:?]
	at org.apache.flink.runtime.rpc.pekko.PekkoRpcActor.handleRpcMessage(PekkoRpcActor.java:229) ~[?:?]
	at org.apache.flink.runtime.rpc.pekko.PekkoRpcActor.handleMessage(PekkoRpcActor.java:174) ~[?:?]
	at org.apache.pekko.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:33) ~[?:?]
	at org.apache.pekko.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:29) ~[?:?]
	at scala.PartialFunction.applyOrElse(PartialFunction.scala:127) ~[flink-scala_2.12-2.1.0.jar:2.1.0]
	at scala.PartialFunction.applyOrElse$(PartialFunction.scala:126) ~[flink-scala_2.12-2.1.0.jar:2.1.0]
	at org.apache.pekko.japi.pf.UnitCaseStatement.applyOrElse(CaseStatements.scala:29) ~[?:?]
	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:175) ~[flink-scala_2.12-2.1.0.jar:2.1.0]
	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:176) ~[flink-scala_2.12-2.1.0.jar:2.1.0]
	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:176) ~[flink-scala_2.12-2.1.0.jar:2.1.0]
	at org.apache.pekko.actor.Actor.aroundReceive(Actor.scala:547) ~[?:?]
	at org.apache.pekko.actor.Actor.aroundReceive$(Actor.scala:545) ~[?:?]
	at org.apache.pekko.actor.AbstractActor.aroundReceive(AbstractActor.scala:229) ~[?:?]
	at org.apache.pekko.actor.ActorCell.receiveMessage(ActorCell.scala:590) ~[?:?]
	at org.apache.pekko.actor.ActorCell.invoke(ActorCell.scala:557) ~[?:?]
	at org.apache.pekko.dispatch.Mailbox.processMailbox(Mailbox.scala:272) ~[?:?]
	at org.apache.pekko.dispatch.Mailbox.run(Mailbox.scala:233) ~[?:?]
	at org.apache.pekko.dispatch.Mailbox.exec(Mailbox.scala:245) ~[?:?]
	at java.base/java.util.concurrent.ForkJoinTask.doExec(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.ForkJoinPool.scan(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.ForkJoinPool.runWorker(Unknown Source) ~[?:?]
	at java.base/java.util.concurrent.ForkJoinWorkerThread.run(Unknown Source) ~[?:?]
2025-10-08 14:46:48,827 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Stopping checkpoint coordinator for job 2b5fabbad444862e5918f0332145adc7.
2025-10-08 14:46:48,834 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job 2b5fabbad444862e5918f0332145adc7
2025-10-08 14:46:48,863 INFO  org.apache.flink.runtime.dispatcher.StandaloneDispatcher     [] - Job 2b5fabbad444862e5918f0332145adc7 reached terminal state FINISHED.
2025-10-08 14:46:48,901 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Matching resource requirements against available resources.
Missing resources:
	 Job d1f164921ad7c2fe36d4e92a16bdba98
		ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}
Current resources:
	TaskManager 127.0.0.1:40677-478ca6
		Available: ResourceProfile{cpuCores=0, taskHeapMemory=0 bytes, taskOffHeapMemory=0 bytes, managedMemory=0 bytes, networkMemory=0 bytes}
		Total:     ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
2025-10-08 14:46:48,956 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Stopping the JobMaster for job 'Word Counter' (2b5fabbad444862e5918f0332145adc7).
2025-10-08 14:46:48,962 INFO  org.apache.flink.runtime.checkpoint.StandaloneCompletedCheckpointStore [] - Shutting down
2025-10-08 14:46:48,968 INFO  org.apache.flink.runtime.jobmaster.slotpool.DefaultDeclarativeSlotPool [] - Releasing slot [f38a3947ef434081c608ed9fc61997cc].
2025-10-08 14:46:48,971 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Disconnect TaskExecutor 127.0.0.1:40677-478ca6 because: Stopping JobMaster for job 'Word Counter' (2b5fabbad444862e5918f0332145adc7).
2025-10-08 14:46:48,971 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Close ResourceManager connection 34d627a4f5e60a5465c17b3ab9053ff5: Stopping JobMaster for job 'Word Counter' (2b5fabbad444862e5918f0332145adc7).
2025-10-08 14:46:48,973 INFO  org.apache.flink.runtime.resourcemanager.StandaloneResourceManager [] - Disconnect job manager 00000000000000000000000000000000@pekko.tcp://flink@30a48f53a5ec:6123/user/rpc/jobmanager_2 for job 2b5fabbad444862e5918f0332145adc7 from the resource manager.
2025-10-08 14:46:49,051 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Freeing slot f38a3947ef434081c608ed9fc61997cc.
2025-10-08 14:46:49,121 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Matching resource requirements against available resources.
Missing resources:
	 Job d1f164921ad7c2fe36d4e92a16bdba98
		ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}
Current resources:
	TaskManager 127.0.0.1:40677-478ca6
		Available: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
		Total:     ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
2025-10-08 14:46:49,122 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Starting allocation of slot ad238b8ee2b6ed1a3f7e20706b5fe970 from 127.0.0.1:40677-478ca6 for job d1f164921ad7c2fe36d4e92a16bdba98 with resource profile ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 14:46:49,212 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job d1f164921ad7c2fe36d4e92a16bdba98 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job d1f164921ad7c2fe36d4e92a16bdba98 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 14:46:49,229 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:46:49,234 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #0) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_0 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:46:49,238 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_0) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:46:49,245 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #0) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_0 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:46:49,527 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_0) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:46:49,545 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:46:50,144 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_0) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e862950-a689-40b1-b452-4a49283650df/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e862950-a689-40b1-b452-4a49283650df/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:46:50,221 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_0.
2025-10-08 14:46:50,222 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 14:46:50,224 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from INITIALIZING to CANCELING.
2025-10-08 14:46:50,255 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job d1f164921ad7c2fe36d4e92a16bdba98 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job d1f164921ad7c2fe36d4e92a16bdba98 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 14:46:51,270 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_0) switched from CANCELING to CANCELED.
2025-10-08 14:46:51,281 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 14:46:51,286 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 14:46:51,288 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 14:46:51,289 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_1) switched from CREATED to SCHEDULED.
2025-10-08 14:46:51,289 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_1) switched from CREATED to SCHEDULED.
2025-10-08 14:46:51,292 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_1) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:46:51,293 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #1) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_1 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:46:51,295 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_1) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:46:51,296 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #1) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_1 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:46:51,313 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 14:46:51,334 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_1) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:46:51,366 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_1) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:46:51,811 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_1) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_be9a9b01-eb7c-4eb0-a494-97ecdebb5d21/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_be9a9b01-eb7c-4eb0-a494-97ecdebb5d21/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:46:51,832 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_1.
2025-10-08 14:46:51,836 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 14:46:51,837 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_1) switched from INITIALIZING to CANCELING.
2025-10-08 14:46:52,150 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_1) switched from CANCELING to CANCELED.
2025-10-08 14:46:52,171 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 14:46:53,372 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 14:46:53,373 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 14:46:53,374 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 14:46:53,374 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_2) switched from CREATED to SCHEDULED.
2025-10-08 14:46:53,374 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_2) switched from CREATED to SCHEDULED.
2025-10-08 14:46:53,375 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_2) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:46:53,375 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #2) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_2 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:46:53,376 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_2) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:46:53,376 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #2) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_2 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:46:53,396 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 14:46:53,401 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_2) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:46:53,440 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_2) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:46:53,922 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job d1f164921ad7c2fe36d4e92a16bdba98 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job d1f164921ad7c2fe36d4e92a16bdba98 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 14:46:54,033 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_2) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_70eb9749-842f-42c8-89a8-93f09c4de59a/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_70eb9749-842f-42c8-89a8-93f09c4de59a/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:46:54,050 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_2.
2025-10-08 14:46:54,055 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 14:46:54,056 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_2) switched from INITIALIZING to CANCELING.
2025-10-08 14:46:54,158 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_2) switched from CANCELING to CANCELED.
2025-10-08 14:46:54,185 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 14:46:56,469 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 14:46:56,474 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 14:46:56,476 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 14:46:56,476 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_3) switched from CREATED to SCHEDULED.
2025-10-08 14:46:56,476 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_3) switched from CREATED to SCHEDULED.
2025-10-08 14:46:56,478 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_3) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:46:56,479 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #3) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_3 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:46:56,479 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_3) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:46:56,480 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #3) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_3 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:46:56,500 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 14:46:56,537 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_3) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:46:56,561 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_3) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:46:56,834 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_3) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5e2b327e-ee29-4d8c-a646-091ccb780763/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5e2b327e-ee29-4d8c-a646-091ccb780763/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:46:56,848 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_3.
2025-10-08 14:46:56,848 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 14:46:56,851 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_3) switched from INITIALIZING to CANCELING.
2025-10-08 14:46:56,907 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_3) switched from CANCELING to CANCELED.
2025-10-08 14:46:56,928 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 14:47:00,358 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 14:47:00,359 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 14:47:00,361 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 14:47:00,363 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_4) switched from CREATED to SCHEDULED.
2025-10-08 14:47:00,364 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_4) switched from CREATED to SCHEDULED.
2025-10-08 14:47:00,368 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_4) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:47:00,368 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #4) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_4 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:47:00,368 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_4) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:47:00,369 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #4) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_4 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:47:00,387 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 14:47:00,449 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_4) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:47:00,468 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_4) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:47:00,514 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job d1f164921ad7c2fe36d4e92a16bdba98 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job d1f164921ad7c2fe36d4e92a16bdba98 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 14:47:01,051 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_4) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_30cd8a4d-0296-4161-a40d-502a68b43ea2/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_30cd8a4d-0296-4161-a40d-502a68b43ea2/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:47:01,065 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_4.
2025-10-08 14:47:01,067 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 14:47:01,069 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_4) switched from INITIALIZING to CANCELING.
2025-10-08 14:47:01,122 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_4) switched from CANCELING to CANCELED.
2025-10-08 14:47:01,144 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 14:47:05,901 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 14:47:05,902 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 14:47:05,903 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 14:47:05,903 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_5) switched from CREATED to SCHEDULED.
2025-10-08 14:47:05,903 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_5) switched from CREATED to SCHEDULED.
2025-10-08 14:47:05,904 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_5) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:47:05,904 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #5) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_5 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:47:05,905 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_5) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:47:05,905 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #5) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_5 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:47:05,930 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 14:47:05,942 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_5) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:47:05,947 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_5) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:47:06,260 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_5) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e6ce2f1e-4387-4db5-87cc-c98e20a703fc/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e6ce2f1e-4387-4db5-87cc-c98e20a703fc/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:47:06,272 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_5.
2025-10-08 14:47:06,277 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 14:47:06,279 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_5) switched from INITIALIZING to CANCELING.
2025-10-08 14:47:06,309 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_5) switched from CANCELING to CANCELED.
2025-10-08 14:47:06,332 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 14:47:14,224 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 14:47:14,225 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 14:47:14,226 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 14:47:14,226 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_6) switched from CREATED to SCHEDULED.
2025-10-08 14:47:14,226 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_6) switched from CREATED to SCHEDULED.
2025-10-08 14:47:14,227 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_6) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:47:14,227 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #6) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_6 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:47:14,228 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_6) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:47:14,228 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #6) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_6 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:47:14,248 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 14:47:14,254 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_6) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:47:14,268 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_6) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:47:14,477 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_6) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_754068fc-f980-4e7a-a655-0902d36b6604/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_754068fc-f980-4e7a-a655-0902d36b6604/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:47:14,486 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_6.
2025-10-08 14:47:14,487 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 14:47:14,487 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_6) switched from INITIALIZING to CANCELING.
2025-10-08 14:47:14,519 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_6) switched from CANCELING to CANCELED.
2025-10-08 14:47:14,541 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 14:47:25,142 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 14:47:25,142 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 14:47:25,143 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 14:47:25,143 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_7) switched from CREATED to SCHEDULED.
2025-10-08 14:47:25,144 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_7) switched from CREATED to SCHEDULED.
2025-10-08 14:47:25,144 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_7) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:47:25,145 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #7) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_7 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:47:25,145 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_7) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:47:25,145 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #7) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_7 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:47:25,166 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 14:47:25,173 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_7) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:47:25,182 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_7) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:47:25,422 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_7) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e63067d-08ff-47ef-8376-b9ea0ac14d25/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e63067d-08ff-47ef-8376-b9ea0ac14d25/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:47:25,431 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_7.
2025-10-08 14:47:25,432 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 14:47:25,434 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_7) switched from INITIALIZING to CANCELING.
2025-10-08 14:47:25,468 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_7) switched from CANCELING to CANCELED.
2025-10-08 14:47:25,490 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 14:47:43,420 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 14:47:43,421 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 14:47:43,422 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 14:47:43,422 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_8) switched from CREATED to SCHEDULED.
2025-10-08 14:47:43,422 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_8) switched from CREATED to SCHEDULED.
2025-10-08 14:47:43,423 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_8) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:47:43,423 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #8) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_8 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:47:43,423 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_8) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:47:43,423 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #8) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_8 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:47:43,445 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 14:47:43,461 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_8) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:47:43,461 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_8) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:47:43,662 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_8) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e10882c-f11e-46e8-bb19-443937648371/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_9e10882c-f11e-46e8-bb19-443937648371/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:47:43,674 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_8.
2025-10-08 14:47:43,675 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 14:47:43,676 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_8) switched from INITIALIZING to CANCELING.
2025-10-08 14:47:43,737 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_8) switched from CANCELING to CANCELED.
2025-10-08 14:47:43,758 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 14:48:08,813 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 14:48:08,814 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 14:48:08,815 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 14:48:08,815 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_9) switched from CREATED to SCHEDULED.
2025-10-08 14:48:08,816 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_9) switched from CREATED to SCHEDULED.
2025-10-08 14:48:08,816 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_9) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:48:08,817 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #9) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_9 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:48:08,817 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_9) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:48:08,817 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #9) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_9 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:48:08,837 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_9) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:48:08,838 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 14:48:08,845 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_9) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:48:09,030 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_9) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_93b8ac71-f122-461f-9893-8b7db16aa84a/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_93b8ac71-f122-461f-9893-8b7db16aa84a/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:48:09,043 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_9.
2025-10-08 14:48:09,044 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 14:48:09,045 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_9) switched from INITIALIZING to CANCELING.
2025-10-08 14:48:09,089 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_9) switched from CANCELING to CANCELED.
2025-10-08 14:48:09,111 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 14:48:46,104 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 14:48:46,105 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 14:48:46,106 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 14:48:46,106 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_10) switched from CREATED to SCHEDULED.
2025-10-08 14:48:46,106 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_10) switched from CREATED to SCHEDULED.
2025-10-08 14:48:46,107 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_10) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:48:46,107 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #10) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_10 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:48:46,108 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_10) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:48:46,108 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #10) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_10 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:48:46,127 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 14:48:46,128 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_10) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:48:46,138 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_10) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:48:46,462 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_10) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5c163257-e2d5-482c-8ae8-f4a7740560b4/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5c163257-e2d5-482c-8ae8-f4a7740560b4/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:48:46,477 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_10.
2025-10-08 14:48:46,478 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 14:48:46,480 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_10) switched from INITIALIZING to CANCELING.
2025-10-08 14:48:46,560 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_10) switched from CANCELING to CANCELED.
2025-10-08 14:48:46,583 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 14:49:46,482 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 14:49:46,483 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 14:49:46,483 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 14:49:46,484 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_11) switched from CREATED to SCHEDULED.
2025-10-08 14:49:46,484 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_11) switched from CREATED to SCHEDULED.
2025-10-08 14:49:46,485 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_11) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:49:46,485 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #11) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_11 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:49:46,485 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_11) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:49:46,485 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #11) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_11 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:49:46,506 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 14:49:46,510 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_11) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:49:46,514 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_11) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:49:46,720 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_11) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_73af54fd-e7bc-432d-b57a-939e3d4bef2b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_73af54fd-e7bc-432d-b57a-939e3d4bef2b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:49:46,736 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_11.
2025-10-08 14:49:46,737 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 14:49:46,738 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_11) switched from INITIALIZING to CANCELING.
2025-10-08 14:49:46,794 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_11) switched from CANCELING to CANCELED.
2025-10-08 14:49:46,815 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 14:50:46,787 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 14:50:46,787 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 14:50:46,788 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 14:50:46,788 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_12) switched from CREATED to SCHEDULED.
2025-10-08 14:50:46,789 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_12) switched from CREATED to SCHEDULED.
2025-10-08 14:50:46,789 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_12) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:50:46,790 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #12) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_12 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:50:46,790 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_12) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:50:46,790 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #12) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_12 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:50:46,813 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 14:50:46,823 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_12) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:50:46,824 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_12) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:50:47,009 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_12) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_516d10cd-1f4b-4935-a9fe-2deeadd89dbe/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_516d10cd-1f4b-4935-a9fe-2deeadd89dbe/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:50:47,014 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_12.
2025-10-08 14:50:47,015 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 14:50:47,016 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_12) switched from INITIALIZING to CANCELING.
2025-10-08 14:50:47,059 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_12) switched from CANCELING to CANCELED.
2025-10-08 14:50:47,080 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 14:51:47,020 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 14:51:47,021 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 14:51:47,022 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 14:51:47,022 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_13) switched from CREATED to SCHEDULED.
2025-10-08 14:51:47,022 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_13) switched from CREATED to SCHEDULED.
2025-10-08 14:51:47,023 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_13) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:51:47,023 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #13) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_13 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:51:47,023 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_13) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:51:47,023 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #13) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_13 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id ad238b8ee2b6ed1a3f7e20706b5fe970
2025-10-08 14:51:47,044 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 14:51:47,052 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_13) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:51:47,060 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_13) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:51:47,246 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_13) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_31f64109-2da2-4c03-a265-e716088dd75d/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_31f64109-2da2-4c03-a265-e716088dd75d/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:51:47,252 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_13.
2025-10-08 14:51:47,253 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 14:51:47,254 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_13) switched from INITIALIZING to CANCELING.
2025-10-08 14:51:47,291 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_13) switched from CANCELING to CANCELED.
2025-10-08 14:51:47,312 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 14:52:38,615 INFO  org.apache.flink.runtime.jobmaster.slotpool.DefaultDeclarativeSlotPool [] - Releasing slot [ad238b8ee2b6ed1a3f7e20706b5fe970].
2025-10-08 14:52:38,624 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Freeing slot ad238b8ee2b6ed1a3f7e20706b5fe970.
2025-10-08 14:52:38,624 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Disconnect TaskExecutor 127.0.0.1:40677-478ca6 because: TaskExecutor pekko.tcp://flink@127.0.0.1:40677/user/rpc/taskmanager_0 has no more allocated slots for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 14:52:47,260 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 14:52:47,260 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 14:52:47,261 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 14:52:47,261 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_14) switched from CREATED to SCHEDULED.
2025-10-08 14:52:47,261 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_14) switched from CREATED to SCHEDULED.
2025-10-08 14:52:47,282 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 14:52:47,347 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Matching resource requirements against available resources.
Missing resources:
	 Job d1f164921ad7c2fe36d4e92a16bdba98
		ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}
Current resources:
	TaskManager 127.0.0.1:40677-478ca6
		Available: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
		Total:     ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
2025-10-08 14:52:47,347 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Starting allocation of slot 8220171550d74ab189fb532bbda2484c from 127.0.0.1:40677-478ca6 for job d1f164921ad7c2fe36d4e92a16bdba98 with resource profile ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 14:52:47,365 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_14) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:52:47,366 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #14) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_14 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 8220171550d74ab189fb532bbda2484c
2025-10-08 14:52:47,366 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_14) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:52:47,366 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #14) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_14 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 8220171550d74ab189fb532bbda2484c
2025-10-08 14:52:47,383 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_14) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:52:47,522 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_14) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:52:47,593 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job d1f164921ad7c2fe36d4e92a16bdba98 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job d1f164921ad7c2fe36d4e92a16bdba98 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 14:52:47,735 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_14) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0f0af6e6-4880-4b95-b664-da74d391e07d/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0f0af6e6-4880-4b95-b664-da74d391e07d/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:52:47,741 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_14.
2025-10-08 14:52:47,741 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 14:52:47,741 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_14) switched from INITIALIZING to CANCELING.
2025-10-08 14:52:47,921 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_14) switched from CANCELING to CANCELED.
2025-10-08 14:52:47,943 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 14:53:47,747 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 14:53:47,748 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 14:53:47,748 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 14:53:47,749 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_15) switched from CREATED to SCHEDULED.
2025-10-08 14:53:47,749 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_15) switched from CREATED to SCHEDULED.
2025-10-08 14:53:47,749 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_15) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:53:47,749 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #15) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_15 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 8220171550d74ab189fb532bbda2484c
2025-10-08 14:53:47,750 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_15) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:53:47,750 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #15) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_15 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 8220171550d74ab189fb532bbda2484c
2025-10-08 14:53:47,766 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_15) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:53:47,770 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 14:53:47,773 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_15) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:53:47,818 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_15) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6f103c6d-8525-485b-94b3-119163a60ae3/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6f103c6d-8525-485b-94b3-119163a60ae3/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:53:47,821 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_15.
2025-10-08 14:53:47,821 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 14:53:47,822 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_15) switched from INITIALIZING to CANCELING.
2025-10-08 14:53:48,596 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_15) switched from CANCELING to CANCELED.
2025-10-08 14:53:48,617 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 14:54:47,825 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 14:54:47,826 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 14:54:47,827 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 14:54:47,827 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_16) switched from CREATED to SCHEDULED.
2025-10-08 14:54:47,827 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_16) switched from CREATED to SCHEDULED.
2025-10-08 14:54:47,828 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_16) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:54:47,828 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #16) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_16 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 8220171550d74ab189fb532bbda2484c
2025-10-08 14:54:47,828 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_16) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:54:47,828 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #16) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_16 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 8220171550d74ab189fb532bbda2484c
2025-10-08 14:54:47,830 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job d1f164921ad7c2fe36d4e92a16bdba98 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job d1f164921ad7c2fe36d4e92a16bdba98 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 14:54:47,849 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_16) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:54:47,850 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 14:54:47,850 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_16) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:54:48,249 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_16) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_933e4fc2-2acd-4f5d-92f3-0b66553758bb/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_933e4fc2-2acd-4f5d-92f3-0b66553758bb/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:54:48,254 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_16.
2025-10-08 14:54:48,254 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 14:54:48,255 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_16) switched from INITIALIZING to CANCELING.
2025-10-08 14:54:48,647 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_16) switched from CANCELING to CANCELED.
2025-10-08 14:54:48,668 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 14:55:48,258 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 14:55:48,259 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 14:55:48,260 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 14:55:48,260 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_17) switched from CREATED to SCHEDULED.
2025-10-08 14:55:48,260 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_17) switched from CREATED to SCHEDULED.
2025-10-08 14:55:48,261 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_17) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:55:48,261 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #17) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_17 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 8220171550d74ab189fb532bbda2484c
2025-10-08 14:55:48,261 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_17) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:55:48,261 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #17) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_17 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 8220171550d74ab189fb532bbda2484c
2025-10-08 14:55:48,281 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_17) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:55:48,281 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_17) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:55:48,284 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 14:55:48,325 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job d1f164921ad7c2fe36d4e92a16bdba98 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job d1f164921ad7c2fe36d4e92a16bdba98 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 14:55:48,470 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_17) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5015e7d0-856d-43c6-ab0b-9277b7745378/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5015e7d0-856d-43c6-ab0b-9277b7745378/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:55:48,478 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_17.
2025-10-08 14:55:48,479 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 14:55:48,479 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_17) switched from INITIALIZING to CANCELING.
2025-10-08 14:55:48,502 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_17) switched from CANCELING to CANCELED.
2025-10-08 14:55:48,523 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 14:56:48,482 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 14:56:48,483 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 14:56:48,483 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 14:56:48,484 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_18) switched from CREATED to SCHEDULED.
2025-10-08 14:56:48,484 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_18) switched from CREATED to SCHEDULED.
2025-10-08 14:56:48,484 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_18) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:56:48,485 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #18) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_18 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 8220171550d74ab189fb532bbda2484c
2025-10-08 14:56:48,485 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_18) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:56:48,485 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #18) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_18 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 8220171550d74ab189fb532bbda2484c
2025-10-08 14:56:48,506 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_18) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:56:48,507 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 14:56:48,509 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_18) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:56:48,692 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_18) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_696781ba-38a4-474f-bc6d-eee6bc03e7e0/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_696781ba-38a4-474f-bc6d-eee6bc03e7e0/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:56:48,696 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_18.
2025-10-08 14:56:48,696 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 14:56:48,697 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_18) switched from INITIALIZING to CANCELING.
2025-10-08 14:56:48,721 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_18) switched from CANCELING to CANCELED.
2025-10-08 14:56:48,742 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 14:57:48,699 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 14:57:48,701 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 14:57:48,702 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 14:57:48,704 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_19) switched from CREATED to SCHEDULED.
2025-10-08 14:57:48,704 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_19) switched from CREATED to SCHEDULED.
2025-10-08 14:57:48,706 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_19) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:57:48,707 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #19) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_19 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 8220171550d74ab189fb532bbda2484c
2025-10-08 14:57:48,708 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_19) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:57:48,709 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #19) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_19 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 8220171550d74ab189fb532bbda2484c
2025-10-08 14:57:48,726 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 14:57:48,744 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_19) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:57:48,745 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_19) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:57:48,887 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_19) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7e3d89e1-c196-4322-b16c-706cc324ccc9/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7e3d89e1-c196-4322-b16c-706cc324ccc9/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:57:48,890 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_19.
2025-10-08 14:57:48,891 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 14:57:48,891 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_19) switched from INITIALIZING to CANCELING.
2025-10-08 14:57:48,924 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_19) switched from CANCELING to CANCELED.
2025-10-08 14:57:48,948 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 14:58:48,895 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 14:58:48,896 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 14:58:48,896 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 14:58:48,896 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_20) switched from CREATED to SCHEDULED.
2025-10-08 14:58:48,897 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_20) switched from CREATED to SCHEDULED.
2025-10-08 14:58:48,897 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_20) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:58:48,897 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #20) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_20 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 8220171550d74ab189fb532bbda2484c
2025-10-08 14:58:48,898 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_20) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:58:48,898 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #20) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_20 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 8220171550d74ab189fb532bbda2484c
2025-10-08 14:58:48,918 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 14:58:48,918 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_20) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:58:48,919 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_20) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:58:49,115 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_20) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e2a4cba7-d652-48bf-8a81-dd05b50b02d6/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e2a4cba7-d652-48bf-8a81-dd05b50b02d6/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:58:49,119 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_20.
2025-10-08 14:58:49,120 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 14:58:49,121 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_20) switched from INITIALIZING to CANCELING.
2025-10-08 14:58:49,149 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_20) switched from CANCELING to CANCELED.
2025-10-08 14:58:49,171 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 14:59:49,125 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 14:59:49,126 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 14:59:49,127 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 14:59:49,127 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_21) switched from CREATED to SCHEDULED.
2025-10-08 14:59:49,127 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_21) switched from CREATED to SCHEDULED.
2025-10-08 14:59:49,128 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_21) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:59:49,128 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #21) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_21 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 8220171550d74ab189fb532bbda2484c
2025-10-08 14:59:49,128 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_21) switched from SCHEDULED to DEPLOYING.
2025-10-08 14:59:49,128 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #21) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_21 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 8220171550d74ab189fb532bbda2484c
2025-10-08 14:59:49,148 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_21) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:59:49,148 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_21) switched from DEPLOYING to INITIALIZING.
2025-10-08 14:59:49,151 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 14:59:49,181 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_21) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a358eb4d-b0e6-4b0d-8229-f66ad830333e/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a358eb4d-b0e6-4b0d-8229-f66ad830333e/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 14:59:49,183 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_21.
2025-10-08 14:59:49,184 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 14:59:49,184 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_21) switched from INITIALIZING to CANCELING.
2025-10-08 14:59:52,643 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_21) switched from CANCELING to CANCELED.
2025-10-08 14:59:52,665 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:00:49,187 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:00:49,187 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:00:49,188 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:00:49,189 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_22) switched from CREATED to SCHEDULED.
2025-10-08 15:00:49,189 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_22) switched from CREATED to SCHEDULED.
2025-10-08 15:00:49,189 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_22) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:00:49,189 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #22) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_22 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 8220171550d74ab189fb532bbda2484c
2025-10-08 15:00:49,190 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_22) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:00:49,190 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #22) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_22 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 8220171550d74ab189fb532bbda2484c
2025-10-08 15:00:49,203 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_22) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:00:49,210 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:00:49,212 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_22) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:00:49,348 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_22) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c118f564-2698-4fab-9c4e-2ed84c0709c0/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c118f564-2698-4fab-9c4e-2ed84c0709c0/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:00:49,351 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_22.
2025-10-08 15:00:49,352 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:00:49,352 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_22) switched from INITIALIZING to CANCELING.
2025-10-08 15:00:49,366 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_22) switched from CANCELING to CANCELED.
2025-10-08 15:00:49,387 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:01:48,620 INFO  org.apache.flink.runtime.jobmaster.slotpool.DefaultDeclarativeSlotPool [] - Releasing slot [8220171550d74ab189fb532bbda2484c].
2025-10-08 15:01:48,626 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Disconnect TaskExecutor 127.0.0.1:40677-478ca6 because: TaskExecutor pekko.tcp://flink@127.0.0.1:40677/user/rpc/taskmanager_0 has no more allocated slots for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:01:48,626 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Freeing slot 8220171550d74ab189fb532bbda2484c.
2025-10-08 15:01:49,354 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:01:49,355 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:01:49,356 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:01:49,357 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_23) switched from CREATED to SCHEDULED.
2025-10-08 15:01:49,357 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_23) switched from CREATED to SCHEDULED.
2025-10-08 15:01:49,378 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:01:49,447 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Matching resource requirements against available resources.
Missing resources:
	 Job d1f164921ad7c2fe36d4e92a16bdba98
		ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}
Current resources:
	TaskManager 127.0.0.1:40677-478ca6
		Available: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
		Total:     ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
2025-10-08 15:01:49,447 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Starting allocation of slot 061af1b6749069abb1ce465beb001a6b from 127.0.0.1:40677-478ca6 for job d1f164921ad7c2fe36d4e92a16bdba98 with resource profile ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 15:01:49,461 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_23) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:01:49,462 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #23) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_23 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 061af1b6749069abb1ce465beb001a6b
2025-10-08 15:01:49,462 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_23) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:01:49,462 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #23) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_23 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 061af1b6749069abb1ce465beb001a6b
2025-10-08 15:01:49,475 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_23) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:01:49,498 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_23) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:01:49,688 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_23) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_90df9a0c-9e2c-4b47-a8d7-4c65cc8e4833/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_90df9a0c-9e2c-4b47-a8d7-4c65cc8e4833/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:01:49,695 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_23.
2025-10-08 15:01:49,696 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:01:49,696 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_23) switched from INITIALIZING to CANCELING.
2025-10-08 15:01:49,828 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_23) switched from CANCELING to CANCELED.
2025-10-08 15:01:49,849 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:02:49,698 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:02:49,699 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:02:49,699 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:02:49,700 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_24) switched from CREATED to SCHEDULED.
2025-10-08 15:02:49,700 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_24) switched from CREATED to SCHEDULED.
2025-10-08 15:02:49,700 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_24) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:02:49,700 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #24) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_24 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 061af1b6749069abb1ce465beb001a6b
2025-10-08 15:02:49,701 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_24) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:02:49,701 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #24) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_24 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 061af1b6749069abb1ce465beb001a6b
2025-10-08 15:02:49,714 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_24) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:02:49,720 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_24) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:02:49,721 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:02:49,765 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_24) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_63832fdd-2089-4a61-adbb-b0f3d920e6ce/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_63832fdd-2089-4a61-adbb-b0f3d920e6ce/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:02:49,771 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_24.
2025-10-08 15:02:49,772 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:02:49,772 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_24) switched from INITIALIZING to CANCELING.
2025-10-08 15:02:50,706 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_24) switched from CANCELING to CANCELED.
2025-10-08 15:02:50,727 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:03:49,779 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:03:49,780 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:03:49,780 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:03:49,780 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_25) switched from CREATED to SCHEDULED.
2025-10-08 15:03:49,781 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_25) switched from CREATED to SCHEDULED.
2025-10-08 15:03:49,781 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_25) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:03:49,781 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #25) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_25 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 061af1b6749069abb1ce465beb001a6b
2025-10-08 15:03:49,782 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_25) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:03:49,782 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #25) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_25 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 061af1b6749069abb1ce465beb001a6b
2025-10-08 15:03:49,795 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_25) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:03:49,797 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_25) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:03:49,802 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:03:50,155 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_25) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_97e86ee7-f5ac-43f4-8812-7553b7cf4255/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_97e86ee7-f5ac-43f4-8812-7553b7cf4255/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:03:50,160 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_25.
2025-10-08 15:03:50,160 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:03:50,160 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_25) switched from INITIALIZING to CANCELING.
2025-10-08 15:03:50,573 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_25) switched from CANCELING to CANCELED.
2025-10-08 15:03:50,594 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:04:50,167 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:04:50,168 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:04:50,168 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:04:50,169 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_26) switched from CREATED to SCHEDULED.
2025-10-08 15:04:50,169 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_26) switched from CREATED to SCHEDULED.
2025-10-08 15:04:50,170 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_26) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:04:50,170 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #26) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_26 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 061af1b6749069abb1ce465beb001a6b
2025-10-08 15:04:50,170 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_26) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:04:50,170 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #26) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_26 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 061af1b6749069abb1ce465beb001a6b
2025-10-08 15:04:50,189 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_26) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:04:50,191 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_26) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:04:50,192 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:04:50,334 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_26) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_b40fb6c7-7170-488f-893a-42145d3ec464/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_b40fb6c7-7170-488f-893a-42145d3ec464/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:04:50,344 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_26.
2025-10-08 15:04:50,344 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:04:50,344 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_26) switched from INITIALIZING to CANCELING.
2025-10-08 15:04:50,363 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_26) switched from CANCELING to CANCELED.
2025-10-08 15:04:50,384 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:05:50,348 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:05:50,349 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:05:50,349 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:05:50,350 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_27) switched from CREATED to SCHEDULED.
2025-10-08 15:05:50,350 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_27) switched from CREATED to SCHEDULED.
2025-10-08 15:05:50,350 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_27) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:05:50,350 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #27) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_27 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 061af1b6749069abb1ce465beb001a6b
2025-10-08 15:05:50,350 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_27) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:05:50,350 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #27) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_27 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 061af1b6749069abb1ce465beb001a6b
2025-10-08 15:05:50,365 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_27) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:05:50,365 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_27) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:05:50,373 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:05:50,504 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_27) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e7964387-1485-4337-8fc2-364ae8cf993f/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e7964387-1485-4337-8fc2-364ae8cf993f/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:05:50,509 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_27.
2025-10-08 15:05:50,510 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:05:50,510 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_27) switched from INITIALIZING to CANCELING.
2025-10-08 15:05:50,533 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_27) switched from CANCELING to CANCELED.
2025-10-08 15:05:50,555 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:06:48,622 INFO  org.apache.flink.runtime.jobmaster.slotpool.DefaultDeclarativeSlotPool [] - Releasing slot [061af1b6749069abb1ce465beb001a6b].
2025-10-08 15:06:48,627 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Freeing slot 061af1b6749069abb1ce465beb001a6b.
2025-10-08 15:06:48,627 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Disconnect TaskExecutor 127.0.0.1:40677-478ca6 because: TaskExecutor pekko.tcp://flink@127.0.0.1:40677/user/rpc/taskmanager_0 has no more allocated slots for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:06:50,514 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:06:50,515 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:06:50,515 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:06:50,515 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_28) switched from CREATED to SCHEDULED.
2025-10-08 15:06:50,516 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_28) switched from CREATED to SCHEDULED.
2025-10-08 15:06:50,528 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job d1f164921ad7c2fe36d4e92a16bdba98 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job d1f164921ad7c2fe36d4e92a16bdba98 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 15:06:50,536 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:06:50,607 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Matching resource requirements against available resources.
Missing resources:
	 Job d1f164921ad7c2fe36d4e92a16bdba98
		ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}
Current resources:
	TaskManager 127.0.0.1:40677-478ca6
		Available: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
		Total:     ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
2025-10-08 15:06:50,607 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Starting allocation of slot 61341874fb49fc00bd3f9d52f838616e from 127.0.0.1:40677-478ca6 for job d1f164921ad7c2fe36d4e92a16bdba98 with resource profile ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 15:06:50,620 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_28) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:06:50,621 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #28) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_28 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 61341874fb49fc00bd3f9d52f838616e
2025-10-08 15:06:50,621 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_28) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:06:50,621 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #28) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_28 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 61341874fb49fc00bd3f9d52f838616e
2025-10-08 15:06:50,636 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_28) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:06:50,659 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_28) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:06:50,861 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_28) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_17369afe-11e6-4a09-99e7-db448f004a6b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_17369afe-11e6-4a09-99e7-db448f004a6b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:06:50,869 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_28.
2025-10-08 15:06:50,869 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:06:50,869 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_28) switched from INITIALIZING to CANCELING.
2025-10-08 15:06:51,006 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_28) switched from CANCELING to CANCELED.
2025-10-08 15:06:51,027 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:07:50,876 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:07:50,876 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:07:50,877 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:07:50,877 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_29) switched from CREATED to SCHEDULED.
2025-10-08 15:07:50,877 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_29) switched from CREATED to SCHEDULED.
2025-10-08 15:07:50,878 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_29) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:07:50,878 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #29) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_29 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 61341874fb49fc00bd3f9d52f838616e
2025-10-08 15:07:50,878 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_29) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:07:50,878 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #29) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_29 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 61341874fb49fc00bd3f9d52f838616e
2025-10-08 15:07:50,887 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_29) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:07:50,889 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_29) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:07:50,898 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:07:50,928 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_29) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_1c0d07eb-81f1-4f70-bdea-037989556d08/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_1c0d07eb-81f1-4f70-bdea-037989556d08/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:07:50,935 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_29.
2025-10-08 15:07:50,935 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:07:50,935 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_29) switched from INITIALIZING to CANCELING.
2025-10-08 15:07:51,627 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_29) switched from CANCELING to CANCELED.
2025-10-08 15:07:51,648 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:08:50,936 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:08:50,937 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:08:50,938 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:08:50,938 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_30) switched from CREATED to SCHEDULED.
2025-10-08 15:08:50,938 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_30) switched from CREATED to SCHEDULED.
2025-10-08 15:08:50,939 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_30) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:08:50,939 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #30) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_30 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 61341874fb49fc00bd3f9d52f838616e
2025-10-08 15:08:50,939 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_30) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:08:50,939 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #30) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_30 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 61341874fb49fc00bd3f9d52f838616e
2025-10-08 15:08:50,952 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_30) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:08:50,959 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_30) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:08:50,962 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:08:51,253 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job d1f164921ad7c2fe36d4e92a16bdba98 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job d1f164921ad7c2fe36d4e92a16bdba98 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 15:08:51,348 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_30) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c5133216-27ea-4c07-8578-b583a4763b2c/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c5133216-27ea-4c07-8578-b583a4763b2c/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:08:51,351 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_30.
2025-10-08 15:08:51,351 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:08:51,351 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_30) switched from INITIALIZING to CANCELING.
2025-10-08 15:08:51,696 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_30) switched from CANCELING to CANCELED.
2025-10-08 15:08:51,718 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:09:51,358 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:09:51,358 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:09:51,359 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:09:51,359 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_31) switched from CREATED to SCHEDULED.
2025-10-08 15:09:51,359 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_31) switched from CREATED to SCHEDULED.
2025-10-08 15:09:51,360 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_31) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:09:51,360 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #31) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_31 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 61341874fb49fc00bd3f9d52f838616e
2025-10-08 15:09:51,360 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_31) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:09:51,361 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #31) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_31 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 61341874fb49fc00bd3f9d52f838616e
2025-10-08 15:09:51,377 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_31) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:09:51,380 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_31) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:09:51,381 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:09:51,544 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job d1f164921ad7c2fe36d4e92a16bdba98 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job d1f164921ad7c2fe36d4e92a16bdba98 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 15:09:51,584 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_31) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_48bbe7a1-cf64-4bec-a2b8-d970303b88a9/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_48bbe7a1-cf64-4bec-a2b8-d970303b88a9/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:09:51,587 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_31.
2025-10-08 15:09:51,587 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:09:51,588 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_31) switched from INITIALIZING to CANCELING.
2025-10-08 15:09:51,603 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_31) switched from CANCELING to CANCELED.
2025-10-08 15:09:51,624 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:10:51,591 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:10:51,592 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:10:51,592 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:10:51,593 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_32) switched from CREATED to SCHEDULED.
2025-10-08 15:10:51,593 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_32) switched from CREATED to SCHEDULED.
2025-10-08 15:10:51,593 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_32) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:10:51,593 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #32) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_32 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 61341874fb49fc00bd3f9d52f838616e
2025-10-08 15:10:51,594 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_32) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:10:51,594 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #32) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_32 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 61341874fb49fc00bd3f9d52f838616e
2025-10-08 15:10:51,607 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_32) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:10:51,608 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_32) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:10:51,614 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:10:51,739 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_32) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0a00ecc3-8e86-4d19-b3d7-5c1005ef3462/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0a00ecc3-8e86-4d19-b3d7-5c1005ef3462/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:10:51,742 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_32.
2025-10-08 15:10:51,743 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:10:51,743 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_32) switched from INITIALIZING to CANCELING.
2025-10-08 15:10:51,764 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_32) switched from CANCELING to CANCELED.
2025-10-08 15:10:51,785 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:11:48,625 INFO  org.apache.flink.runtime.jobmaster.slotpool.DefaultDeclarativeSlotPool [] - Releasing slot [61341874fb49fc00bd3f9d52f838616e].
2025-10-08 15:11:48,629 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Freeing slot 61341874fb49fc00bd3f9d52f838616e.
2025-10-08 15:11:48,630 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Disconnect TaskExecutor 127.0.0.1:40677-478ca6 because: TaskExecutor pekko.tcp://flink@127.0.0.1:40677/user/rpc/taskmanager_0 has no more allocated slots for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:11:51,747 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:11:51,747 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:11:51,748 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:11:51,748 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_33) switched from CREATED to SCHEDULED.
2025-10-08 15:11:51,748 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_33) switched from CREATED to SCHEDULED.
2025-10-08 15:11:51,769 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:11:51,837 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Matching resource requirements against available resources.
Missing resources:
	 Job d1f164921ad7c2fe36d4e92a16bdba98
		ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}
Current resources:
	TaskManager 127.0.0.1:40677-478ca6
		Available: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
		Total:     ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
2025-10-08 15:11:51,837 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Starting allocation of slot d9db0df651efa64cbc14c8d505cc4b91 from 127.0.0.1:40677-478ca6 for job d1f164921ad7c2fe36d4e92a16bdba98 with resource profile ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 15:11:51,849 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_33) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:11:51,849 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #33) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_33 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id d9db0df651efa64cbc14c8d505cc4b91
2025-10-08 15:11:51,849 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_33) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:11:51,849 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #33) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_33 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id d9db0df651efa64cbc14c8d505cc4b91
2025-10-08 15:11:51,861 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_33) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:11:51,865 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_33) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:11:52,009 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_33) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6ff98e7d-6ce6-43c1-8551-8440dfb56c1c/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6ff98e7d-6ce6-43c1-8551-8440dfb56c1c/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:11:52,015 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_33.
2025-10-08 15:11:52,017 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:11:52,017 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_33) switched from INITIALIZING to CANCELING.
2025-10-08 15:11:52,101 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_33) switched from CANCELING to CANCELED.
2025-10-08 15:11:52,122 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:12:52,019 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:12:52,019 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:12:52,020 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:12:52,020 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_34) switched from CREATED to SCHEDULED.
2025-10-08 15:12:52,020 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_34) switched from CREATED to SCHEDULED.
2025-10-08 15:12:52,021 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_34) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:12:52,021 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #34) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_34 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id d9db0df651efa64cbc14c8d505cc4b91
2025-10-08 15:12:52,021 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_34) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:12:52,021 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #34) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_34 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id d9db0df651efa64cbc14c8d505cc4b91
2025-10-08 15:12:52,036 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_34) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:12:52,037 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_34) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:12:52,041 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:12:52,084 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_34) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a8496283-28d7-46a4-ac7a-af43a8ea0354/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a8496283-28d7-46a4-ac7a-af43a8ea0354/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:12:52,087 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_34.
2025-10-08 15:12:52,088 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:12:52,088 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_34) switched from INITIALIZING to CANCELING.
2025-10-08 15:12:52,673 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_34) switched from CANCELING to CANCELED.
2025-10-08 15:12:52,694 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:13:52,091 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:13:52,092 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:13:52,092 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:13:52,093 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_35) switched from CREATED to SCHEDULED.
2025-10-08 15:13:52,093 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_35) switched from CREATED to SCHEDULED.
2025-10-08 15:13:52,094 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_35) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:13:52,094 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #35) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_35 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id d9db0df651efa64cbc14c8d505cc4b91
2025-10-08 15:13:52,094 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_35) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:13:52,094 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #35) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_35 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id d9db0df651efa64cbc14c8d505cc4b91
2025-10-08 15:13:52,106 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_35) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:13:52,107 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_35) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:13:52,116 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:13:52,366 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_35) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_eadfe59f-f57d-4bbf-bc5e-12f4fb441c3d/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_eadfe59f-f57d-4bbf-bc5e-12f4fb441c3d/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:13:52,369 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_35.
2025-10-08 15:13:52,369 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:13:52,369 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_35) switched from INITIALIZING to CANCELING.
2025-10-08 15:13:52,697 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_35) switched from CANCELING to CANCELED.
2025-10-08 15:13:52,718 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:14:52,370 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:14:52,371 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:14:52,372 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:14:52,372 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_36) switched from CREATED to SCHEDULED.
2025-10-08 15:14:52,372 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_36) switched from CREATED to SCHEDULED.
2025-10-08 15:14:52,373 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_36) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:14:52,373 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #36) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_36 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id d9db0df651efa64cbc14c8d505cc4b91
2025-10-08 15:14:52,373 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_36) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:14:52,373 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #36) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_36 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id d9db0df651efa64cbc14c8d505cc4b91
2025-10-08 15:14:52,385 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_36) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:14:52,391 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_36) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:14:52,395 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:14:52,616 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_36) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_b10c1352-de67-4207-9d7f-9c5231876588/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_b10c1352-de67-4207-9d7f-9c5231876588/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:14:52,623 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_36.
2025-10-08 15:14:52,624 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:14:52,625 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_36) switched from INITIALIZING to CANCELING.
2025-10-08 15:14:52,645 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_36) switched from CANCELING to CANCELED.
2025-10-08 15:14:52,667 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:15:52,628 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:15:52,629 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:15:52,629 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:15:52,629 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_37) switched from CREATED to SCHEDULED.
2025-10-08 15:15:52,630 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_37) switched from CREATED to SCHEDULED.
2025-10-08 15:15:52,630 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_37) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:15:52,630 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #37) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_37 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id d9db0df651efa64cbc14c8d505cc4b91
2025-10-08 15:15:52,630 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_37) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:15:52,630 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #37) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_37 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id d9db0df651efa64cbc14c8d505cc4b91
2025-10-08 15:15:52,642 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_37) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:15:52,643 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_37) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:15:52,651 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:15:52,892 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_37) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_06f8c50d-4a12-4c0f-b500-c40fded1d7d1/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_06f8c50d-4a12-4c0f-b500-c40fded1d7d1/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:15:52,902 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_37.
2025-10-08 15:15:52,903 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:15:52,904 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_37) switched from INITIALIZING to CANCELING.
2025-10-08 15:15:52,966 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_37) switched from CANCELING to CANCELED.
2025-10-08 15:15:52,995 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:16:48,627 INFO  org.apache.flink.runtime.jobmaster.slotpool.DefaultDeclarativeSlotPool [] - Releasing slot [d9db0df651efa64cbc14c8d505cc4b91].
2025-10-08 15:16:48,631 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Freeing slot d9db0df651efa64cbc14c8d505cc4b91.
2025-10-08 15:16:48,631 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Disconnect TaskExecutor 127.0.0.1:40677-478ca6 because: TaskExecutor pekko.tcp://flink@127.0.0.1:40677/user/rpc/taskmanager_0 has no more allocated slots for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:16:52,911 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:16:52,912 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:16:52,912 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:16:52,913 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_38) switched from CREATED to SCHEDULED.
2025-10-08 15:16:52,913 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_38) switched from CREATED to SCHEDULED.
2025-10-08 15:16:52,934 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:16:52,950 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job d1f164921ad7c2fe36d4e92a16bdba98 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job d1f164921ad7c2fe36d4e92a16bdba98 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 15:16:52,997 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Matching resource requirements against available resources.
Missing resources:
	 Job d1f164921ad7c2fe36d4e92a16bdba98
		ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}
Current resources:
	TaskManager 127.0.0.1:40677-478ca6
		Available: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
		Total:     ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
2025-10-08 15:16:52,999 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Starting allocation of slot 18850ae1ee52aef9d30441b70791301f from 127.0.0.1:40677-478ca6 for job d1f164921ad7c2fe36d4e92a16bdba98 with resource profile ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 15:16:53,010 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_38) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:16:53,010 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #38) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_38 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 18850ae1ee52aef9d30441b70791301f
2025-10-08 15:16:53,010 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_38) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:16:53,011 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #38) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_38 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 18850ae1ee52aef9d30441b70791301f
2025-10-08 15:16:53,024 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_38) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:16:53,050 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_38) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:16:53,140 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_38) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_37d1f291-bcf5-4879-82fa-bfa46f794f58/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_37d1f291-bcf5-4879-82fa-bfa46f794f58/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:16:53,144 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_38.
2025-10-08 15:16:53,144 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:16:53,145 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_38) switched from INITIALIZING to CANCELING.
2025-10-08 15:16:53,235 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_38) switched from CANCELING to CANCELED.
2025-10-08 15:16:53,256 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:17:53,147 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:17:53,148 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:17:53,148 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:17:53,148 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_39) switched from CREATED to SCHEDULED.
2025-10-08 15:17:53,148 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_39) switched from CREATED to SCHEDULED.
2025-10-08 15:17:53,149 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_39) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:17:53,149 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #39) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_39 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 18850ae1ee52aef9d30441b70791301f
2025-10-08 15:17:53,149 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_39) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:17:53,149 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #39) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_39 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 18850ae1ee52aef9d30441b70791301f
2025-10-08 15:17:53,161 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_39) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:17:53,165 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_39) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:17:53,169 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:17:53,198 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_39) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7b495b48-4978-451e-a7ba-d19b9ebfbafe/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7b495b48-4978-451e-a7ba-d19b9ebfbafe/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:17:53,201 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_39.
2025-10-08 15:17:53,201 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:17:53,202 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_39) switched from INITIALIZING to CANCELING.
2025-10-08 15:17:53,805 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_39) switched from CANCELING to CANCELED.
2025-10-08 15:17:53,826 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:18:53,203 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:18:53,204 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:18:53,204 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:18:53,204 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_40) switched from CREATED to SCHEDULED.
2025-10-08 15:18:53,205 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_40) switched from CREATED to SCHEDULED.
2025-10-08 15:18:53,205 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_40) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:18:53,205 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #40) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_40 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 18850ae1ee52aef9d30441b70791301f
2025-10-08 15:18:53,205 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_40) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:18:53,205 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #40) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_40 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 18850ae1ee52aef9d30441b70791301f
2025-10-08 15:18:53,217 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_40) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:18:53,217 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_40) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:18:53,226 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:18:53,594 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_40) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e0735f52-d47f-47f9-8ae5-77a1bac76130/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e0735f52-d47f-47f9-8ae5-77a1bac76130/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:18:53,598 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_40.
2025-10-08 15:18:53,598 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:18:53,599 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_40) switched from INITIALIZING to CANCELING.
2025-10-08 15:18:53,799 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_40) switched from CANCELING to CANCELED.
2025-10-08 15:18:53,820 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:19:53,600 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:19:53,601 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:19:53,601 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:19:53,602 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_41) switched from CREATED to SCHEDULED.
2025-10-08 15:19:53,602 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_41) switched from CREATED to SCHEDULED.
2025-10-08 15:19:53,602 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_41) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:19:53,603 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #41) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_41 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 18850ae1ee52aef9d30441b70791301f
2025-10-08 15:19:53,603 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_41) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:19:53,603 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #41) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_41 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 18850ae1ee52aef9d30441b70791301f
2025-10-08 15:19:53,617 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_41) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:19:53,618 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_41) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:19:53,623 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:19:53,748 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_41) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_f511dec5-04fc-4c88-8a02-3271ea1afec4/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_f511dec5-04fc-4c88-8a02-3271ea1afec4/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:19:53,751 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_41.
2025-10-08 15:19:53,751 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:19:53,751 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_41) switched from INITIALIZING to CANCELING.
2025-10-08 15:19:53,765 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_41) switched from CANCELING to CANCELED.
2025-10-08 15:19:53,786 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:20:53,758 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:20:53,758 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:20:53,759 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:20:53,759 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_42) switched from CREATED to SCHEDULED.
2025-10-08 15:20:53,759 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_42) switched from CREATED to SCHEDULED.
2025-10-08 15:20:53,760 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_42) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:20:53,760 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #42) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_42 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 18850ae1ee52aef9d30441b70791301f
2025-10-08 15:20:53,760 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_42) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:20:53,760 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #42) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_42 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 18850ae1ee52aef9d30441b70791301f
2025-10-08 15:20:53,773 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_42) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:20:53,773 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_42) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:20:53,780 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:20:53,906 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_42) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_bd845f58-db12-4282-94e7-972091b75767/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_bd845f58-db12-4282-94e7-972091b75767/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:20:53,910 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_42.
2025-10-08 15:20:53,911 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:20:53,911 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_42) switched from INITIALIZING to CANCELING.
2025-10-08 15:20:53,934 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_42) switched from CANCELING to CANCELED.
2025-10-08 15:20:53,956 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:21:48,630 INFO  org.apache.flink.runtime.jobmaster.slotpool.DefaultDeclarativeSlotPool [] - Releasing slot [18850ae1ee52aef9d30441b70791301f].
2025-10-08 15:21:48,634 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Freeing slot 18850ae1ee52aef9d30441b70791301f.
2025-10-08 15:21:48,634 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Disconnect TaskExecutor 127.0.0.1:40677-478ca6 because: TaskExecutor pekko.tcp://flink@127.0.0.1:40677/user/rpc/taskmanager_0 has no more allocated slots for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:21:53,914 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:21:53,915 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:21:53,915 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:21:53,916 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_43) switched from CREATED to SCHEDULED.
2025-10-08 15:21:53,916 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_43) switched from CREATED to SCHEDULED.
2025-10-08 15:21:53,936 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:21:54,007 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Matching resource requirements against available resources.
Missing resources:
	 Job d1f164921ad7c2fe36d4e92a16bdba98
		ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}
Current resources:
	TaskManager 127.0.0.1:40677-478ca6
		Available: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
		Total:     ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
2025-10-08 15:21:54,007 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Starting allocation of slot 5dca860da127f9de667805ffd89c48a8 from 127.0.0.1:40677-478ca6 for job d1f164921ad7c2fe36d4e92a16bdba98 with resource profile ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 15:21:54,021 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_43) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:21:54,022 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #43) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_43 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 5dca860da127f9de667805ffd89c48a8
2025-10-08 15:21:54,022 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_43) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:21:54,022 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #43) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_43 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 5dca860da127f9de667805ffd89c48a8
2025-10-08 15:21:54,035 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_43) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:21:54,043 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_43) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:21:54,167 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job d1f164921ad7c2fe36d4e92a16bdba98 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job d1f164921ad7c2fe36d4e92a16bdba98 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 15:21:54,220 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_43) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_481fa96b-daa5-4c4b-8172-95744ba9fb40/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_481fa96b-daa5-4c4b-8172-95744ba9fb40/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:21:54,226 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_43.
2025-10-08 15:21:54,226 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:21:54,226 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_43) switched from INITIALIZING to CANCELING.
2025-10-08 15:21:54,384 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_43) switched from CANCELING to CANCELED.
2025-10-08 15:21:54,405 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:22:54,229 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:22:54,229 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:22:54,230 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:22:54,230 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_44) switched from CREATED to SCHEDULED.
2025-10-08 15:22:54,230 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_44) switched from CREATED to SCHEDULED.
2025-10-08 15:22:54,231 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_44) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:22:54,231 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #44) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_44 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 5dca860da127f9de667805ffd89c48a8
2025-10-08 15:22:54,231 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_44) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:22:54,231 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #44) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_44 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 5dca860da127f9de667805ffd89c48a8
2025-10-08 15:22:54,240 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_44) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:22:54,243 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_44) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:22:54,253 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:22:54,295 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_44) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_2bd1440c-4940-44d7-a1a9-4f847fbf9241/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_2bd1440c-4940-44d7-a1a9-4f847fbf9241/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:22:54,300 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_44.
2025-10-08 15:22:54,301 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:22:54,301 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_44) switched from INITIALIZING to CANCELING.
2025-10-08 15:22:54,799 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_44) switched from CANCELING to CANCELED.
2025-10-08 15:22:54,820 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:23:54,305 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:23:54,305 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:23:54,306 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:23:54,306 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_45) switched from CREATED to SCHEDULED.
2025-10-08 15:23:54,306 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_45) switched from CREATED to SCHEDULED.
2025-10-08 15:23:54,307 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_45) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:23:54,307 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #45) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_45 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 5dca860da127f9de667805ffd89c48a8
2025-10-08 15:23:54,307 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_45) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:23:54,307 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #45) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_45 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 5dca860da127f9de667805ffd89c48a8
2025-10-08 15:23:54,320 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_45) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:23:54,320 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_45) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:23:54,329 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:23:54,575 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_45) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_30bf6c5d-1805-4853-b4b1-a2270d051258/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_30bf6c5d-1805-4853-b4b1-a2270d051258/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:23:54,578 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_45.
2025-10-08 15:23:54,578 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:23:54,578 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_45) switched from INITIALIZING to CANCELING.
2025-10-08 15:23:54,785 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_45) switched from CANCELING to CANCELED.
2025-10-08 15:23:54,807 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:24:54,580 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:24:54,581 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:24:54,581 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:24:54,581 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_46) switched from CREATED to SCHEDULED.
2025-10-08 15:24:54,581 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_46) switched from CREATED to SCHEDULED.
2025-10-08 15:24:54,582 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_46) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:24:54,582 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #46) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_46 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 5dca860da127f9de667805ffd89c48a8
2025-10-08 15:24:54,582 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_46) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:24:54,582 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #46) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_46 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 5dca860da127f9de667805ffd89c48a8
2025-10-08 15:24:54,596 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_46) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:24:54,600 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_46) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:24:54,603 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:24:54,629 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job d1f164921ad7c2fe36d4e92a16bdba98 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job d1f164921ad7c2fe36d4e92a16bdba98 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 15:24:54,743 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_46) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_df858050-f711-43cb-921f-f1c14fa81916/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_df858050-f711-43cb-921f-f1c14fa81916/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:24:54,745 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_46.
2025-10-08 15:24:54,745 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:24:54,746 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_46) switched from INITIALIZING to CANCELING.
2025-10-08 15:24:54,758 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_46) switched from CANCELING to CANCELED.
2025-10-08 15:24:54,779 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:25:54,747 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:25:54,748 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:25:54,748 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:25:54,748 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_47) switched from CREATED to SCHEDULED.
2025-10-08 15:25:54,748 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_47) switched from CREATED to SCHEDULED.
2025-10-08 15:25:54,749 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_47) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:25:54,749 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #47) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_47 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 5dca860da127f9de667805ffd89c48a8
2025-10-08 15:25:54,749 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_47) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:25:54,749 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #47) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_47 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 5dca860da127f9de667805ffd89c48a8
2025-10-08 15:25:54,759 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_47) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:25:54,767 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_47) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:25:54,770 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:25:54,898 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_47) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6ca2df97-0f18-4a33-b2f0-31085d70e34f/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6ca2df97-0f18-4a33-b2f0-31085d70e34f/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:25:54,901 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_47.
2025-10-08 15:25:54,901 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:25:54,901 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_47) switched from INITIALIZING to CANCELING.
2025-10-08 15:25:54,912 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_47) switched from CANCELING to CANCELED.
2025-10-08 15:25:54,933 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:26:48,632 INFO  org.apache.flink.runtime.jobmaster.slotpool.DefaultDeclarativeSlotPool [] - Releasing slot [5dca860da127f9de667805ffd89c48a8].
2025-10-08 15:26:48,638 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Freeing slot 5dca860da127f9de667805ffd89c48a8.
2025-10-08 15:26:48,639 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Disconnect TaskExecutor 127.0.0.1:40677-478ca6 because: TaskExecutor pekko.tcp://flink@127.0.0.1:40677/user/rpc/taskmanager_0 has no more allocated slots for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:26:54,903 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:26:54,903 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:26:54,904 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:26:54,904 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_48) switched from CREATED to SCHEDULED.
2025-10-08 15:26:54,904 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_48) switched from CREATED to SCHEDULED.
2025-10-08 15:26:54,924 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:26:54,987 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Matching resource requirements against available resources.
Missing resources:
	 Job d1f164921ad7c2fe36d4e92a16bdba98
		ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}
Current resources:
	TaskManager 127.0.0.1:40677-478ca6
		Available: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
		Total:     ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
2025-10-08 15:26:54,988 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Starting allocation of slot f3a96c530f6ea47a289c7320ec40b2f8 from 127.0.0.1:40677-478ca6 for job d1f164921ad7c2fe36d4e92a16bdba98 with resource profile ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 15:26:55,000 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_48) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:26:55,000 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #48) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_48 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id f3a96c530f6ea47a289c7320ec40b2f8
2025-10-08 15:26:55,001 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_48) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:26:55,001 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #48) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_48 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id f3a96c530f6ea47a289c7320ec40b2f8
2025-10-08 15:26:55,011 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_48) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:26:55,019 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_48) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:26:55,177 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_48) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6a2479c8-0f0d-4bf7-bfcf-9f6bf40d525e/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6a2479c8-0f0d-4bf7-bfcf-9f6bf40d525e/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:26:55,182 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_48.
2025-10-08 15:26:55,182 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:26:55,182 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_48) switched from INITIALIZING to CANCELING.
2025-10-08 15:26:55,245 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_48) switched from CANCELING to CANCELED.
2025-10-08 15:26:55,266 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:27:55,185 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:27:55,185 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:27:55,186 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:27:55,186 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_49) switched from CREATED to SCHEDULED.
2025-10-08 15:27:55,186 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_49) switched from CREATED to SCHEDULED.
2025-10-08 15:27:55,187 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_49) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:27:55,187 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #49) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_49 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id f3a96c530f6ea47a289c7320ec40b2f8
2025-10-08 15:27:55,187 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_49) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:27:55,187 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #49) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_49 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id f3a96c530f6ea47a289c7320ec40b2f8
2025-10-08 15:27:55,198 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_49) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:27:55,202 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_49) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:27:55,207 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:27:55,236 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_49) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_8b085aa5-6f24-4cfb-b03f-b6cfdde11d91/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_8b085aa5-6f24-4cfb-b03f-b6cfdde11d91/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:27:55,242 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_49.
2025-10-08 15:27:55,242 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:27:55,242 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_49) switched from INITIALIZING to CANCELING.
2025-10-08 15:27:55,718 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_49) switched from CANCELING to CANCELED.
2025-10-08 15:27:55,739 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:28:55,245 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:28:55,246 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:28:55,247 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:28:55,247 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_50) switched from CREATED to SCHEDULED.
2025-10-08 15:28:55,247 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_50) switched from CREATED to SCHEDULED.
2025-10-08 15:28:55,248 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_50) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:28:55,248 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #50) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_50 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id f3a96c530f6ea47a289c7320ec40b2f8
2025-10-08 15:28:55,248 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_50) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:28:55,248 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #50) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_50 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id f3a96c530f6ea47a289c7320ec40b2f8
2025-10-08 15:28:55,259 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_50) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:28:55,262 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_50) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:28:55,267 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:28:55,478 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job d1f164921ad7c2fe36d4e92a16bdba98 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job d1f164921ad7c2fe36d4e92a16bdba98 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 15:28:55,504 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_50) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_94193ca4-6fee-43da-a150-eed8a977e2bf/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_94193ca4-6fee-43da-a150-eed8a977e2bf/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:28:55,510 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_50.
2025-10-08 15:28:55,510 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:28:55,511 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_50) switched from INITIALIZING to CANCELING.
2025-10-08 15:28:55,708 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_50) switched from CANCELING to CANCELED.
2025-10-08 15:28:55,729 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:29:55,513 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:29:55,513 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:29:55,514 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:29:55,514 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_51) switched from CREATED to SCHEDULED.
2025-10-08 15:29:55,514 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_51) switched from CREATED to SCHEDULED.
2025-10-08 15:29:55,515 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_51) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:29:55,515 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #51) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_51 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id f3a96c530f6ea47a289c7320ec40b2f8
2025-10-08 15:29:55,515 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_51) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:29:55,515 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #51) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_51 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id f3a96c530f6ea47a289c7320ec40b2f8
2025-10-08 15:29:55,535 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_51) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:29:55,536 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_51) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:29:55,537 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:29:55,731 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job d1f164921ad7c2fe36d4e92a16bdba98 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job d1f164921ad7c2fe36d4e92a16bdba98 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 15:29:55,771 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_51) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_95035847-d4bc-4aa3-92be-406f7bb8e1f4/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_95035847-d4bc-4aa3-92be-406f7bb8e1f4/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:29:55,776 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_51.
2025-10-08 15:29:55,776 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:29:55,779 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_51) switched from INITIALIZING to CANCELING.
2025-10-08 15:29:55,799 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_51) switched from CANCELING to CANCELED.
2025-10-08 15:29:55,819 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:30:55,782 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:30:55,783 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:30:55,783 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:30:55,783 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_52) switched from CREATED to SCHEDULED.
2025-10-08 15:30:55,783 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_52) switched from CREATED to SCHEDULED.
2025-10-08 15:30:55,784 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_52) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:30:55,784 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #52) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_52 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id f3a96c530f6ea47a289c7320ec40b2f8
2025-10-08 15:30:55,784 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_52) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:30:55,784 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #52) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_52 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id f3a96c530f6ea47a289c7320ec40b2f8
2025-10-08 15:30:55,793 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_52) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:30:55,796 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_52) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:30:55,809 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:30:55,925 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_52) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e167fbb5-be82-461e-bf67-0a406166e1b8/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e167fbb5-be82-461e-bf67-0a406166e1b8/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:30:55,930 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_52.
2025-10-08 15:30:55,930 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:30:55,930 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_52) switched from INITIALIZING to CANCELING.
2025-10-08 15:30:55,954 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_52) switched from CANCELING to CANCELED.
2025-10-08 15:30:55,975 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:31:48,634 INFO  org.apache.flink.runtime.jobmaster.slotpool.DefaultDeclarativeSlotPool [] - Releasing slot [f3a96c530f6ea47a289c7320ec40b2f8].
2025-10-08 15:31:48,637 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Freeing slot f3a96c530f6ea47a289c7320ec40b2f8.
2025-10-08 15:31:48,638 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Disconnect TaskExecutor 127.0.0.1:40677-478ca6 because: TaskExecutor pekko.tcp://flink@127.0.0.1:40677/user/rpc/taskmanager_0 has no more allocated slots for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:31:55,934 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:31:55,935 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:31:55,935 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:31:55,936 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_53) switched from CREATED to SCHEDULED.
2025-10-08 15:31:55,936 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_53) switched from CREATED to SCHEDULED.
2025-10-08 15:31:55,956 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:31:56,027 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Matching resource requirements against available resources.
Missing resources:
	 Job d1f164921ad7c2fe36d4e92a16bdba98
		ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}
Current resources:
	TaskManager 127.0.0.1:40677-478ca6
		Available: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
		Total:     ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
2025-10-08 15:31:56,027 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Starting allocation of slot 7c1ad1c9b5882922485caf7750915095 from 127.0.0.1:40677-478ca6 for job d1f164921ad7c2fe36d4e92a16bdba98 with resource profile ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 15:31:56,038 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_53) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:31:56,038 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #53) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_53 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 7c1ad1c9b5882922485caf7750915095
2025-10-08 15:31:56,039 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_53) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:31:56,039 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #53) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_53 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 7c1ad1c9b5882922485caf7750915095
2025-10-08 15:31:56,042 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job d1f164921ad7c2fe36d4e92a16bdba98 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job d1f164921ad7c2fe36d4e92a16bdba98 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 15:31:56,057 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_53) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:31:56,058 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_53) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:31:56,204 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_53) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c6a6d7b2-5b73-40eb-9397-527f87d7e83b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_c6a6d7b2-5b73-40eb-9397-527f87d7e83b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:31:56,208 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_53.
2025-10-08 15:31:56,208 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:31:56,208 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_53) switched from INITIALIZING to CANCELING.
2025-10-08 15:31:56,257 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_53) switched from CANCELING to CANCELED.
2025-10-08 15:31:56,278 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:32:56,209 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:32:56,209 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:32:56,210 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:32:56,210 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_54) switched from CREATED to SCHEDULED.
2025-10-08 15:32:56,210 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_54) switched from CREATED to SCHEDULED.
2025-10-08 15:32:56,211 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_54) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:32:56,211 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #54) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_54 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 7c1ad1c9b5882922485caf7750915095
2025-10-08 15:32:56,211 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_54) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:32:56,211 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #54) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_54 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 7c1ad1c9b5882922485caf7750915095
2025-10-08 15:32:56,221 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_54) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:32:56,223 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_54) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:32:56,232 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:32:56,253 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_54) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_80a572db-2053-4378-bfef-7f7e7adda0ab/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_80a572db-2053-4378-bfef-7f7e7adda0ab/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:32:56,257 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_54.
2025-10-08 15:32:56,257 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:32:56,257 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_54) switched from INITIALIZING to CANCELING.
2025-10-08 15:32:56,829 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_54) switched from CANCELING to CANCELED.
2025-10-08 15:32:56,850 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:33:56,259 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:33:56,260 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:33:56,260 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:33:56,261 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_55) switched from CREATED to SCHEDULED.
2025-10-08 15:33:56,261 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_55) switched from CREATED to SCHEDULED.
2025-10-08 15:33:56,261 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_55) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:33:56,261 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #55) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_55 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 7c1ad1c9b5882922485caf7750915095
2025-10-08 15:33:56,261 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_55) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:33:56,261 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #55) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_55 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 7c1ad1c9b5882922485caf7750915095
2025-10-08 15:33:56,272 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_55) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:33:56,272 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_55) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:33:56,282 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:33:56,519 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_55) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6afb77d7-7c5c-4b9c-98ae-532c0e0412e5/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6afb77d7-7c5c-4b9c-98ae-532c0e0412e5/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:33:56,520 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_55.
2025-10-08 15:33:56,521 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:33:56,521 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_55) switched from INITIALIZING to CANCELING.
2025-10-08 15:33:56,702 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_55) switched from CANCELING to CANCELED.
2025-10-08 15:33:56,724 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:34:56,522 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:34:56,523 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:34:56,523 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:34:56,523 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_56) switched from CREATED to SCHEDULED.
2025-10-08 15:34:56,523 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_56) switched from CREATED to SCHEDULED.
2025-10-08 15:34:56,524 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_56) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:34:56,524 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #56) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_56 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 7c1ad1c9b5882922485caf7750915095
2025-10-08 15:34:56,524 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_56) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:34:56,524 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #56) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_56 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 7c1ad1c9b5882922485caf7750915095
2025-10-08 15:34:56,535 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_56) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:34:56,535 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_56) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:34:56,545 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:34:56,683 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_56) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_05ede0bb-8088-42c0-ac6f-534f9381f3e4/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_05ede0bb-8088-42c0-ac6f-534f9381f3e4/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:34:56,685 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_56.
2025-10-08 15:34:56,686 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:34:56,686 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_56) switched from INITIALIZING to CANCELING.
2025-10-08 15:34:56,699 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_56) switched from CANCELING to CANCELED.
2025-10-08 15:34:56,720 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:35:56,687 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:35:56,687 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:35:56,688 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:35:56,688 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_57) switched from CREATED to SCHEDULED.
2025-10-08 15:35:56,688 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_57) switched from CREATED to SCHEDULED.
2025-10-08 15:35:56,688 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_57) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:35:56,689 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #57) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_57 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 7c1ad1c9b5882922485caf7750915095
2025-10-08 15:35:56,689 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_57) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:35:56,689 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #57) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_57 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 7c1ad1c9b5882922485caf7750915095
2025-10-08 15:35:56,701 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_57) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:35:56,701 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_57) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:35:56,709 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:35:56,825 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_57) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5f6cc2e7-7435-4131-8744-9a2394864c4a/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_5f6cc2e7-7435-4131-8744-9a2394864c4a/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:35:56,830 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_57.
2025-10-08 15:35:56,830 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:35:56,830 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_57) switched from INITIALIZING to CANCELING.
2025-10-08 15:35:56,841 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_57) switched from CANCELING to CANCELED.
2025-10-08 15:35:56,862 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:36:48,636 INFO  org.apache.flink.runtime.jobmaster.slotpool.DefaultDeclarativeSlotPool [] - Releasing slot [7c1ad1c9b5882922485caf7750915095].
2025-10-08 15:36:48,641 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Freeing slot 7c1ad1c9b5882922485caf7750915095.
2025-10-08 15:36:48,642 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Disconnect TaskExecutor 127.0.0.1:40677-478ca6 because: TaskExecutor pekko.tcp://flink@127.0.0.1:40677/user/rpc/taskmanager_0 has no more allocated slots for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:36:56,831 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:36:56,832 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:36:56,832 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:36:56,832 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_58) switched from CREATED to SCHEDULED.
2025-10-08 15:36:56,832 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_58) switched from CREATED to SCHEDULED.
2025-10-08 15:36:56,853 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:36:56,917 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Matching resource requirements against available resources.
Missing resources:
	 Job d1f164921ad7c2fe36d4e92a16bdba98
		ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}
Current resources:
	TaskManager 127.0.0.1:40677-478ca6
		Available: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
		Total:     ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
2025-10-08 15:36:56,917 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Starting allocation of slot f25ae18569e6e6be2f8b279066bb4778 from 127.0.0.1:40677-478ca6 for job d1f164921ad7c2fe36d4e92a16bdba98 with resource profile ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 15:36:56,929 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_58) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:36:56,929 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #58) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_58 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id f25ae18569e6e6be2f8b279066bb4778
2025-10-08 15:36:56,929 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_58) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:36:56,929 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #58) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_58 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id f25ae18569e6e6be2f8b279066bb4778
2025-10-08 15:36:56,950 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_58) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:36:56,951 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_58) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:36:57,016 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_58) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_1bab9df2-6395-4ec6-aaa1-03aa2d7b091c/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_1bab9df2-6395-4ec6-aaa1-03aa2d7b091c/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:36:57,020 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_58.
2025-10-08 15:36:57,020 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:36:57,020 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_58) switched from INITIALIZING to CANCELING.
2025-10-08 15:36:57,100 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_58) switched from CANCELING to CANCELED.
2025-10-08 15:36:57,122 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:37:57,024 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:37:57,024 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:37:57,025 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:37:57,025 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_59) switched from CREATED to SCHEDULED.
2025-10-08 15:37:57,025 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_59) switched from CREATED to SCHEDULED.
2025-10-08 15:37:57,027 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_59) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:37:57,027 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #59) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_59 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id f25ae18569e6e6be2f8b279066bb4778
2025-10-08 15:37:57,027 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_59) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:37:57,028 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #59) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_59 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id f25ae18569e6e6be2f8b279066bb4778
2025-10-08 15:37:57,046 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:37:57,048 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_59) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:37:57,048 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_59) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:37:57,078 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_59) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_61af7ffb-e04c-4b9a-aa20-60049d7cbd24/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_61af7ffb-e04c-4b9a-aa20-60049d7cbd24/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:37:57,082 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_59.
2025-10-08 15:37:57,083 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:37:57,083 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_59) switched from INITIALIZING to CANCELING.
2025-10-08 15:37:57,552 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_59) switched from CANCELING to CANCELED.
2025-10-08 15:37:57,573 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:38:57,084 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:38:57,085 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:38:57,085 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:38:57,085 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_60) switched from CREATED to SCHEDULED.
2025-10-08 15:38:57,085 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_60) switched from CREATED to SCHEDULED.
2025-10-08 15:38:57,086 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_60) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:38:57,086 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #60) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_60 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id f25ae18569e6e6be2f8b279066bb4778
2025-10-08 15:38:57,086 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_60) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:38:57,086 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #60) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_60 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id f25ae18569e6e6be2f8b279066bb4778
2025-10-08 15:38:57,096 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_60) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:38:57,096 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_60) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:38:57,107 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:38:57,347 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_60) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_2ead57e4-c422-4de8-9753-55d881c32301/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_2ead57e4-c422-4de8-9753-55d881c32301/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:38:57,349 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_60.
2025-10-08 15:38:57,349 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:38:57,350 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_60) switched from INITIALIZING to CANCELING.
2025-10-08 15:38:57,533 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_60) switched from CANCELING to CANCELED.
2025-10-08 15:38:57,554 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:39:57,351 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:39:57,351 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:39:57,352 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:39:57,352 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_61) switched from CREATED to SCHEDULED.
2025-10-08 15:39:57,352 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_61) switched from CREATED to SCHEDULED.
2025-10-08 15:39:57,353 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_61) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:39:57,353 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #61) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_61 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id f25ae18569e6e6be2f8b279066bb4778
2025-10-08 15:39:57,353 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_61) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:39:57,353 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #61) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_61 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id f25ae18569e6e6be2f8b279066bb4778
2025-10-08 15:39:57,362 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_61) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:39:57,362 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_61) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:39:57,374 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:39:57,482 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_61) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_cb403174-0b29-47f9-b517-bea9d809fc6b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_cb403174-0b29-47f9-b517-bea9d809fc6b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:39:57,486 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_61.
2025-10-08 15:39:57,486 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:39:57,487 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_61) switched from INITIALIZING to CANCELING.
2025-10-08 15:39:57,500 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_61) switched from CANCELING to CANCELED.
2025-10-08 15:39:57,520 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:40:57,488 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:40:57,489 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:40:57,489 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:40:57,490 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_62) switched from CREATED to SCHEDULED.
2025-10-08 15:40:57,490 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_62) switched from CREATED to SCHEDULED.
2025-10-08 15:40:57,490 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_62) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:40:57,490 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #62) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_62 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id f25ae18569e6e6be2f8b279066bb4778
2025-10-08 15:40:57,490 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_62) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:40:57,491 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #62) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_62 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id f25ae18569e6e6be2f8b279066bb4778
2025-10-08 15:40:57,502 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_62) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:40:57,508 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_62) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:40:57,512 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:40:57,656 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_62) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a4442418-c1b9-4d5b-8dfb-8c1675c4a3dd/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_a4442418-c1b9-4d5b-8dfb-8c1675c4a3dd/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:40:57,660 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_62.
2025-10-08 15:40:57,660 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:40:57,661 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_62) switched from INITIALIZING to CANCELING.
2025-10-08 15:40:57,681 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_62) switched from CANCELING to CANCELED.
2025-10-08 15:40:57,702 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:41:48,639 INFO  org.apache.flink.runtime.jobmaster.slotpool.DefaultDeclarativeSlotPool [] - Releasing slot [f25ae18569e6e6be2f8b279066bb4778].
2025-10-08 15:41:48,642 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Disconnect TaskExecutor 127.0.0.1:40677-478ca6 because: TaskExecutor pekko.tcp://flink@127.0.0.1:40677/user/rpc/taskmanager_0 has no more allocated slots for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:41:48,642 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Freeing slot f25ae18569e6e6be2f8b279066bb4778.
2025-10-08 15:41:57,664 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:41:57,665 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:41:57,665 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:41:57,666 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_63) switched from CREATED to SCHEDULED.
2025-10-08 15:41:57,666 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_63) switched from CREATED to SCHEDULED.
2025-10-08 15:41:57,686 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:41:57,743 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job d1f164921ad7c2fe36d4e92a16bdba98 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job d1f164921ad7c2fe36d4e92a16bdba98 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 15:41:57,757 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Matching resource requirements against available resources.
Missing resources:
	 Job d1f164921ad7c2fe36d4e92a16bdba98
		ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}
Current resources:
	TaskManager 127.0.0.1:40677-478ca6
		Available: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
		Total:     ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
2025-10-08 15:41:57,758 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Starting allocation of slot 89ead1b64d221a4620718fac4e1799b6 from 127.0.0.1:40677-478ca6 for job d1f164921ad7c2fe36d4e92a16bdba98 with resource profile ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 15:41:57,768 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_63) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:41:57,768 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #63) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_63 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 89ead1b64d221a4620718fac4e1799b6
2025-10-08 15:41:57,768 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_63) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:41:57,768 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #63) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_63 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 89ead1b64d221a4620718fac4e1799b6
2025-10-08 15:41:57,779 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_63) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:41:57,784 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_63) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:41:57,955 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_63) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_cb9c9802-0d54-40e0-bda5-20641e857713/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_cb9c9802-0d54-40e0-bda5-20641e857713/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:41:57,960 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_63.
2025-10-08 15:41:57,960 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:41:57,960 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_63) switched from INITIALIZING to CANCELING.
2025-10-08 15:41:58,013 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_63) switched from CANCELING to CANCELED.
2025-10-08 15:41:58,034 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:42:57,965 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:42:57,965 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:42:57,966 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:42:57,966 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_64) switched from CREATED to SCHEDULED.
2025-10-08 15:42:57,966 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_64) switched from CREATED to SCHEDULED.
2025-10-08 15:42:57,967 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_64) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:42:57,967 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #64) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_64 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 89ead1b64d221a4620718fac4e1799b6
2025-10-08 15:42:57,967 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_64) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:42:57,967 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #64) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_64 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 89ead1b64d221a4620718fac4e1799b6
2025-10-08 15:42:57,975 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_64) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:42:57,976 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_64) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:42:57,987 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:42:58,007 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_64) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_984f0180-fc3d-4b19-a3d6-1d39470ce96b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_984f0180-fc3d-4b19-a3d6-1d39470ce96b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:42:58,009 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_64.
2025-10-08 15:42:58,009 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:42:58,009 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_64) switched from INITIALIZING to CANCELING.
2025-10-08 15:42:58,486 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_64) switched from CANCELING to CANCELED.
2025-10-08 15:42:58,507 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:43:58,011 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:43:58,012 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:43:58,012 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:43:58,013 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_65) switched from CREATED to SCHEDULED.
2025-10-08 15:43:58,013 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_65) switched from CREATED to SCHEDULED.
2025-10-08 15:43:58,013 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_65) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:43:58,013 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #65) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_65 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 89ead1b64d221a4620718fac4e1799b6
2025-10-08 15:43:58,013 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_65) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:43:58,013 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #65) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_65 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 89ead1b64d221a4620718fac4e1799b6
2025-10-08 15:43:58,024 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_65) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:43:58,024 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_65) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:43:58,034 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:43:58,193 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job d1f164921ad7c2fe36d4e92a16bdba98 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job d1f164921ad7c2fe36d4e92a16bdba98 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 15:43:58,273 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_65) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_73a7818d-2141-447c-b71e-032b1646bba6/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_73a7818d-2141-447c-b71e-032b1646bba6/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:43:58,276 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_65.
2025-10-08 15:43:58,276 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:43:58,276 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_65) switched from INITIALIZING to CANCELING.
2025-10-08 15:43:58,463 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_65) switched from CANCELING to CANCELED.
2025-10-08 15:43:58,484 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:44:58,278 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:44:58,279 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:44:58,279 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:44:58,279 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_66) switched from CREATED to SCHEDULED.
2025-10-08 15:44:58,279 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_66) switched from CREATED to SCHEDULED.
2025-10-08 15:44:58,280 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_66) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:44:58,280 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #66) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_66 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 89ead1b64d221a4620718fac4e1799b6
2025-10-08 15:44:58,280 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_66) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:44:58,280 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #66) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_66 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 89ead1b64d221a4620718fac4e1799b6
2025-10-08 15:44:58,296 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_66) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:44:58,297 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_66) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:44:58,300 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:44:58,426 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_66) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e04e8e23-a2ce-421d-a758-38e0269e751e/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_e04e8e23-a2ce-421d-a758-38e0269e751e/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:44:58,430 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_66.
2025-10-08 15:44:58,431 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:44:58,431 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_66) switched from INITIALIZING to CANCELING.
2025-10-08 15:44:58,440 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_66) switched from CANCELING to CANCELED.
2025-10-08 15:44:58,461 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:45:58,432 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:45:58,433 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:45:58,433 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:45:58,434 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_67) switched from CREATED to SCHEDULED.
2025-10-08 15:45:58,434 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_67) switched from CREATED to SCHEDULED.
2025-10-08 15:45:58,434 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_67) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:45:58,434 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #67) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_67 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 89ead1b64d221a4620718fac4e1799b6
2025-10-08 15:45:58,434 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_67) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:45:58,434 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #67) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_67 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 89ead1b64d221a4620718fac4e1799b6
2025-10-08 15:45:58,444 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_67) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:45:58,444 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_67) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:45:58,455 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:45:58,582 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_67) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0f65af17-f67f-4f54-901c-76f2a330313d/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_0f65af17-f67f-4f54-901c-76f2a330313d/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:45:58,584 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_67.
2025-10-08 15:45:58,584 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:45:58,585 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_67) switched from INITIALIZING to CANCELING.
2025-10-08 15:45:58,595 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_67) switched from CANCELING to CANCELED.
2025-10-08 15:45:58,616 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:46:48,641 INFO  org.apache.flink.runtime.jobmaster.slotpool.DefaultDeclarativeSlotPool [] - Releasing slot [89ead1b64d221a4620718fac4e1799b6].
2025-10-08 15:46:48,645 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Freeing slot 89ead1b64d221a4620718fac4e1799b6.
2025-10-08 15:46:48,645 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Disconnect TaskExecutor 127.0.0.1:40677-478ca6 because: TaskExecutor pekko.tcp://flink@127.0.0.1:40677/user/rpc/taskmanager_0 has no more allocated slots for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:46:58,587 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:46:58,588 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:46:58,588 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:46:58,588 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_68) switched from CREATED to SCHEDULED.
2025-10-08 15:46:58,588 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_68) switched from CREATED to SCHEDULED.
2025-10-08 15:46:58,609 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:46:58,677 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Matching resource requirements against available resources.
Missing resources:
	 Job d1f164921ad7c2fe36d4e92a16bdba98
		ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}
Current resources:
	TaskManager 127.0.0.1:40677-478ca6
		Available: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
		Total:     ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
2025-10-08 15:46:58,677 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Starting allocation of slot 5744d892f5f368deda31f6736880300f from 127.0.0.1:40677-478ca6 for job d1f164921ad7c2fe36d4e92a16bdba98 with resource profile ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 15:46:58,689 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_68) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:46:58,689 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #68) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_68 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 5744d892f5f368deda31f6736880300f
2025-10-08 15:46:58,689 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_68) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:46:58,689 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #68) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_68 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 5744d892f5f368deda31f6736880300f
2025-10-08 15:46:58,698 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_68) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:46:58,704 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_68) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:46:58,873 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_68) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6e34a473-db6c-41e9-8015-f507d6ff2d3e/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_6e34a473-db6c-41e9-8015-f507d6ff2d3e/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:46:58,876 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_68.
2025-10-08 15:46:58,876 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:46:58,877 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_68) switched from INITIALIZING to CANCELING.
2025-10-08 15:46:58,930 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_68) switched from CANCELING to CANCELED.
2025-10-08 15:46:58,951 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:47:58,879 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:47:58,880 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:47:58,880 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:47:58,880 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_69) switched from CREATED to SCHEDULED.
2025-10-08 15:47:58,880 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_69) switched from CREATED to SCHEDULED.
2025-10-08 15:47:58,881 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_69) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:47:58,881 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #69) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_69 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 5744d892f5f368deda31f6736880300f
2025-10-08 15:47:58,881 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_69) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:47:58,881 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #69) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_69 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 5744d892f5f368deda31f6736880300f
2025-10-08 15:47:58,891 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_69) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:47:58,893 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_69) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:47:58,903 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:47:58,925 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_69) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7420377d-19b0-49fb-bd0b-60cd48895d1b/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_7420377d-19b0-49fb-bd0b-60cd48895d1b/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:47:58,928 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_69.
2025-10-08 15:47:58,930 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:47:58,931 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_69) switched from INITIALIZING to CANCELING.
2025-10-08 15:47:59,386 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_69) switched from CANCELING to CANCELED.
2025-10-08 15:47:59,407 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:48:58,932 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:48:58,932 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:48:58,933 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:48:58,933 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_70) switched from CREATED to SCHEDULED.
2025-10-08 15:48:58,933 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_70) switched from CREATED to SCHEDULED.
2025-10-08 15:48:58,933 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_70) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:48:58,933 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #70) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_70 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 5744d892f5f368deda31f6736880300f
2025-10-08 15:48:58,933 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_70) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:48:58,933 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #70) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_70 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 5744d892f5f368deda31f6736880300f
2025-10-08 15:48:58,943 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_70) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:48:58,944 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_70) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:48:58,954 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:48:59,182 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_70) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_59b6e101-8a0a-43d1-8982-861bb016acd6/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_59b6e101-8a0a-43d1-8982-861bb016acd6/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:48:59,193 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_70.
2025-10-08 15:48:59,193 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:48:59,193 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_70) switched from INITIALIZING to CANCELING.
2025-10-08 15:48:59,471 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_70) switched from CANCELING to CANCELED.
2025-10-08 15:48:59,492 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:49:59,195 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:49:59,196 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:49:59,196 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:49:59,196 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_71) switched from CREATED to SCHEDULED.
2025-10-08 15:49:59,196 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_71) switched from CREATED to SCHEDULED.
2025-10-08 15:49:59,197 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_71) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:49:59,197 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #71) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_71 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 5744d892f5f368deda31f6736880300f
2025-10-08 15:49:59,197 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_71) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:49:59,197 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #71) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_71 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 5744d892f5f368deda31f6736880300f
2025-10-08 15:49:59,207 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_71) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:49:59,207 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_71) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:49:59,217 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:49:59,283 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job d1f164921ad7c2fe36d4e92a16bdba98 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job d1f164921ad7c2fe36d4e92a16bdba98 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 15:49:59,346 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_71) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_21a91ce6-0cb5-45d2-bbf8-67a12e7c09d0/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_21a91ce6-0cb5-45d2-bbf8-67a12e7c09d0/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:49:59,351 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_71.
2025-10-08 15:49:59,351 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:49:59,351 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_71) switched from INITIALIZING to CANCELING.
2025-10-08 15:49:59,368 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_71) switched from CANCELING to CANCELED.
2025-10-08 15:49:59,389 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:50:58,643 INFO  org.apache.flink.runtime.jobmaster.slotpool.DefaultDeclarativeSlotPool [] - Releasing slot [5744d892f5f368deda31f6736880300f].
2025-10-08 15:50:58,647 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Freeing slot 5744d892f5f368deda31f6736880300f.
2025-10-08 15:50:58,648 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - Disconnect TaskExecutor 127.0.0.1:40677-478ca6 because: TaskExecutor pekko.tcp://flink@127.0.0.1:40677/user/rpc/taskmanager_0 has no more allocated slots for job d1f164921ad7c2fe36d4e92a16bdba98.
2025-10-08 15:50:59,352 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:50:59,353 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:50:59,353 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:50:59,353 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_72) switched from CREATED to SCHEDULED.
2025-10-08 15:50:59,353 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_72) switched from CREATED to SCHEDULED.
2025-10-08 15:50:59,374 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:50:59,436 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Matching resource requirements against available resources.
Missing resources:
	 Job d1f164921ad7c2fe36d4e92a16bdba98
		ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}
Current resources:
	TaskManager 127.0.0.1:40677-478ca6
		Available: ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
		Total:     ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}
2025-10-08 15:50:59,437 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.DefaultSlotStatusSyncer [] - Starting allocation of slot 943f996f923e9b9dabe37d6f667c56d8 from 127.0.0.1:40677-478ca6 for job d1f164921ad7c2fe36d4e92a16bdba98 with resource profile ResourceProfile{cpuCores=1, taskHeapMemory=384.000mb (402653174 bytes), taskOffHeapMemory=0 bytes, managedMemory=512.000mb (536870920 bytes), networkMemory=128.000mb (134217730 bytes)}.
2025-10-08 15:50:59,448 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_72) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:50:59,449 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #72) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_72 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 943f996f923e9b9dabe37d6f667c56d8
2025-10-08 15:50:59,449 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_72) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:50:59,449 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #72) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_72 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 943f996f923e9b9dabe37d6f667c56d8
2025-10-08 15:50:59,460 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_72) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:50:59,465 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_72) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:50:59,599 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_72) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_044bcab5-018f-48d9-a0be-7aa2e8f6879c/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_044bcab5-018f-48d9-a0be-7aa2e8f6879c/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:50:59,604 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_72.
2025-10-08 15:50:59,604 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:50:59,605 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_72) switched from INITIALIZING to CANCELING.
2025-10-08 15:50:59,650 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_72) switched from CANCELING to CANCELED.
2025-10-08 15:50:59,670 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:51:59,606 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:51:59,606 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:51:59,607 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:51:59,607 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_73) switched from CREATED to SCHEDULED.
2025-10-08 15:51:59,607 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_73) switched from CREATED to SCHEDULED.
2025-10-08 15:51:59,608 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_73) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:51:59,608 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #73) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_73 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 943f996f923e9b9dabe37d6f667c56d8
2025-10-08 15:51:59,608 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_73) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:51:59,608 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #73) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_73 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 943f996f923e9b9dabe37d6f667c56d8
2025-10-08 15:51:59,619 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_73) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:51:59,621 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_73) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:51:59,628 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:51:59,667 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_73) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_d6c9ad12-ecda-416d-b13e-e1c1ee5d4f74/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_d6c9ad12-ecda-416d-b13e-e1c1ee5d4f74/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:51:59,672 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_73.
2025-10-08 15:51:59,672 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:51:59,673 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_73) switched from INITIALIZING to CANCELING.
2025-10-08 15:52:00,313 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_73) switched from CANCELING to CANCELED.
2025-10-08 15:52:00,334 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:52:59,674 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:52:59,675 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:52:59,676 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:52:59,676 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_74) switched from CREATED to SCHEDULED.
2025-10-08 15:52:59,676 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_74) switched from CREATED to SCHEDULED.
2025-10-08 15:52:59,676 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_74) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:52:59,676 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #74) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_74 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 943f996f923e9b9dabe37d6f667c56d8
2025-10-08 15:52:59,677 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_74) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:52:59,677 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #74) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_74 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 943f996f923e9b9dabe37d6f667c56d8
2025-10-08 15:52:59,694 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_74) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:52:59,697 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_74) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:52:59,698 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:52:59,903 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job d1f164921ad7c2fe36d4e92a16bdba98 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job d1f164921ad7c2fe36d4e92a16bdba98 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 15:52:59,938 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_74) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_31baca94-3bf9-42a4-b9fd-fdb7f8fa84f8/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_31baca94-3bf9-42a4-b9fd-fdb7f8fa84f8/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:52:59,942 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_74.
2025-10-08 15:52:59,942 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:52:59,942 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_74) switched from INITIALIZING to CANCELING.
2025-10-08 15:53:00,126 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_74) switched from CANCELING to CANCELED.
2025-10-08 15:53:00,147 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
2025-10-08 15:53:59,944 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RESTARTING to RUNNING.
2025-10-08 15:53:59,944 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - Restoring job d1f164921ad7c2fe36d4e92a16bdba98 from Savepoint 2 @ 0 for d1f164921ad7c2fe36d4e92a16bdba98 located at file:/tmp/flink-checkpoints/savepoint-2b5fab-949008d06f02.
2025-10-08 15:53:59,945 INFO  org.apache.flink.runtime.checkpoint.CheckpointCoordinator    [] - No master state to restore
2025-10-08 15:53:59,945 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_75) switched from CREATED to SCHEDULED.
2025-10-08 15:53:59,945 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_75) switched from CREATED to SCHEDULED.
2025-10-08 15:53:59,945 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_75) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:53:59,945 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying Source: Collection Source -> _stream_key_by_map_operator (1/1) (attempt #75) with attempt id 4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_75 and vertex id cbc357ccb763df2852fee8c4fc7d55f2_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 943f996f923e9b9dabe37d6f667c56d8
2025-10-08 15:53:59,946 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_75) switched from SCHEDULED to DEPLOYING.
2025-10-08 15:53:59,946 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Deploying KEYED PROCESS -> Sink: Print to Std. Out (1/1) (attempt #75) with attempt id 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_75 and vertex id 90bea66de1c231edf33913ecd54406c1_0 to 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193) with allocation id 943f996f923e9b9dabe37d6f667c56d8
2025-10-08 15:53:59,954 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_75) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:53:59,954 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_75) switched from DEPLOYING to INITIALIZING.
2025-10-08 15:53:59,970 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Received resource requirements from job d1f164921ad7c2fe36d4e92a16bdba98: [ResourceRequirement{resourceProfile=ResourceProfile{UNKNOWN}, numberOfRequiredSlots=1}]
2025-10-08 15:54:00,086 INFO  org.apache.flink.runtime.checkpoint.CheckpointFailureManager [] - Failed to trigger checkpoint for job d1f164921ad7c2fe36d4e92a16bdba98 since Checkpoint triggering task Source: Collection Source -> _stream_key_by_map_operator (1/1) of job d1f164921ad7c2fe36d4e92a16bdba98 is not being executed at the moment. Aborting checkpoint. Failure reason: Not all required tasks are currently running..
2025-10-08 15:54:00,104 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - KEYED PROCESS -> Sink: Print to Std. Out (1/1) (4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_75) switched from INITIALIZING to FAILED on 127.0.0.1:40677-478ca6 @ localhost (dataPort=38193).
java.lang.Exception: Exception while creating StreamOperatorStateContext.
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:359) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.AbstractStreamOperator.initializeState(AbstractStreamOperator.java:280) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.RegularOperatorChain.initializeStateAndOpenOperators(RegularOperatorChain.java:106) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreStateAndGates(StreamTask.java:858) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.lambda$restoreInternal$5(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTaskActionExecutor$1.call(StreamTaskActionExecutor.java:55) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restoreInternal(StreamTask.java:812) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.runtime.tasks.StreamTask.restore(StreamTask.java:771) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:963) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:932) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:756) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:568) ~[flink-dist-2.1.0.jar:2.1.0]
	at java.base/java.lang.Thread.run(Unknown Source) ~[?:?]
Caused by: org.apache.flink.util.FlinkException: Could not restore keyed state backend for ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1_(1/1) from any of the 1 provided restore options.
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:165) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.apache.flink.runtime.state.BackendBuildingException: Caught unexpected exception.
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:489) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: java.io.IOException: Error while opening RocksDB instance.
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:101) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
Caused by: org.rocksdb.RocksDBException: Sst file size mismatch: /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_abd1dd43-1fca-49c4-8dae-f6f03a305524/db/000014.sst. Expected 137068, actual size 79469
  The file /tmp/rocksdb/job_d1f164921ad7c2fe36d4e92a16bdba98_op_ExternalPythonKeyedProcessOperator_90bea66de1c231edf33913ecd54406c1__1_1__uuid_abd1dd43-1fca-49c4-8dae-f6f03a305524/db/MANIFEST-000005 may be corrupted.
	at org.rocksdb.RocksDB.open(Native Method) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.rocksdb.RocksDB.open(RocksDB.java:315) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBOperationUtils.openDB(RocksDBOperationUtils.java:89) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.loadDb(RocksDBHandle.java:141) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBHandle.openDB(RocksDBHandle.java:129) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreBaseDBFromLocalState(RocksDBIncrementalRestoreOperation.java:752) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.initBaseDBFromSingleStateHandle(RocksDBIncrementalRestoreOperation.java:386) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restoreFromLocalState(RocksDBIncrementalRestoreOperation.java:325) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.lambda$restore$1(RocksDBIncrementalRestoreOperation.java:255) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.runAndReportDuration(RocksDBIncrementalRestoreOperation.java:1022) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.restore.RocksDBIncrementalRestoreOperation.restore(RocksDBIncrementalRestoreOperation.java:254) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.RocksDBKeyedStateBackendBuilder.build(RocksDBKeyedStateBackendBuilder.java:390) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:541) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.state.rocksdb.EmbeddedRocksDBStateBackend.createKeyedStateBackend(EmbeddedRocksDBStateBackend.java:97) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.lambda$keyedStatedBackend$3(StreamTaskStateInitializerImpl.java:475) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.attemptCreateAndRestore(BackendRestorerProcedure.java:173) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.BackendRestorerProcedure.createAndRestore(BackendRestorerProcedure.java:137) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.keyedStatedBackend(StreamTaskStateInitializerImpl.java:486) ~[flink-dist-2.1.0.jar:2.1.0]
	at org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl.streamOperatorStateContext(StreamTaskStateInitializerImpl.java:219) ~[flink-dist-2.1.0.jar:2.1.0]
	... 12 more
2025-10-08 15:54:00,106 INFO  org.apache.flink.runtime.jobmaster.JobMaster                 [] - 2 tasks will be restarted to recover the failed task 4f6c95e62390c2fe92d0908a466c687a_90bea66de1c231edf33913ecd54406c1_0_75.
2025-10-08 15:54:00,106 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Job Word Counter (d1f164921ad7c2fe36d4e92a16bdba98) switched from state RUNNING to RESTARTING.
2025-10-08 15:54:00,106 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_75) switched from INITIALIZING to CANCELING.
2025-10-08 15:54:00,121 INFO  org.apache.flink.runtime.executiongraph.ExecutionGraph       [] - Source: Collection Source -> _stream_key_by_map_operator (1/1) (4f6c95e62390c2fe92d0908a466c687a_cbc357ccb763df2852fee8c4fc7d55f2_0_75) switched from CANCELING to CANCELED.
2025-10-08 15:54:00,142 INFO  org.apache.flink.runtime.resourcemanager.slotmanager.FineGrainedSlotManager [] - Clearing resource requirements of job d1f164921ad7c2fe36d4e92a16bdba98
